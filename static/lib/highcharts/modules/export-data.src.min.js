!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(n){"use strict";var t=n?n._modules:{};function e(t,e,o,a){t.hasOwnProperty(e)||(t[e]=a.apply(null,o),"function"==typeof CustomEvent&&n.win.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:t[e]}})))}e(t,"Extensions/DownloadURL.js",[t["Core/Globals.js"]],function(t){const{isSafari:s,win:r,win:{document:l}}=t,n=r.URL||r.webkitURL||r;function c(t){t=t.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([A-Z+\d\/]+)/i);if(t&&3<t.length&&r.atob&&r.ArrayBuffer&&r.Uint8Array&&r.Blob&&n.createObjectURL){const e=r.atob(t[3]),o=new r.ArrayBuffer(e.length),a=new r.Uint8Array(o);for(let t=0;t<a.length;++t)a[t]=e.charCodeAt(t);return n.createObjectURL(new r.Blob([a],{type:t[1]}))}}return{dataURLtoBlob:c,downloadURL:function(t,e){const o=r.navigator,a=l.createElement("a");if("string"==typeof t||t instanceof String||!o.msSaveOrOpenBlob){if(t=""+t,1e3<o.userAgent.length)throw new Error("Input too long");var n=/Edge\/\d+/.test(o.userAgent),i=s&&"string"==typeof t&&0===t.indexOf("data:application/pdf");if((i||n||2e6<t.length)&&!(t=c(t)||""))throw new Error("Failed to convert to blob");if(void 0!==a.download)a.href=t,a.download=e,l.body.appendChild(a),a.click(),l.body.removeChild(a);else try{if(!r.open(t,"chart"))throw new Error("Failed to open window")}catch{r.location.href=t}}else o.msSaveOrOpenBlob(t,e)}}}),e(t,"Extensions/ExportData/ExportDataDefaults.js",[],function(){return{exporting:{csv:{annotations:{itemDelimiter:"; ",join:!1},columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0,showExportInProgress:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{annotationHeader:"Annotations",categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table",hideData:"Hide data table",exportInProgress:"Exporting..."}}}),e(t,"Extensions/ExportData/ExportData.js",[t["Core/Renderer/HTML/AST.js"],t["Core/Defaults.js"],t["Extensions/DownloadURL.js"],t["Extensions/ExportData/ExportDataDefaults.js"],t["Core/Globals.js"],t["Core/Utilities.js"]],function(c,t,e,h,o,a){const{getOptions:d,setOptions:p}=t,n=e["downloadURL"],{doc:u,win:i}=o,{addEvent:m,defined:f,extend:g,find:S,fireEvent:C,isNumber:A,pick:R}=a;function x(t){const e=Boolean(this.options.exporting?.showExportInProgress),o=i.requestAnimationFrame||setTimeout;o(()=>{e&&this.showLoading(this.options.lang.exportInProgress),o(()=>{try{t.call(this)}finally{e&&this.hideLoading()}})})}function b(){x.call(this,()=>{var t=this.getCSV(!0);n(s(t,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(t),this.getFilename()+".csv")})}function y(){x.call(this,()=>{var t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";n(s(t,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+(t=t,i.btoa(unescape(encodeURIComponent(t)))),this.getFilename()+".xls")})}function w(t){let n="";const i=this.getDataRows(),e=this.options.exporting.csv,s=R(e.decimalPoint,","!==e.itemDelimiter&&t?1.1.toLocaleString()[1]:"."),r=R(e.itemDelimiter,","===s?";":","),l=e.lineDelimiter;return i.forEach((t,e)=>{let o="",a=t.length;for(;a--;)"number"==typeof(o="string"==typeof(o=t[a])?`"${o}"`:o)&&"."!==s&&(o=o.toString().replace(".",s)),t[a]=o;t.length=i.length?i[0].length:0,n+=t.join(r),e<i.length-1&&(n+=l)}),n}function D(n){function i(t,e,o){if(w.columnHeaderFormatter){var a=w.columnHeaderFormatter(t,e,o);if(!1!==a)return a}return t?t.bindAxes?n?{columnTitle:1<o?e:t.name,topLevelColumnTitle:t.name}:t.name+(1<o?" ("+e+")":""):t.options.title&&t.options.title.text||(t.dateTime?c:l):l}function x(o,t,a){const n={},i={};return t.forEach(function(t){var e=(o.keyToAxis&&o.keyToAxis[t]||t)+"Axis",e=A(a)?o.chart[e][a]:o[e];n[t]=e&&e.categories||[],i[t]=e&&e.dateTime}),{categoryMap:n,dateTimeValueAxisMap:i}}const b=this.hasParallelCoordinates,y=this.time,w=this.options.exporting&&this.options.exporting.csv||{},s=this.xAxis,D={},t=[],r=[],v=[],e=this.options.lang,o=e.exportData,l=o.categoryHeader,c=o.categoryDatetimeHeader,T=[];let a,h,E,L=0,d,p;for(d in this.series.forEach(function(l){const t=l.options.keys,c=l.xAxis,h=t||(o=c,a=(e=l).pointArrayMap||["y"],e.data.some(t=>void 0!==t.y&&t.name)&&o&&!o.categories&&"name"!==e.exportKey?["x",...a]:a),d=h.length,p=!l.requireSorting&&{},u=s.indexOf(c);var e,o,a;let m=x(l,h),f,g;if(!1!==l.options.includeInDataExport&&!l.options.isInternal&&!1!==l.visible){for(S(T,function(t){return t[0]===u})||T.push([u,L]),g=0;g<d;)E=i(l,h[g],h.length),v.push(E.columnTitle||E),n&&r.push(E.topLevelColumnTitle||E),g++;f={chart:l.chart,autoIncrement:l.autoIncrement,options:l.options,pointArrayMap:l.pointArrayMap,index:l.index},l.options.data.forEach(function(t,e){var o={series:f};let a,n,i;b&&(m=x(l,h,e)),l.pointClass.prototype.applyOptions.apply(o,[t]);t=l.data[e]&&l.data[e].name;if(a=(o.x??"")+","+t,g=0,(!c||"name"===l.exportKey||!b&&c&&c.hasNames&&t)&&(a=t),p&&(p[a]&&(a+="|"+e),p[a]=!0),D[a]){var e=a+","+D[a].pointers[l.index],s=a;D[a].pointers[l.index]&&(D[e]||(D[e]=[],D[e].xValues=[],D[e].pointers=[]),a=e),D[s].pointers[l.index]+=1}else{D[a]=[],D[a].xValues=[];const r=[];for(let t=0;t<l.chart.series.length;t++)r[t]=0;D[a].pointers=r,D[a].pointers[l.index]=1}for(D[a].x=o.x,D[a].name=t,D[a].xValues[u]=o.x;g<d;)i=o[n=h[g]],D[a][L+g]=R(m.categoryMap[n][i],m.dateTimeValueAxisMap[n]?y.dateFormat(w.dateFormat,i):null,i),g++}),L+=g}}),D)Object.hasOwnProperty.call(D,d)&&t.push(D[d]);let u,m;for(h=n?[r,v]:[v],L=T.length;L--;)u=T[L][0],m=T[L][1],a=s[u],t.sort(function(t,e){return t.xValues[u]-e.xValues[u]}),p=i(a),h[0].splice(m,0,p),n&&h[1]&&h[1].splice(m,0,p),t.forEach(function(t){let e=t.name;a&&!f(e)&&(e=a.dateTime?(t.x instanceof Date&&(t.x=t.x.getTime()),y.dateFormat(w.dateFormat,t.x)):a.categories?R(a.names[t.x],a.categories[t.x],t.x):t.x),t.splice(m,0,e)});return h=h.concat(t),C(this,"exportData",{dataRows:h}),h}function v(t){const e=t=>{if(!t.tagName||"#text"===t.tagName)return t.textContent||"";const o=t.attributes;let a="<"+t.tagName;return o&&Object.keys(o).forEach(t=>{var e=o[t];a+=` ${t}="${e}"`}),a=(a+=">")+(t.textContent||""),(t.children||[]).forEach(t=>{a+=e(t)}),a+=`</${t.tagName}>`};t=this.getTableAST(t);return e(t)}function T(t){let a=0;const e=[],p=this.options,s=t?1.1.toLocaleString()[1]:".",u=R(p.exporting.useMultiLevelHeaders,!0),o=this.getDataRows(u),n=u?o.shift():null,i=o.shift(),m=function(t,e){let o=t.length;if(e.length!==o)return!1;for(;o--;)if(t[o]!==e[o])return!1;return!0},f=function(t,e,o,a){let n=R(a,""),i="highcharts-text"+(e?" "+e:"");return"number"==typeof n?(n=n.toString(),","===s&&(n=n.replace(".",s)),i="highcharts-number"):a||(i="highcharts-empty"),{tagName:t,attributes:o=g({class:i},o),textContent:n}};!1!==p.exporting.tableCaption&&e.push({tagName:"caption",attributes:{class:"highcharts-table-caption"},textContent:R(p.exporting.tableCaption,p.title.text||"Chart")});for(let t=0,e=o.length;t<e;++t)o[t].length>a&&(a=o[t].length);e.push(function(t,e,o){const a=[];let n=0,i=o||e&&e.length,s,r=0,l;if(u&&t&&e&&!m(t,e)){const c=[];for(;n<i;++n)if((s=t[n])===t[n+1])++r;else if(r)c.push(f("th","highcharts-table-topheading",{scope:"col",colspan:r+1},s)),r=0;else{s===e[n]?p.exporting.useRowspanHeaders?(l=2,delete e[n]):(l=1,e[n]=""):l=1;const h=f("th","highcharts-table-topheading",{scope:"col"},s);1<l&&h.attributes&&(h.attributes.valign="top",h.attributes.rowspan=l),c.push(h)}a.push({tagName:"tr",children:c})}if(e){const d=[];for(n=0,i=e.length;n<i;++n)void 0!==e[n]&&d.push(f("th",null,{scope:"col"},e[n]));a.push({tagName:"tr",children:d})}return{tagName:"thead",children:a}}(n,i,Math.max(a,i.length)));const r=[];o.forEach(function(e){const o=[];for(let t=0;t<a;t++)o.push(f(t?"td":"th",null,t?{}:{scope:"row"},e[t]));r.push({tagName:"tr",children:o})}),e.push({tagName:"tbody",children:r});t={tree:{tagName:"table",id:"highcharts-data-table-"+this.index,children:e}};return C(this,"aftergetTableAST",t),t.tree}function E(){this.toggleDataTable(!1)}function L(t){var e=(t=R(t,!this.isDataTableVisible))&&!this.dataTableDiv;if(e&&(this.dataTableDiv=u.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)),this.dataTableDiv){const s=this.dataTableDiv.style,r=s.display;if(s.display=t?"block":"none",t){this.dataTableDiv.innerHTML=c.emptyHTML;const l=new c([this.getTableAST()]);l.addToDOM(this.dataTableDiv),C(this,"afterViewData",{element:this.dataTableDiv,wasHidden:e||r!==s.display})}else C(this,"afterHideData")}this.isDataTableVisible=t;const o=this.exportDivElements,a=this.options.exporting,n=a&&a.buttons&&a.buttons.contextButton.menuItems,i=this.options.lang;a&&a.menuItemDefinitions&&i&&i.viewData&&i.hideData&&n&&o&&((e=o[n.indexOf("viewData")])&&c.setElementHTML(e,this.isDataTableVisible?i.hideData:i.viewData))}function k(){this.toggleDataTable(!0)}function s(t,e){const o=i.navigator,a=i.URL||i.webkitURL||i;try{if(o.msSaveOrOpenBlob&&i.MSBlobBuilder){const n=new i.MSBlobBuilder;return n.append(t),n.getBlob("image/svg+xml")}return a.createObjectURL(new i.Blob(["\ufeff"+t],{type:e}))}catch(t){}}function O(){const n=this,i=n.dataTableDiv,s=(t,e)=>t.children[e].textContent,r=(a,n)=>(t,e)=>{var o;return o=s(n?t:e,a),e=s(n?e:t,a),""===o||""===e||isNaN(o)||isNaN(e)?o.toString().localeCompare(e):o-e};if(i&&n.options.exporting&&n.options.exporting.allowTableSorting){const t=i.querySelector("thead tr");t&&t.childNodes.forEach(o=>{const a=o.closest("table");o.addEventListener("click",function(){const t=[...i.querySelectorAll("tr:not(thead tr)")],e=[...o.parentNode.children];t.sort(r(e.indexOf(o),n.ascendingOrderInTable=!n.ascendingOrderInTable)).forEach(t=>{a.appendChild(t)}),e.forEach(e=>{["highcharts-sort-ascending","highcharts-sort-descending"].forEach(t=>{e.classList.contains(t)&&e.classList.remove(t)})}),o.classList.add(n.ascendingOrderInTable?"highcharts-sort-ascending":"highcharts-sort-descending")})})}}function U(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()}function H(){this.dataTableDiv?.remove()}return{compose:function(t,e){const o=t.prototype;if(!o.getCSV){const a=d().exporting,{arearange:n,gantt:i,map:s,mapbubble:r,treemap:l,xrange:c}=(m(t,"afterViewData",O),m(t,"render",U),m(t,"destroy",H),o.downloadCSV=b,o.downloadXLS=y,o.getCSV=w,o.getDataRows=D,o.getTable=v,o.getTableAST=T,o.hideData=E,o.toggleDataTable=L,o.viewData=k,a&&(g(a.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){x.call(this,this.toggleDataTable)}}}),a.buttons&&a.buttons.contextButton.menuItems&&a.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData")),p(h),e.types);n&&(n.prototype.keyToAxis={low:"y",high:"y"}),i&&(i.prototype.exportKey="name",i.prototype.keyToAxis={start:"x",end:"x"}),s&&(s.prototype.exportKey="name"),r&&(r.prototype.exportKey="name"),l&&(l.prototype.exportKey="name"),c&&(c.prototype.keyToAxis={x2:"x"})}}}}),e(t,"masters/modules/export-data.src.js",[t["Core/Globals.js"],t["Extensions/DownloadURL.js"],t["Extensions/ExportData/ExportData.js"]],function(t,e,o){const a=t;return a.dataURLtoBlob=a.dataURLtoBlob||e.dataURLtoBlob,a.downloadURL=a.downloadURL||e.downloadURL,o.compose(a.Chart,a.Series),t})});
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("jspdf")):"function"==typeof define&&define.amd?define(["exports","jspdf"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).svg2pdf={},t.jspdf)}(this,function(_,u){"use strict";var t="default"in u?u.default:u,H=function(t,e){return(H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function e(t,e){function r(){this.constructor=t}H(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var D=function(){return(D=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function l(t,s,o,l){return new(o=o||Promise)(function(r,e){function i(t){try{a(l.next(t))}catch(t){e(t)}}function n(t){try{a(l.throw(t))}catch(t){e(t)}}function a(t){var e;t.done?r(t.value):((e=t.value)instanceof o?e:new o(function(t){t(e)})).then(i,n)}a((l=l.apply(t,s||[])).next())})}function S(i,n){var a,s,o,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(r){return function(t){var e=[r,t];if(a)throw new TypeError("Generator is already executing.");for(;l;)try{if(a=1,s&&(o=2&e[0]?s.return:e[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,e[1])).done)return o;switch(s=0,(e=o?[2&e[0],o.value]:e)[0]){case 0:case 1:o=e;break;case 4:return l.label++,{value:e[1],done:!1};case 5:l.label++,s=e[1],e=[0];continue;case 7:e=l.ops.pop(),l.trys.pop();continue;default:if(!(o=0<(o=l.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){l=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){l.label=e[1];break}if(6===e[0]&&l.label<o[1]){l.label=o[1],o=e;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(e);break}o[2]&&l.ops.pop(),l.trys.pop();continue}e=n.call(i,l)}catch(t){e=[6,t],s=0}finally{a=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}}}c.prototype.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},c.prototype.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+(this.a||"1")+")"},c.prototype.toHex=function(){var t=this.r.toString(16),e=this.g.toString(16),r=this.b.toString(16);return"#"+(t=1==t.length?"0"+t:t)+(e=1==e.length?"0"+e:e)+(r=1==r.length?"0"+r:r)},c.prototype.getHelpXML=function(){for(var t,e=[],r=0;r<this.colorDefs.length;r++)for(var i=this.colorDefs[r].example,n=0;n<i.length;n++)e[e.length]=i[n];for(t in this.simpleColors)e[e.length]=t;var a=document.createElement("ul");a.setAttribute("id","rgbcolor-examples");for(r=0;r<e.length;r++)try{var s=document.createElement("li"),o=new c(e[r]),l=document.createElement("div"),h=(l.style.cssText="margin: 3px; border: 1px solid black; background:"+o.toHex()+"; color:"+o.toHex(),l.appendChild(document.createTextNode("test")),document.createTextNode(" "+e[r]+" -> "+o.toRGB()+" -> "+o.toHex()));s.appendChild(l),s.appendChild(h),a.appendChild(s)}catch(t){}return a};var h=c;function c(t){if(this.a=void 0,this.r=0,this.g=0,this.b=0,this.simpleColors={},this.colorDefs=[],this.ok=!1,t){for(var e in t=(t=(t="#"==t.charAt(0)?t.substr(1,6):t).replace(/ /g,"")).toLowerCase(),this.simpleColors={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgrey:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",grey:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightslategrey:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"},this.simpleColors)t==e&&(t=this.simpleColors[e]);this.colorDefs=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(t){return[parseInt(t[1]),parseInt(t[2]),parseInt(t[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}}];for(var r=0;r<this.colorDefs.length;r++){var i=this.colorDefs[r].re,n=this.colorDefs[r].process,i=i.exec(t);i&&(n=n(i),this.r=n[0],this.g=n[1],this.b=n[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:255<this.r?255:this.r,this.g=this.g<0||isNaN(this.g)?0:255<this.g?255:this.g,this.b=this.b<0||isNaN(this.b)?0:255<this.b?255:this.b}}q.prototype.getFillData=function(t,e){return l(this,void 0,void 0,function(){return S(this,function(t){return[2,void 0]})})};var f=q;function q(t){this.color=t}R.prototype.clone=function(){var t=new R;return t.xmlSpace=this.xmlSpace,t.fill=this.fill,t.fillOpacity=this.fillOpacity,t.fontFamily=this.fontFamily,t.fontSize=this.fontSize,t.fontStyle=this.fontStyle,t.fontWeight=this.fontWeight,t.opacity=this.opacity,t.stroke=this.stroke,t.strokeDasharray=this.strokeDasharray,t.strokeDashoffset=this.strokeDashoffset,t.strokeLinecap=this.strokeLinecap,t.strokeLinejoin=this.strokeLinejoin,t.strokeMiterlimit=this.strokeMiterlimit,t.strokeOpacity=this.strokeOpacity,t.strokeWidth=this.strokeWidth,t.textAnchor=this.textAnchor,t.alignmentBaseline=this.alignmentBaseline,t.visibility=this.visibility,t.color=this.color,t},R.default=function(){var t=new R;return t.xmlSpace="default",t.fill=new f(new h("rgb(0, 0, 0)")),t.fillOpacity=1,t.fontFamily="times",t.fontSize=16,t.fontStyle="normal",t.fontWeight="normal",t.opacity=1,t.stroke=null,t.strokeDasharray=null,t.strokeDashoffset=0,t.strokeLinecap="butt",t.strokeLinejoin="miter",t.strokeMiterlimit=4,t.strokeOpacity=1,t.strokeWidth=1,t.alignmentBaseline="baseline",t.textAnchor="start",t.visibility="visible",t.color=new h("rgb(0, 0, 0)"),t};var V=R;function R(){this.xmlSpace="",this.fill=null,this.fillOpacity=1,this.fontFamily="",this.fontSize=16,this.fontStyle="",this.fontWeight="",this.opacity=1,this.stroke=null,this.strokeDasharray=null,this.strokeDashoffset=0,this.strokeLinecap="",this.strokeLinejoin="",this.strokeMiterlimit=4,this.strokeOpacity=1,this.strokeWidth=1,this.alignmentBaseline="",this.textAnchor="",this.visibility="",this.color=null}j.prototype.clone=function(t){var e;return new j(this.pdf,{svg2pdfParameters:this.svg2pdfParameters,attributeState:((t=void 0===t?{}:t).attributeState?t:this).attributeState.clone(),viewport:null!=(e=t.viewport)?e:this.viewport,refsHandler:this.refsHandler,styleSheets:this.styleSheets,textMeasure:this.textMeasure,transform:null!=(e=t.transform)?e:this.transform,withinClipPath:null!=(e=t.withinClipPath)?e:this.withinClipPath,withinUse:null!=(e=t.withinUse)?e:this.withinUse})};var d=j;function j(t,e){this.pdf=t,this.svg2pdfParameters=e.svg2pdfParameters,this.attributeState=e.attributeState?e.attributeState.clone():V.default(),this.viewport=e.viewport,this.refsHandler=e.refsHandler,this.styleSheets=e.styleSheets,this.textMeasure=e.textMeasure,this.transform=null!=(t=e.transform)?t:this.pdf.unitMatrix,this.withinClipPath=null!=(t=e.withinClipPath)&&t,this.withinUse=null!=(t=e.withinUse)&&t}function W(t,e){"single"!=(e=function(t,e){if(!t)return e;var r,i={};for(r in e)i[r]=(G.call(t,r)?t:e)[r];return i}(e,W.options)).quotes&&"double"!=e.quotes&&(e.quotes="single");for(var r="double"==e.quotes?'"':"'",i=e.isIdentifier,n=t.charAt(0),a="",s=0,o=t.length;s<o;){var l,h=t.charAt(s++),u=h.charCodeAt();a+=u<32||126<u?(55296<=u&&u<=56319&&s<o&&(56320==(64512&(l=t.charCodeAt(s++)))?u=((1023&u)<<10)+(1023&l)+65536:s--),"\\"+u.toString(16).toUpperCase()+" "):e.escapeEverything?U.test(h)?"\\"+h:"\\"+u.toString(16).toUpperCase()+" ":/[\t\n\f\r\x0B]/.test(h)?"\\"+u.toString(16).toUpperCase()+" ":"\\"==h||!i&&('"'==h&&r==h||"'"==h&&r==h)||i&&z.test(h)?"\\"+h:h}return i&&(/^-[-\d]/.test(a)?a="\\-"+a.slice(1):/\d/.test(n)&&(a="\\3"+n+" "+a.slice(1))),a=a.replace(Y,function(t,e,r){return e&&e.length%2?t:(e||"")+r}),!i&&e.wrap?r+a+r:a}var G={}.hasOwnProperty,U=/[ -,\.\/:-@\[-\^`\{-~]/,z=/[ -,\.\/:-@\[\]\^`\{-~]/,Y=/(^|\\+)?(\\[A-F0-9]{1,6})\x20(?![a-fA-F0-9\x20])/g,X=(W.options={escapeEverything:!1,isIdentifier:!1,quotes:"single",wrap:!1},W.version="3.0.0",W),Q=(r.prototype.getRendered=function(i,n,a){return l(this,void 0,void 0,function(){var e,r;return S(this,function(t){switch(t.label){case 0:return(e=this.generateKey(i,n),this.renderedElements.hasOwnProperty(e))?[2,this.renderedElements[i]]:(r=this.get(i),this.renderedElements[e]=r,[4,a(r)]);case 1:return t.sent(),[2,r]}})})},r.prototype.get=function(t){return this.idMap[X(t,{isIdentifier:!0})]},r.prototype.generateKey=function(t,e){return this.idPrefix+"|"+t+"|"+(e||new h("rgb(0,0,0)")).toRGBA()},r.instanceCounter=0,r);function r(t){this.renderedElements={},this.idMap=t,this.idPrefix=String(r.instanceCounter++)}function $(t,e){return Math.atan2(e[1]-t[1],e[0]-t[0])}function K(t,e){return[2/3*(e[0]-t[0])+t[0],2/3*(e[1]-t[1])+t[1]]}function Z(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]);return[t[0]/e,t[1]/e]}function J(t,e){return Z([e[0]-t[0],e[1]-t[1]])}function tt(t,e){return[t[0]+e[0],t[1]+e[1]]}function et(t,e){var r=t[0],t=t[1];return[e.a*r+e.c*t+e.e,e.b*r+e.d*t+e.f]}i.prototype.moveTo=function(t,e){return this.segments.push(new y(t,e)),this},i.prototype.lineTo=function(t,e){return this.segments.push(new b(t,e)),this},i.prototype.curveTo=function(t,e,r,i,n,a){return this.segments.push(new v(t,e,r,i,n,a)),this},i.prototype.close=function(){return this.segments.push(new it),this},i.prototype.transform=function(i){this.segments.forEach(function(t){var e,r;(t instanceof y||t instanceof b||t instanceof v)&&(e=et([t.x,t.y],i),t.x=e[0],t.y=e[1]),t instanceof v&&(e=et([t.x1,t.y1],i),r=et([t.x2,t.y2],i),t.x1=e[0],t.y1=e[1],t.x2=r[0],t.y2=r[1])})},i.prototype.draw=function(t){var e=t.pdf;this.segments.forEach(function(t){t instanceof y?e.moveTo(t.x,t.y):t instanceof b?e.lineTo(t.x,t.y):t instanceof v?e.curveTo(t.x1,t.y1,t.x2,t.y2,t.x,t.y):e.close()})};var rt=i;function i(){this.segments=[]}var y=function(t,e){this.x=t,this.y=e},b=function(t,e){this.x=t,this.y=e},v=function(t,e,r,i,n,a){this.x1=t,this.y1=e,this.x2=r,this.y2=i,this.x=n,this.y=a},it=function(){};function g(t,e){return 0<=e.split(",").indexOf((t.nodeName||t.tagName).toLowerCase())}function x(t,e,r,i){void 0===i&&(i=r);var n=null==(n=t.style)?void 0:n.getPropertyValue(i);return n||e.getPropertyValue(t,i)||t.hasAttribute(r)&&t.getAttribute(r)||void 0}function n(t,e,r){if("none"===x(t.element,r.styleSheets,"display"))return!1;t=x(t.element,r.styleSheets,"visibility");return e=t?"hidden"!==t:e}function a(t,e,r){var i=n(t,e,r);return 0!==t.element.childNodes.length&&(t.children.forEach(function(t){t.isVisible(i,r)&&(i=!0)}),i)}at.prototype.addMarker=function(t){this.markers.push(t)},at.prototype.draw=function(o){return l(this,void 0,void 0,function(){var e,r,i,n,a,s;return S(this,function(t){switch(t.label){case 0:e=0,t.label=1;case 1:return e<this.markers.length?(r=this.markers[e],i=void 0,s=r.angle,n=r.anchor,a=Math.cos(s),s=Math.sin(s),i=o.pdf.Matrix(a,s,-s,a,n[0],n[1]),i=o.pdf.matrixMult(o.pdf.Matrix(o.attributeState.strokeWidth,0,0,o.attributeState.strokeWidth,0,0),i),i=o.pdf.matrixMult(i,o.transform),o.pdf.saveGraphicsState(),[4,o.refsHandler.getRendered(r.id,null,function(t){return t.apply(o)})]):[3,4];case 2:t.sent(),o.pdf.doFormObject(r.id,i),o.pdf.restoreGraphicsState(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})};var nt=at;function at(){this.markers=[]}var w=function(t,e,r){this.id=t,this.anchor=e,this.angle=r},st=/url\(["']?#([^"']+)["']?\)/,ot={bottom:"bottom","text-bottom":"bottom",top:"top","text-top":"top",hanging:"hanging",middle:"middle",central:"middle",center:"middle",mathematical:"middle",ideographic:"ideographic",alphabetic:"alphabetic",baseline:"alphabetic"},lt="http://www.w3.org/2000/svg";function k(t,e){var r=t&&t.toString().match(/^([\-0-9.]+)em$/);return r?parseFloat(r[1])*e:(r=t&&t.toString().match(/^([\-0-9.]+)(px|)$/))?parseFloat(r[1]):0}function ht(t){return ot[t]||"alphabetic"}function m(t){for(var e,r=[],i=/[+-]?(?:(?:\d+\.?\d*)|(?:\d*\.?\d+))(?:[eE][+-]?\d+)?/g;e=i.exec(t);)r.push(parseFloat(e[0]));return r}function ut(t,e){if("transparent"===t)return(r=new h("rgb(0,0,0)")).a=0,r;if("currentcolor"===t.toLowerCase())return e||new h("rgb(0,0,0)");var r=/\s*rgba\(((?:[^,\)]*,){3}[^,\)]*)\)\s*/.exec(t);return r?(e=m(r[1]),(r=new h("rgb("+e.slice(0,3).join(",")+")")).a=e[3],r):new h(t)}var ct=/[a-z0-9_-]/i,ft=/[\s\t]/,pt=function(t){for(var e,r,i=!0,n=0,a="",s=0,o=[];;){if(r=t[s],0===n){if(!r&&i)break;if(!r&&!i)throw new Error("Parse error");if('"'===r||"'"===r)e=r,i=!(n=1);else if(!ft.test(r)){if(!ct.test(r))throw new Error("Parse error");i=!(n=3),s--}}else if(1===n){if(!r)throw new Error("Parse Error");"\\"===r?n=2:r===e?(o.push(a),a="",n=4):a+=r}else if(2===n){if(r!==e&&"\\"!==r)throw new Error("Parse error");a+=r,n=1}else if(3===n){if(!r){o.push(a);break}if(ct.test(r))a+=r;else if(","===r)o.push(a),a="",n=0;else{if(!ft.test(r))throw new Error("Parse error");n=5}}else if(5===n){if(!r){o.push(a);break}if(ct.test(r))a+=" "+r,n=3;else if(","===r)o.push(a),a="",n=0;else if(!ft.test(r))throw new Error("Parse error")}else if(4===n){if(!r)break;if(","===r)n=0;else if(!ft.test(r))throw new Error("Parse error")}s++}return o},p={"sans-serif":"helvetica",verdana:"helvetica",arial:"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",serif:"times",cursive:"times",fantasy:"times"};t=t.version.split(".");var dt=2===parseFloat(t[0])&&3===parseFloat(t[1]);function gt(t,e){return dt?400==e?"italic"==t?"italic":"normal":700==e&&"italic"!==t?"bold":t+""+e:400==e||"normal"===e?"italic"===t?"italic":"normal":700!=e&&"bold"!==e||"normal"!==t?(700==e?"bold":e)+""+t:"bold"}function mt(e,t){if("none"===x(t.element,e.styleSheets,"display"))return[0,0,0,0];var r=[0,0,0,0];return t.children.forEach(function(t){t=t.getBoundingBox(e);r=[Math.min(r[0],t[0]),Math.min(r[1],t[1]),Math.max(r[0]+r[2],t[0]+t[2])-Math.min(r[0],t[0]),Math.max(r[1]+r[3],t[1]+t[3])-Math.min(r[1],t[1])]}),r}function yt(t,e){var r=parseFloat,i=r(t.getAttribute("x1"))||r(x(t,e.styleSheets,"x"))||r(x(t,e.styleSheets,"cx"))-r(x(t,e.styleSheets,"r"))||0,n=r(t.getAttribute("x2"))||i+r(x(t,e.styleSheets,"width"))||r(x(t,e.styleSheets,"cx"))+r(x(t,e.styleSheets,"r"))||0,a=r(t.getAttribute("y1"))||r(x(t,e.styleSheets,"y"))||r(x(t,e.styleSheets,"cy"))-r(x(t,e.styleSheets,"r"))||0,r=r(t.getAttribute("y2"))||a+r(x(t,e.styleSheets,"height"))||r(x(t,e.styleSheets,"cy"))+r(x(t,e.styleSheets,"r"))||0;return[Math.min(i,n),Math.min(a,r),Math.max(i,n)-Math.min(i,n),Math.max(a,r)-Math.min(a,r)]}function bt(t,e,r,i,n,a,s,o){void 0===o&&(o=!1);var l,h=e[0],u=e[1],c=e[2],e=e[3],f=n/c,p=a/e,t=t.getAttribute("preserveAspectRatio");if(t=t?(l=(t="defer"===(t=t.split(" "))[0]?t.slice(1):t)[0],t[1]||"meet"):(l="xMidYMid","meet"),"none"!==l&&("meet"===t?f=p=Math.min(f,p):"slice"===t&&(f=p=Math.max(f,p))),o)return s.pdf.Matrix(f,0,0,p,0,0);t=r-h*f,o=i-u*p,0<=l.indexOf("xMid")?t+=(n-c*f)/2:0<=l.indexOf("xMax")&&(t+=n-c*f),0<=l.indexOf("YMid")?o+=(a-e*p)/2:0<=l.indexOf("YMax")&&(o+=a-e*p),r=s.pdf.Matrix(1,0,0,1,t,o),h=s.pdf.Matrix(f,0,0,p,0,0);return s.pdf.matrixMult(h,r)}function vt(t,e){if(!t||"none"===t)return e.pdf.unitMatrix;for(var r=/^[\s,]*matrix\(([^)]+)\)\s*/,i=/^[\s,]*translate\(([^)]+)\)\s*/,n=/^[\s,]*rotate\(([^)]+)\)\s*/,a=/^[\s,]*scale\(([^)]+)\)\s*/,s=/^[\s,]*skewX\(([^)]+)\)\s*/,o=/^[\s,]*skewY\(([^)]+)\)\s*/,l=e.pdf.unitMatrix;0<t.length&&t.length!==f;){var h,u,c,f=t.length,p=r.exec(t);p&&(h=m(p[1]),l=e.pdf.matrixMult(e.pdf.Matrix(h[0],h[1],h[2],h[3],h[4],h[5]),l),t=t.substr(p[0].length)),(p=n.exec(t))&&(h=m(p[1]),u=Math.PI*h[0]/180,l=e.pdf.matrixMult(e.pdf.Matrix(Math.cos(u),Math.sin(u),-Math.sin(u),Math.cos(u),0,0),l),(h[1]||h[2])&&(u=e.pdf.Matrix(1,0,0,1,h[1],h[2]),c=e.pdf.Matrix(1,0,0,1,-h[1],-h[2]),l=e.pdf.matrixMult(c,e.pdf.matrixMult(l,u))),t=t.substr(p[0].length)),(p=i.exec(t))&&(h=m(p[1]),l=e.pdf.matrixMult(e.pdf.Matrix(1,0,0,1,h[0],h[1]||0),l),t=t.substr(p[0].length)),(p=a.exec(t))&&((h=m(p[1]))[1]||(h[1]=h[0]),l=e.pdf.matrixMult(e.pdf.Matrix(h[0],0,0,h[1],0,0),l),t=t.substr(p[0].length)),(p=s.exec(t))&&(h=parseFloat(p[1]),h*=Math.PI/180,l=e.pdf.matrixMult(e.pdf.Matrix(1,0,Math.tan(h),1,0,0),l),t=t.substr(p[0].length)),(p=o.exec(t))&&(h=parseFloat(p[1]),h*=Math.PI/180,l=e.pdf.matrixMult(e.pdf.Matrix(1,Math.tan(h),0,1,0,0),l),t=t.substr(p[0].length))}return l}xt.prototype.setParent=function(t){this.parent=t},xt.prototype.getParent=function(){return this.parent},xt.prototype.getBoundingBox=function(t){return"none"===x(this.element,t.styleSheets,"display")?[0,0,0,0]:this.getBoundingBoxCore(t)},xt.prototype.computeNodeTransform=function(t){var e=this.computeNodeTransformCore(t),r=x(this.element,t.styleSheets,"transform");return r?t.pdf.matrixMult(e,vt(r,t)):e};t=xt;function xt(t,e){this.element=t,this.children=e,this.parent=null}e(kt,St=t),kt.prototype.render=function(t){return Promise.resolve()},kt.prototype.getBoundingBoxCore=function(t){return[]},kt.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix};var St,wt=kt;function kt(){return null!==St&&St.apply(this,arguments)||this}e(s,Mt=wt),s.prototype.apply=function(s){return l(this,void 0,void 0,function(){var e,r,i,n,a;return S(this,function(t){return(e=this.element.getAttribute("id"))&&(a=this.getStops(s.styleSheets),r=0,i=!1,a.forEach(function(t){t=t.opacity;t&&1!==t&&(r+=t,i=!0)}),i&&(n=new u.GState({opacity:r/a.length})),a=new u.ShadingPattern(this.pdfGradientType,this.getCoordinates(),a,n),s.pdf.addShadingPattern(e,a)),[2]})})},s.prototype.getStops=function(i){var n=this;if(this.stops)return this.stops;if(void 0===this.contextColor){this.contextColor=null;for(var t=this;t;){var e=x(t.element,i,"color");if(e){this.contextColor=ut(e,null);break}t=t.getParent()}}var a=[];return this.children.forEach(function(t){var e,r;"stop"===t.element.tagName.toLowerCase()&&(e=x(t.element,i,"color"),e=ut(x(t.element,i,"stop-color")||"",e?ut(e,null):n.contextColor),r=parseFloat(x(t.element,i,"stop-opacity")||"1"),a.push({offset:s.parseGradientOffset(t.element.getAttribute("offset")||"0"),color:[e.r,e.g,e.b],opacity:r}))}),this.stops=a},s.prototype.getBoundingBoxCore=function(t){return yt(this.element,t)},s.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},s.prototype.isVisible=function(t,e){return a(this,t,e)},s.parseGradientOffset=function(t){var e=parseFloat(t);return!isNaN(e)&&0<=t.indexOf("%")?e/100:e};var Mt,Ct=s;function s(t,e,r){e=Mt.call(this,e,r)||this;return e.pdfGradientType=t,e.contextColor=void 0,e}e(Tt,At=Ct),Tt.prototype.getCoordinates=function(){return[parseFloat(this.element.getAttribute("x1")||"0"),parseFloat(this.element.getAttribute("y1")||"0"),parseFloat(this.element.getAttribute("x2")||"1"),parseFloat(this.element.getAttribute("y2")||"0")]};var At,Ft=Tt;function Tt(t,e){return At.call(this,"axial",t,e)||this}e(Nt,Pt=Ct),Nt.prototype.getCoordinates=function(){var t=this.element.getAttribute("cx"),e=this.element.getAttribute("cy"),r=this.element.getAttribute("fx"),i=this.element.getAttribute("fy");return[parseFloat(r||t||"0.5"),parseFloat(i||e||"0.5"),0,parseFloat(t||"0.5"),parseFloat(e||"0.5"),parseFloat(this.element.getAttribute("r")||"0.5")]};var Pt,Bt=Nt;function Nt(t,e){return Pt.call(this,"radial",t,e)||this}Lt.prototype.getFillData=function(i,n){return l(this,void 0,void 0,function(){var e,r;return S(this,function(t){switch(t.label){case 0:return[4,n.refsHandler.getRendered(this.key,null,function(t){return t.apply(new d(n.pdf,{refsHandler:n.refsHandler,textMeasure:n.textMeasure,styleSheets:n.styleSheets,viewport:n.viewport,svg2pdfParameters:n.svg2pdfParameters}))})];case 1:return t.sent(),e=this.gradient.element.hasAttribute("gradientUnits")&&"objectboundingbox"!==this.gradient.element.getAttribute("gradientUnits").toLowerCase()?n.pdf.unitMatrix:(e=i.getBoundingBox(n),n.pdf.Matrix(e[2],0,0,e[3],e[0],e[1])),r=vt(x(this.gradient.element,n.styleSheets,"gradientTransform","transform"),n),[2,{key:this.key,matrix:n.pdf.matrixMult(r,e)}]}})})};var Et=Lt;function Lt(t,e){this.key=t,this.gradient=e}e(_t,Ot=wt),_t.prototype.apply=function(a){return l(this,void 0,void 0,function(){var e,r,i,n;return S(this,function(t){switch(t.label){case 0:if(!(e=this.element.getAttribute("id")))return[2];r=this.getBoundingBox(a),r=new u.TilingPattern([r[0],r[1],r[0]+r[2],r[1]+r[3]],r[2],r[3]),a.pdf.beginTilingPattern(r),i=0,n=this.children,t.label=1;case 1:return i<n.length?[4,n[i].render(new d(a.pdf,{attributeState:a.attributeState,refsHandler:a.refsHandler,styleSheets:a.styleSheets,viewport:a.viewport,svg2pdfParameters:a.svg2pdfParameters,textMeasure:a.textMeasure}))]:[3,4];case 2:t.sent(),t.label=3;case 3:return i++,[3,1];case 4:return a.pdf.endTilingPattern(e,r),[2]}})})},_t.prototype.getBoundingBoxCore=function(t){return yt(this.element,t)},_t.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},_t.prototype.isVisible=function(t,e){return a(this,t,e)};var Ot,It=_t;function _t(){return null!==Ot&&Ot.apply(this,arguments)||this}Dt.prototype.getFillData=function(f,p){return l(this,void 0,void 0,function(){var e,r,i,n,a,s,o,l,h,u,c;return S(this,function(t){switch(t.label){case 0:return[4,p.refsHandler.getRendered(this.key,null,function(t){return t.apply(new d(p.pdf,{refsHandler:p.refsHandler,textMeasure:p.textMeasure,styleSheets:p.styleSheets,viewport:p.viewport,svg2pdfParameters:p.svg2pdfParameters}))})];case 1:return t.sent(),e={key:this.key,boundingBox:void 0,xStep:0,yStep:0,matrix:void 0},i=p.pdf.unitMatrix,this.pattern.element.hasAttribute("patternUnits")&&"objectboundingbox"!==this.pattern.element.getAttribute("patternUnits").toLowerCase()||(r=f.getBoundingBox(p),i=p.pdf.Matrix(1,0,0,1,r[0],r[1]),a=this.pattern.getBoundingBox(p),s=a[0]*r[0]||0,o=a[1]*r[1]||0,l=a[2]*r[2]||0,h=a[3]*r[3]||0,e.boundingBox=[s,o,s+l,o+h],e.xStep=l,e.yStep=h),n=p.pdf.unitMatrix,this.pattern.element.hasAttribute("patternContentUnits")&&"objectboundingbox"===this.pattern.element.getAttribute("patternContentUnits").toLowerCase()&&(r=r||f.getBoundingBox(p),n=p.pdf.Matrix(r[2],0,0,r[3],0,0),a=e.boundingBox||this.pattern.getBoundingBox(p),s=a[0]/r[0]||0,o=a[1]/r[1]||0,l=a[2]/r[2]||0,h=a[3]/r[3]||0,e.boundingBox=[s,o,s+l,o+h],e.xStep=l,e.yStep=h),u=p.pdf.unitMatrix,(c=x(this.pattern.element,p.styleSheets,"patternTransform","transform"))&&(u=vt(c,p)),c=n,c=p.pdf.matrixMult(c,i),c=p.pdf.matrixMult(c,u),c=p.pdf.matrixMult(c,p.transform),e.matrix=c,[2,e]}})})};var Ht=Dt;function Dt(t,e){this.key=t,this.pattern=e}function qt(t,e){var r,i,n,a,s=st.exec(t);return s?(s=s[1],(r=e.refsHandler.get(s))&&(r instanceof Ft||r instanceof Bt)?(a=s,n=e,0===(n=(i=r).getStops(n.styleSheets)).length?null:1!==n.length?new Et(a,i):(a=n[0].color,(i=new h).ok=!0,i.r=a[0],i.g=a[1],i.b=a[2],i.a=n[0].opacity,new f(i))):r&&r instanceof It?new Ht(s,r):new f(new h("rgb(0, 0, 0)"))):(a=ut(t,e.attributeState.color)).ok?new f(a):null}function Vt(t,e,r){var i,n,a,s,r=r||e.element,e=x(r,t.styleSheets,"color"),e=(e&&((e=ut(e,t.attributeState.color)).ok?t.attributeState.color=e:t.attributeState.color=new h("rgb(0,0,0)")),x(r,t.styleSheets,"visibility")),e=(e&&(t.attributeState.visibility=e),x(r,t.styleSheets,"fill")),e=(e&&(t.attributeState.fill=qt(e,t)),x(r,t.styleSheets,"fill-opacity")),e=(e&&(t.attributeState.fillOpacity=parseFloat(e)),x(r,t.styleSheets,"stroke-opacity")),e=(e&&(t.attributeState.strokeOpacity=parseFloat(e)),x(r,t.styleSheets,"opacity")),e=(e&&(t.attributeState.opacity=parseFloat(e)),x(r,t.styleSheets,"stroke-width")),e=(void 0!==e&&""!==e&&(t.attributeState.strokeWidth=Math.abs(parseFloat(e))),x(r,t.styleSheets,"stroke")),e=(e&&("none"===e?t.attributeState.stroke=null:(e=ut(e,t.attributeState.color)).ok&&(t.attributeState.stroke=new f(e))),x(r,t.styleSheets,"stroke-linecap")),e=(e&&(t.attributeState.strokeLinecap=e),x(r,t.styleSheets,"stroke-linejoin")),e=(e&&(t.attributeState.strokeLinejoin=e),x(r,t.styleSheets,"stroke-dasharray")),e=(e&&(o=parseInt(x(r,t.styleSheets,"stroke-dashoffset")||"0"),t.attributeState.strokeDasharray=m(e),t.attributeState.strokeDashoffset=o),x(r,t.styleSheets,"stroke-miterlimit")),o=(void 0!==e&&""!==e&&(t.attributeState.strokeMiterlimit=parseFloat(e)),r.getAttribute("xml:space")),e=(o&&(t.attributeState.xmlSpace=o),x(r,t.styleSheets,"font-weight")),o=(e&&(t.attributeState.fontWeight=e),x(r,t.styleSheets,"font-style")),e=(o&&(t.attributeState.fontStyle=o),x(r,t.styleSheets,"font-family")),e=(e&&(o=pt(e),t.attributeState.fontFamily=(e=t.attributeState,o=o,i=gt(e.fontStyle,e.fontWeight),n=t.pdf.getFontList(),a="",a=o.some(function(t){var e=n[t];return e&&0<=e.indexOf(i)?(a=t,!0):(t=t.toLowerCase(),!!p.hasOwnProperty(t)&&(a=t,!0))})?a:"times")),x(r,t.styleSheets,"font-size")),e=(e&&(s=t.pdf.getFontSize(),t.attributeState.fontSize=k(e,s)),x(r,t.styleSheets,"vertical-align")||x(r,t.styleSheets,"alignment-baseline")),e=(!e||(s=e.match(/(baseline|text-bottom|alphabetic|ideographic|middle|central|mathematical|text-top|bottom|center|top|hanging)/))&&(t.attributeState.alignmentBaseline=s[0]),x(r,t.styleSheets,"text-anchor"));e&&(t.attributeState.textAnchor=e)}function Rt(t,e,r){var i,n,a,s=1,o=1,l=(s=(s*=t.attributeState.fillOpacity)*t.attributeState.opacity,t.attributeState.fill instanceof f&&void 0!==t.attributeState.fill.color.a&&(s*=t.attributeState.fill.color.a),o=(o*=t.attributeState.strokeOpacity)*t.attributeState.opacity,t.attributeState.stroke instanceof f&&void 0!==t.attributeState.stroke.color.a&&(o*=t.attributeState.stroke.color.a),s<1),h=o<1;g(r,"use")?(h=l=!0,s*=t.attributeState.fill?1:0,o*=t.attributeState.stroke?1:0):t.withinUse&&(t.attributeState.fill!==e.attributeState.fill?(l=!0,s*=t.attributeState.fill?1:0):l&&!t.attributeState.fill&&(s=0),t.attributeState.stroke!==e.attributeState.stroke?(h=!0,o*=t.attributeState.stroke?1:0):h&&!t.attributeState.stroke&&(o=0)),(l||h)&&(i={},l&&(i.opacity=s),h&&(i["stroke-opacity"]=o),t.pdf.setGState(new u.GState(i))),t.attributeState.fill&&t.attributeState.fill!==e.attributeState.fill&&t.attributeState.fill instanceof f&&t.attributeState.fill.color.ok&&!g(r,"text")&&t.pdf.setFillColor(t.attributeState.fill.color.r,t.attributeState.fill.color.g,t.attributeState.fill.color.b),t.attributeState.strokeWidth!==e.attributeState.strokeWidth&&t.pdf.setLineWidth(t.attributeState.strokeWidth),t.attributeState.stroke!==e.attributeState.stroke&&t.attributeState.stroke instanceof f&&t.pdf.setDrawColor(t.attributeState.stroke.color.r,t.attributeState.stroke.color.g,t.attributeState.stroke.color.b),t.attributeState.strokeLinecap!==e.attributeState.strokeLinecap&&t.pdf.setLineCap(t.attributeState.strokeLinecap),t.attributeState.strokeLinejoin!==e.attributeState.strokeLinejoin&&t.pdf.setLineJoin(t.attributeState.strokeLinejoin),t.attributeState.strokeDasharray===e.attributeState.strokeDasharray&&t.attributeState.strokeDashoffset===e.attributeState.strokeDashoffset||!t.attributeState.strokeDasharray||t.pdf.setLineDashPattern(t.attributeState.strokeDasharray,t.attributeState.strokeDashoffset),t.attributeState.strokeMiterlimit!==e.attributeState.strokeMiterlimit&&t.pdf.setLineMiterLimit(t.attributeState.strokeMiterlimit),t.attributeState.fontFamily!==e.attributeState.fontFamily&&(n=p.hasOwnProperty(t.attributeState.fontFamily)?p[t.attributeState.fontFamily]:t.attributeState.fontFamily),t.attributeState.fill&&t.attributeState.fill!==e.attributeState.fill&&t.attributeState.fill instanceof f&&t.attributeState.fill.color.ok&&(l=t.attributeState.fill.color,t.pdf.setTextColor(l.r,l.g,l.b)),t.attributeState.fontWeight===e.attributeState.fontWeight&&t.attributeState.fontStyle===e.attributeState.fontStyle||(a=gt(t.attributeState.fontStyle,t.attributeState.fontWeight)),void 0===n&&void 0===a||(void 0===n&&(n=p.hasOwnProperty(t.attributeState.fontFamily)?p[t.attributeState.fontFamily]:t.attributeState.fontFamily),t.pdf.setFont(n,a)),t.attributeState.fontSize!==e.attributeState.fontSize&&t.pdf.setFontSize(t.attributeState.fontSize*t.pdf.internal.scaleFactor)}function jt(t,e,r){var t=st.exec(t);if(t)return t=t[1],r.refsHandler.get(t)||void 0}function Wt(i,n,a){return l(this,void 0,void 0,function(){var e,r;return S(this,function(t){switch(t.label){case 0:return e=a.clone(),n.element.hasAttribute("clipPathUnits")&&"objectboundingbox"===n.element.getAttribute("clipPathUnits").toLowerCase()&&(r=i.getBoundingBox(a),e.transform=a.pdf.matrixMult(a.pdf.Matrix(r[2],0,0,r[3],r[0],r[1]),a.transform)),[4,n.apply(e)];case 1:return t.sent(),[2]}})})}e(Ut,Gt=t),Ut.prototype.render=function(n){return l(this,void 0,void 0,function(){var e,r,i;return S(this,function(t){switch(t.label){case 0:return this.isVisible("hidden"!==n.attributeState.visibility,n)?((e=n.clone()).transform=e.pdf.matrixMult(this.computeNodeTransform(e),n.transform),Vt(e,this),i=x(this.element,e.styleSheets,"clip-path"),(r=i&&"none"!==i)?(i=jt(i,0,e))?i.isVisible(!0,e)?(e.pdf.saveGraphicsState(),[4,Wt(this,i,e)]):[3,2]:[3,4]:[3,5]):[2];case 1:return t.sent(),[3,3];case 2:return[2];case 3:return[3,5];case 4:r=!1,t.label=5;case 5:return e.withinClipPath||e.pdf.saveGraphicsState(),Rt(e,n,this.element),[4,this.renderCore(e)];case 6:return t.sent(),e.withinClipPath||e.pdf.restoreGraphicsState(),r&&e.pdf.restoreGraphicsState(),[2]}})})};var Gt,Ct=Ut;function Ut(){return null!==Gt&&Gt.apply(this,arguments)||this}e(Xt,zt=Ct);var zt,Yt=Xt;function Xt(){return null!==zt&&zt.apply(this,arguments)||this}e(M,Qt=Yt),M.prototype.renderCore=function(r){return l(this,void 0,void 0,function(){var e;return S(this,function(t){switch(t.label){case 0:return null===(e=this.getCachedPath(r))||0===e.segments.length?[2]:(r.withinClipPath?e.transform(r.transform):r.pdf.setCurrentTransformationMatrix(r.transform),e.draw(r),[4,this.fillOrStroke(r)]);case 1:return(t.sent(),this.hasMarkers)?[4,this.drawMarkers(r,e)]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2]}})})},M.prototype.getCachedPath=function(t){return this.cachedPath||(this.cachedPath=this.getPath(t))},M.prototype.drawMarkers=function(e,r){return l(this,void 0,void 0,function(){return S(this,function(t){switch(t.label){case 0:return[4,this.getMarkers(r,e).draw(e.clone({transform:e.pdf.unitMatrix}))];case 1:return t.sent(),[2]}})})},M.prototype.fillOrStroke=function(s){return l(this,void 0,void 0,function(){var e,r,i,n,a;return S(this,function(t){switch(t.label){case 0:return s.withinClipPath?[2]:(e=s.attributeState.fill,r=s.attributeState.stroke&&0!==s.attributeState.strokeWidth,e?[4,e.getFillData(this,s)]:[3,2]);case 1:return n=t.sent(),[3,3];case 2:n=void 0,t.label=3;case 3:return i=n,a="evenodd"===x(this.element,s.styleSheets,"fill-rule"),e&&r||s.withinUse?a?s.pdf.fillStrokeEvenOdd(i):s.pdf.fillStroke(i):e?a?s.pdf.fillEvenOdd(i):s.pdf.fill(i):r?s.pdf.stroke():s.pdf.discardPath(),[2]}})})},M.prototype.getBoundingBoxCore=function(t){var e=this.getCachedPath(t);if(!e||!e.segments.length)return[0,0,0,0];for(var r=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY,s=0,o=0,l=0;l<e.segments.length;l++){var h=e.segments[l];(h instanceof y||h instanceof b||h instanceof v)&&(s=h.x,o=h.y),a=h instanceof v?(r=Math.min(r,s,h.x1,h.x2,h.x),n=Math.max(n,s,h.x1,h.x2,h.x),i=Math.min(i,o,h.y1,h.y2,h.y),Math.max(a,o,h.y1,h.y2,h.y)):(r=Math.min(r,s),n=Math.max(n,s),i=Math.min(i,o),Math.max(a,o))}return[r,i,n-r,a-i]},M.prototype.getMarkers=function(t,e){var o=x(this.element,e.styleSheets,"marker-start"),l=x(this.element,e.styleSheets,"marker-mid"),h=x(this.element,e.styleSheets,"marker-end"),u=new nt;if(o||l||h)for(var h=h&&$t(h),o=o&&$t(o),l=l&&$t(l),c=t.segments,f=[1,0],p=void 0,d=!1,g=[1,0],m=!1,r=0;r<c.length;r++)!function(r){var t,e=c[r],i=o&&(1===r||!(c[r]instanceof y)&&c[r-1]instanceof y),n=(i&&c.forEach(function(t,e){!m&&t instanceof it&&r<e&&(t=c[e-1],m=(t instanceof y||t instanceof b||t instanceof v)&&t)}),h&&(r===c.length-1||!(c[r]instanceof y)&&c[r+1]instanceof y)),a=l&&0<r&&!(1===r&&c[r-1]instanceof y),s=c[r-1]||null;s instanceof y||s instanceof b||s instanceof v?e instanceof v?(i&&u.addMarker(new w(o,[s.x,s.y],$(m?[m.x,m.y]:[s.x,s.y],[e.x1,e.y1]))),n&&u.addMarker(new w(h,[e.x,e.y],$([e.x2,e.y2],[e.x,e.y]))),a&&(p=J([s.x,s.y],[e.x1,e.y1]),p=s instanceof y?p:Z(tt(f,p)),u.addMarker(new w(l,[s.x,s.y],Math.atan2(p[1],p[0])))),f=J([e.x2,e.y2],[e.x,e.y])):e instanceof y||e instanceof b?(p=J([s.x,s.y],[e.x,e.y]),i&&(t=m?J([m.x,m.y],[e.x,e.y]):p,u.addMarker(new w(o,[s.x,s.y],Math.atan2(t[1],t[0])))),n&&u.addMarker(new w(h,[e.x,e.y],Math.atan2(p[1],p[0]))),a&&(t=e instanceof y?f:s instanceof y?p:Z(tt(f,p)),u.addMarker(new w(l,[s.x,s.y],Math.atan2(t[1],t[0])))),f=p):e instanceof it&&(p=J([s.x,s.y],[d.x,d.y]),a&&(t=s instanceof y?p:Z(tt(f,p)),u.addMarker(new w(l,[s.x,s.y],Math.atan2(t[1],t[0])))),n&&(t=Z(tt(p,g)),u.addMarker(new w(h,[d.x,d.y],Math.atan2(t[1],t[0])))),f=p):(d=e instanceof y&&e,((i=c[r+1])instanceof y||i instanceof b||i instanceof v)&&(g=J([d.x,d.y],[i.x,i.y])))}(r);return u};var Qt,o=M;function M(t,e,r){e=Qt.call(this,e,r)||this;return e.cachedPath=null,e.hasMarkers=t,e}function $t(t){t=st.exec(t);return t&&t[1]||void 0}e(Jt,Kt=o),Jt.prototype.getPath=function(t){if(t.withinClipPath||null===t.attributeState.stroke)return null;var t=parseFloat(this.element.getAttribute("x1")||"0"),e=parseFloat(this.element.getAttribute("y1")||"0"),r=parseFloat(this.element.getAttribute("x2")||"0"),i=parseFloat(this.element.getAttribute("y2")||"0");return t||r||e||i?(new rt).moveTo(t,e).lineTo(r,i):null},Jt.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},Jt.prototype.isVisible=function(t,e){return n(this,t,e)},Jt.prototype.fillOrStroke=function(e){return l(this,void 0,void 0,function(){return S(this,function(t){switch(t.label){case 0:return e.attributeState.fill=null,[4,Kt.prototype.fillOrStroke.call(this,e)];case 1:return t.sent(),[2]}})})};var Kt,Zt=Jt;function Jt(t,e){return Kt.call(this,!0,t,e)||this}e(re,te=wt),re.prototype.apply=function(a){return l(this,void 0,void 0,function(){var e,r,i,n;return S(this,function(t){switch(t.label){case 0:return this.isVisible("hidden"!==a.attributeState.visibility,a)?((e=a.clone()).transform=e.pdf.unitMatrix,Vt(e,this),r=x(this.element,e.styleSheets,"clip-path"),r&&"none"!==r&&(r=jt(r,0,e))?r.isVisible(!0,e)?[4,Wt(this,r,e)]:[3,2]:[3,3]):[2];case 1:return t.sent(),[3,3];case 2:return[2];case 3:Rt(e,a,this.element),i=0,n=this.children,t.label=4;case 4:return i<n.length?[4,n[i].render(e)]:[3,7];case 5:t.sent(),t.label=6;case 6:return i++,[3,4];case 7:return[2]}})})},re.prototype.getBoundingBoxCore=function(t){return mt(t,this)},re.prototype.isVisible=function(t,e){return a(this,t,e)},re.prototype.computeNodeTransformCore=function(t){var e,r,i=parseFloat(x(this.element,t.styleSheets,"x")||"0"),n=parseFloat(x(this.element,t.styleSheets,"y")||"0"),a=this.element.getAttribute("viewBox");return a?(e=m(a),r=parseFloat(x(this.element,t.styleSheets,"width")||x(this.element.ownerSVGElement,t.styleSheets,"width")||a[2]),a=parseFloat(x(this.element,t.styleSheets,"height")||x(this.element.ownerSVGElement,t.styleSheets,"height")||a[3]),bt(this.element,e,i,n,r,a,t)):t.pdf.Matrix(1,0,0,1,i,n)};var te,ee=re;function re(){return null!==te&&te.apply(this,arguments)||this}var ie,ne=function(t,e){this.width=t,this.height=e},ae=(e(C,ie=Yt),C.prototype.renderCore=function(p){return l(this,void 0,void 0,function(){var e,r,i,n,a,s,o,l,h,u,c,f;return S(this,function(t){switch(t.label){case 0:return(e=parseFloat,u=this.element.getAttribute("href")||this.element.getAttribute("xlink:href"))?(r=u.substring(1),i=p.refsHandler.get(r),n=g(i.element,"symbol,svg")&&i.element.hasAttribute("viewBox"),a=e(x(this.element,p.styleSheets,"x")||"0"),s=e(x(this.element,p.styleSheets,"y")||"0"),l=o=void 0,h=n?(o=e(x(this.element,p.styleSheets,"width")||x(i.element,p.styleSheets,"width")||"0"),l=e(x(this.element,p.styleSheets,"height")||x(i.element,p.styleSheets,"height")||"0"),a+=e(x(i.element,p.styleSheets,"x")||"0"),s+=e(x(i.element,p.styleSheets,"y")||"0"),u=m(i.element.getAttribute("viewBox")),bt(i.element,u,a,s,o,l,p)):p.pdf.Matrix(1,0,0,1,a,s),c=new d(p.pdf,{refsHandler:p.refsHandler,styleSheets:p.styleSheets,withinUse:!0,viewport:n?new ne(o,l):p.viewport,svg2pdfParameters:p.svg2pdfParameters,textMeasure:p.textMeasure}),f=p.attributeState.color,[4,p.refsHandler.getRendered(r,f,function(t){return C.renderReferencedNode(t,r,f,c)})]):[2];case 1:return t.sent(),p.pdf.saveGraphicsState(),p.pdf.setCurrentTransformationMatrix(p.transform),n&&"visible"!==x(i.element,p.styleSheets,"overflow")&&(p.pdf.rect(a,s,o,l),p.pdf.clip().discardPath()),p.pdf.doFormObject(p.refsHandler.generateKey(r,f),h),p.pdf.restoreGraphicsState(),[2]}})})},C.renderReferencedNode=function(r,i,n,a){return l(this,void 0,void 0,function(){var e;return S(this,function(t){switch(t.label){case 0:return(e=[(e=r.getBoundingBox(a))[0]-.5*e[2],e[1]-.5*e[3],2*e[2],2*e[3]],a.attributeState.color=n,a.pdf.beginFormObject(e[0],e[1],e[2],e[3],a.pdf.unitMatrix),r instanceof ee)?[4,r.apply(a)]:[3,2];case 1:return t.sent(),[3,4];case 2:return[4,r.render(a)];case 3:t.sent(),t.label=4;case 4:return a.pdf.endFormObject(a.refsHandler.generateKey(i,n)),[2]}})})},C.prototype.getBoundingBoxCore=function(t){return yt(this.element,t)},C.prototype.isVisible=function(t,e){return n(this,t,e)},C.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},C);function C(){return null!==ie&&ie.apply(this,arguments)||this}e(le,se=o),le.prototype.getPath=function(t){var e=parseFloat(x(this.element,t.styleSheets,"width")||"0"),r=parseFloat(x(this.element,t.styleSheets,"height")||"0");if(!isFinite(e)||e<=0||!isFinite(r)||r<=0)return null;var i=x(this.element,t.styleSheets,"rx"),n=x(this.element,t.styleSheets,"ry"),a=Math.min(parseFloat(i||n||"0"),.5*e),n=Math.min(parseFloat(n||i||"0"),.5*r),i=parseFloat(x(this.element,t.styleSheets,"x")||"0"),t=parseFloat(x(this.element,t.styleSheets,"y")||"0"),s=4/3*(Math.SQRT2-1);return(0===a&&0===n?(new rt).moveTo(i,t).lineTo(i+e,t).lineTo(i+e,t+r).lineTo(i,t+r):(new rt).moveTo(i+=a,t).lineTo(i+=e-2*a,t).curveTo(i+a*s,t,i+a,t+(n-n*s),i+=a,t+=n).lineTo(i,t+=r-2*n).curveTo(i,t+n*s,i-a*s,t+n,i-=a,t+=n).lineTo(i+=2*a-e,t).curveTo(i-a*s,t,i-a,t-n*s,i-=a,t-=n).lineTo(i,t+=2*n-r).curveTo(i,t-n*s,i+a*s,t-n,i+=a,t-=n)).close()},le.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},le.prototype.isVisible=function(t,e){return n(this,t,e)};var se,oe=le;function le(t,e){return se.call(this,!1,t,e)||this}e(ce,he=o),ce.prototype.getPath=function(t){var e=this.getRx(t),r=this.getRy(t);if(!isFinite(e)||r<=0||!isFinite(r)||r<=0)return null;var i=parseFloat(x(this.element,t.styleSheets,"cx")||"0"),t=parseFloat(x(this.element,t.styleSheets,"cy")||"0"),n=4/3*(Math.SQRT2-1)*e,a=4/3*(Math.SQRT2-1)*r;return(new rt).moveTo(i+e,t).curveTo(i+e,t-a,i+n,t-r,i,t-r).curveTo(i-n,t-r,i-e,t-a,i-e,t).curveTo(i-e,t+a,i-n,t+r,i,t+r).curveTo(i+n,t+r,i+e,t+a,i+e,t)},ce.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},ce.prototype.isVisible=function(t,e){return n(this,t,e)};var he,ue=ce;function ce(t,e){return he.call(this,!1,t,e)||this}e(de,fe=ue),de.prototype.getRx=function(t){return parseFloat(x(this.element,t.styleSheets,"rx")||"0")},de.prototype.getRy=function(t){return parseFloat(x(this.element,t.styleSheets,"ry")||"0")};var fe,pe=de;function de(t,e){return fe.call(this,t,e)||this}function ge(t){var e="invisible",r=t.stroke&&0!==t.strokeWidth,t=t.fill;return t&&r?e="fillThenStroke":t?e="fill":r&&(e="stroke"),e}function me(t){return t.replace(/[\n\r]/g,"")}function ye(t){return t.replace(/[\t]/g," ")}function be(t){return t.replace(/ +/g," ")}function ve(t,e,r){switch(x(t,r.styleSheets,"text-transform")){case"uppercase":return e.toUpperCase();case"lowercase":return e.toLowerCase();default:return e}}A.prototype.setX=function(t){this.originX=t},A.prototype.setY=function(t){this.originY=t},A.prototype.add=function(t,e,r){this.texts.push(e),this.textNodes.push(t),this.contexts.push(r)},A.prototype.rightTrimText=function(){for(var t=this.texts.length-1;0<=t;t--)if("default"===this.contexts[t].attributeState.xmlSpace&&(this.texts[t]=this.texts[t].replace(/\s+$/,"")),this.texts[t].match(/[^\s]/))return!1;return!0},A.prototype.measureText=function(t){for(var e=0;e<this.texts.length;e++)this.textMeasures.push({width:t.textMeasure.measureTextWidth(this.texts[e],this.contexts[e].attributeState),length:this.texts[e].length})},A.prototype.put=function(t,e){for(var r=[],i=[],n=[],a=this.originX,s=this.originY,o=a,l=a,h=0;h<this.textNodes.length;h++){var u,c=this.textNodes[h],f=this.contexts[h],p=this.textMeasures[h]||{width:t.textMeasure.measureTextWidth(this.texts[h],this.contexts[h].attributeState),length:this.texts[h].length},d=a,g=s;"#text"===c.nodeName||r.includes(c)||(r.push(c),null!==(u=A.resolveRelativePositionAttribute(c,"dx"))&&(d+=k(u,f.attributeState.fontSize)),null!==(u=A.resolveRelativePositionAttribute(c,"dy"))&&(g+=k(u,f.attributeState.fontSize))),i[h]=d,n[h]=g,a=d+p.width+p.length*e,s=g,o=Math.min(o,d),l=Math.max(l,a)}var m,y,b=0;switch(this.textAnchor){case"start":b=0;break;case"middle":b=(l-o)/2;break;case"end":b=l-o}for(h=0;h<this.textNodes.length;h++)c=this.textNodes[h],f=this.contexts[h],"#text"!==c.nodeName&&"hidden"===f.attributeState.visibility||(t.pdf.saveGraphicsState(),Rt(f,t,c),m=f.attributeState.alignmentBaseline,y=ge(f.attributeState),t.pdf.text(this.texts[h],i[h]-b,n[h],{baseline:ht(m),angle:t.transform,renderingMode:"fill"===y?void 0:y,charSpace:0===e?void 0:e}),t.pdf.restoreGraphicsState());return[a,s]},A.resolveRelativePositionAttribute=function(t,e){for(var r,i=t;i&&g(i,"tspan");){if(i.hasAttribute(e))return i.getAttribute(e);if((null==(r=t.parentElement)?void 0:r.firstChild)!==t)break;i=i.parentElement}return null};var xe=A;function A(t,e,r,i){this.textNode=t,this.texts=[],this.textNodes=[],this.contexts=[],this.textAnchor=e,this.originX=r,this.originY=i,this.textMeasures=[]}e(F,Se=Yt),F.prototype.processTSpans=function(t,e,r,i,n,a){for(var s=r.pdf.getFontSize(),o=r.attributeState.xmlSpace,l=!0,h=!1,u=0;u<e.childNodes.length;u++){var c,f,p=e.childNodes[u];p.textContent&&(f=p.textContent,"#text"===p.nodeName?(c=ye(c=me(f)),"default"===o&&(c=be(c),l&&c.match(/^\s/)&&(h=!0),c.match(/[^\s]/)&&(l=!1),a.prevText.match(/\s$/)&&(c=c.replace(/^\s+/,""))),c=ve(e,c,r),n.add(e,c,r),a.prevText=f,a.prevContext=r):g(p,"title")||g(p,"tspan")&&(null!==(f=(c=p).getAttribute("x"))&&(p=k(f,s),n=new xe(this,x(c,r.styleSheets,"text-anchor")||r.attributeState.textAnchor,p,0),i.push({type:"y",chunk:n})),null!==(f=c.getAttribute("y"))&&(p=k(f,s),n=new xe(this,x(c,r.styleSheets,"text-anchor")||r.attributeState.textAnchor,0,p),i.push({type:"x",chunk:n})),Vt(f=r.clone(),t,c),this.processTSpans(t,c,f,i,n,a)))}return h},F.prototype.renderCore=function(x){return l(this,void 0,void 0,function(){var i,n,a,s,o,l,h,u,c,f,p,d,g,m,y,b,v;return S(this,function(t){if(x.pdf.saveGraphicsState(),n=0,a=1,h=x.pdf.getFontSize(),s=k(this.element.getAttribute("x"),h),o=k(this.element.getAttribute("y"),h),l=k(this.element.getAttribute("dx"),h),h=k(this.element.getAttribute("dy"),h),u=parseFloat(this.element.getAttribute("textLength")||"0"),d=x.attributeState.visibility,0===this.element.childElementCount)c=this.element.textContent||"",e=c,r=x.attributeState,e=ye(e=me(e)),g=e="default"===r.xmlSpace?be(e=e.trim()):e,g=ve(this.element,g,x),i=x.textMeasure.getTextOffset(g,x.attributeState),0<u&&(f=x.textMeasure.measureTextWidth(g,x.attributeState),"default"===x.attributeState.xmlSpace&&c.match(/^\s/)&&(a=0),n=(u-f)/(g.length-a)||0),"visible"===d&&(c=x.attributeState.alignmentBaseline,f=ge(x.attributeState),x.pdf.text(g,s+l-i,o+h,{baseline:ht(c),angle:x.transform,renderingMode:"fill"===f?void 0:f,charSpace:0===n?void 0:n}));else{for(p=[],d=new xe(this,x.attributeState.textAnchor,s+l,o+h),p.push({type:"",chunk:d}),g=this.processTSpans(this,this.element,x,p,d,{prevText:" ",prevContext:x}),a=g?0:1,m=!0,y=p.length-1;0<=y;y--)m=m&&p[y].chunk.rightTrimText();0<u&&(v=b=0,p.forEach(function(t){t=t.chunk;t.measureText(x),t.textMeasures.forEach(function(t){var e=t.width,t=t.length;b+=e,v+=t})}),n=(u-b)/(v-a)),p.reduce(function(t,e){var r=e.type,e=e.chunk;return"x"===r?e.setX(t[0]):"y"===r&&e.setY(t[1]),e.put(x,n)},[0,0])}var e,r;return x.pdf.restoreGraphicsState(),[2]})})},F.prototype.isVisible=function(t,e){return a(this,t,e)},F.prototype.getBoundingBoxCore=function(t){return yt(this.element,t)},F.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix};var Se,we=F;function F(){return null!==Se&&Se.apply(this,arguments)||this}var ke={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},Me=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];function Ce(t){return 48<=t&&t<=57}function Ae(t){this.index=0,this.path=t,this.max=t.length,this.result=[],this.param=0,this.err="",this.segmentStart=0,this.data=[]}function Fe(t){for(;t.index<t.max&&(10===(e=t.path.charCodeAt(t.index))||13===e||8232===e||8233===e||32===e||9===e||11===e||12===e||160===e||5760<=e&&0<=Me.indexOf(e));)t.index++;var e}function Te(t){var e=t.path[t.segmentStart],r=e.toLowerCase(),i=t.data;if("m"===r&&2<i.length&&(t.result.push([e,i[0],i[1]]),i=i.slice(2),r="l",e="m"===e?"l":"L"),"r"===r)t.result.push([e].concat(i));else for(;i.length>=ke[r]&&(t.result.push([e].concat(i.splice(0,ke[r]))),ke[r]););}function Pe(t){var e,r,i,n,a,s,o,l,h=t.max;if(t.segmentStart=t.index,r=97==(32|(e=t.path.charCodeAt(t.index))),function(t){switch(32|t){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:case 114:return 1}}(e))if(n=ke[t.path[t.index].toLowerCase()],t.index++,Fe(t),t.data=[],n){for(i=!1;;){for(a=n;0<a;a--){if(!r||3!==a&&4!==a?function(t){var e,r,i=t.index,n=i,a=t.max,s=!1,o=!1,l=!1;if(a<=n)t.err="SvgPath: missed param (at pos "+n+")";else if(Ce(r=43!==(r=t.path.charCodeAt(n))&&45!==r?r:++n<a?t.path.charCodeAt(n):0)||46===r){if(46!==r){if(e=48===r,r=++n<a?t.path.charCodeAt(n):0,e&&n<a&&r&&Ce(r))return t.err="SvgPath: numbers started with `0` such as `09` are illegal (at pos "+i+")";for(;n<a&&Ce(t.path.charCodeAt(n));)n++,s=!0;r=n<a?t.path.charCodeAt(n):0}if(46===r){for(l=!0,n++;Ce(t.path.charCodeAt(n));)n++,o=!0;r=n<a?t.path.charCodeAt(n):0}if(101===r||69===r){if(l&&!s&&!o)return t.err="SvgPath: invalid float exponent (at pos "+n+")";if(43!==(r=++n<a?t.path.charCodeAt(n):0)&&45!==r||n++,!(n<a&&Ce(t.path.charCodeAt(n))))return t.err="SvgPath: invalid float exponent (at pos "+n+")";for(;n<a&&Ce(t.path.charCodeAt(n));)n++}t.index=n,t.param=parseFloat(t.path.slice(i,n))+0}else t.err="SvgPath: param should start with 0..9 or `.` (at pos "+n+")"}(t):(l=void 0,48===(l=(o=t).path.charCodeAt(o.index))?(o.param=0,o.index++):49===l?(o.param=1,o.index++):o.err="SvgPath: arc flag can be 0 or 1 only (at pos "+o.index+")"),t.err.length)return;t.data.push(t.param),Fe(t),i=!1,t.index<h&&44===t.path.charCodeAt(t.index)&&(t.index++,Fe(t),i=!0)}if(!i){if(t.index>=t.max)break;if(!(48<=(s=t.path.charCodeAt(t.index))&&s<=57||43===s||45===s||46===s))break}}Te(t)}else Te(t);else t.err="SvgPath: bad command "+t.path[t.index]+" (at pos "+t.index+")"}function T(){if(!(this instanceof T))return new T;this.queue=[],this.cache=null}T.prototype.matrix=function(t){return 1===t[0]&&0===t[1]&&0===t[2]&&1===t[3]&&0===t[4]&&0===t[5]||(this.cache=null,this.queue.push(t)),this},T.prototype.translate=function(t,e){return 0===t&&0===e||(this.cache=null,this.queue.push([1,0,0,1,t,e])),this},T.prototype.scale=function(t,e){return 1===t&&1===e||(this.cache=null,this.queue.push([t,0,0,e,0,0])),this},T.prototype.rotate=function(t,e,r){var i;return 0!==t&&(this.translate(e,r),t=t*Math.PI/180,i=Math.cos(t),t=Math.sin(t),this.queue.push([i,t,-t,i,0,0]),this.cache=null,this.translate(-e,-r)),this},T.prototype.skewX=function(t){return 0!==t&&(this.cache=null,this.queue.push([1,0,Math.tan(t*Math.PI/180),1,0,0])),this},T.prototype.skewY=function(t){return 0!==t&&(this.cache=null,this.queue.push([1,Math.tan(t*Math.PI/180),0,1,0,0])),this},T.prototype.toArray=function(){if(this.cache)return this.cache;if(!this.queue.length)return this.cache=[1,0,0,1,0,0],this.cache;if(this.cache=this.queue[0],1===this.queue.length)return this.cache;for(var t,e,r=1;r<this.queue.length;r++)this.cache=(t=this.cache,e=this.queue[r],[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]);return this.cache},T.prototype.calc=function(t,e,r){var i;return this.queue.length?(this.cache||(this.cache=this.toArray()),[t*(i=this.cache)[0]+e*i[2]+(r?0:i[4]),t*i[1]+e*i[3]+(r?0:i[5])]):[t,e]};var P=T,Be={matrix:!0,scale:!0,rotate:!0,translate:!0,skewX:!0,skewY:!0},Ne=/\s*(matrix|translate|scale|rotate|skewX|skewY)\s*\(\s*(.+?)\s*\)[\s,]*/,Ee=/[\s,]+/,Le=2*Math.PI;function Oe(t,e,r,i){var n=t*r+e*i;return(n=1<n?1:n)<-1&&(n=-1),(t*i-e*r<0?-1:1)*Math.acos(n)}function Ie(t,e,r,i,n,a,s,o,l){var h=Math.sin(l*Le/360),u=Math.cos(l*Le/360),c=-h*(t-r)/2+u*(e-i)/2;if(0==(l=u*(t-r)/2+h*(e-i)/2)&&0==c)return[];if(0===s||0===o)return[];s=Math.abs(s),o=Math.abs(o);1<(l=l*l/(s*s)+c*c/(o*o))&&(s*=Math.sqrt(l),o*=Math.sqrt(l)),c=n,l=a,(b=(a=(n=s)*n)*(v=(f=o)*f)-a*(y=(m=-(p=h)*((t=t)-(r=r))/2+(d=u)*((e=e)-(i=i))/2)*m)-v*(x=(g=d*(t-r)/2+p*(e-i)/2)*g))<0&&(b=0),b/=a*y+v*x,a=(b=Math.sqrt(b)*(c===l?-1:1))*n/f*m,v=d*a-p*(y=b*-f/n*g)+(t+r)/2,x=p*a+d*y+(e+i)/2,t=(-g-a)/n,r=(-m-y)/f,p=Oe(1,0,c=(g-a)/n,b=(m-y)/f),d=Oe(c,b,t,r),0===l&&0<d&&(d-=Le),1===l&&d<0&&(d+=Le);var f,p,d,g,m,y,b,v,x,S=[v,x,p,d],w=[],k=S[2],M=S[3],C=Math.max(Math.ceil(Math.abs(M)/(Le/4)),1);M/=C;for(var A,F,T,P,B,N,E=0;E<C;E++)w.push((A=k,F=M,N=B=P=T=void 0,T=4/3*Math.tan(F/4),P=Math.cos(A),B=Math.sin(A),N=Math.cos(A+F),A=Math.sin(A+F),[P,B,P-B*T,B+P*T,N+A*T,A-N*T,N,A])),k+=M;return w.map(function(t){for(var e=0;e<t.length;e+=2){var r=t[e+0],i=t[e+1],n=u*(r*=s)-h*(i*=o),r=h*r+u*i;t[e+0]=n+S[0],t[e+1]=r+S[1]}return t})}var _e=1e-10,He=Math.PI/180;function De(t,e,r){if(!(this instanceof De))return new De(t,e,r);this.rx=t,this.ry=e,this.ax=r}De.prototype.transform=function(t){var e=Math.cos(this.ax*He),r=Math.sin(this.ax*He),r=[this.rx*(t[0]*e+t[2]*r),this.rx*(t[1]*e+t[3]*r),this.ry*(-t[0]*r+t[2]*e),this.ry*(-t[1]*r+t[3]*e)],t=r[0]*r[0]+r[2]*r[2],e=r[1]*r[1]+r[3]*r[3],i=((r[0]-r[3])*(r[0]-r[3])+(r[2]+r[1])*(r[2]+r[1]))*((r[0]+r[3])*(r[0]+r[3])+(r[2]-r[1])*(r[2]-r[1])),n=(t+e)/2;if(i<_e*n)return this.rx=this.ry=Math.sqrt(n),this.ax=0,this;var r=r[0]*r[1]+r[2]*r[3],a=n+(i=Math.sqrt(i))/2,n=n-i/2;return this.ax=Math.abs(r)<_e&&Math.abs(a-e)<_e?90:180*Math.atan(Math.abs(r)>Math.abs(a-e)?(a-t)/r:r/(a-e))/Math.PI,0<=this.ax?(this.rx=Math.sqrt(a),this.ry=Math.sqrt(n)):(this.ax+=90,this.rx=Math.sqrt(n),this.ry=Math.sqrt(a)),this},De.prototype.isDegenerate=function(){return this.rx<_e*this.ry||this.ry<_e*this.rx};var qe=De;function B(t){if(!(this instanceof B))return new B(t);t=function(t){var e=new Ae(t),r=e.max;for(Fe(e);e.index<r&&!e.err.length;)Pe(e);return e.err.length?e.result=[]:e.result.length&&("mM".indexOf(e.result[0][0])<0?(e.err="SvgPath: string should start with `M` or `m`",e.result=[]):e.result[0][0]="M"),{err:e.err,segments:e.result}}(t);this.segments=t.segments,this.err=t.err,this.__stack=[]}B.from=function(t){if("string"==typeof t)return new B(t);var e;if(t instanceof B)return(e=new B("")).err=t.err,e.segments=t.segments.map(function(t){return t.slice()}),e.__stack=t.__stack.map(function(t){return P().matrix(t.toArray())}),e;throw new Error("SvgPath.from: invalid param type "+t)},B.prototype.__matrix=function(h){var u,c=this;h.queue.length&&this.iterate(function(t,e,r,i){var n,a,s;switch(t[0]){case"v":a=0===(n=h.calc(0,t[1],!0))[0]?["v",n[1]]:["l",n[0],n[1]];break;case"V":a=(n=h.calc(r,t[1],!1))[0]===h.calc(r,i,!1)[0]?["V",n[1]]:["L",n[0],n[1]];break;case"h":a=0===(n=h.calc(t[1],0,!0))[1]?["h",n[0]]:["l",n[0],n[1]];break;case"H":a=(n=h.calc(t[1],i,!1))[1]===h.calc(r,i,!1)[1]?["H",n[0]]:["L",n[0],n[1]];break;case"a":case"A":var o=h.toArray(),l=qe(t[1],t[2],t[3]).transform(o);if(o[0]*o[3]-o[1]*o[2]<0&&(t[5]=t[5]?"0":"1"),n=h.calc(t[6],t[7],"a"===t[0]),"A"===t[0]&&t[6]===r&&t[7]===i||"a"===t[0]&&0===t[6]&&0===t[7]){a=["a"===t[0]?"l":"L",n[0],n[1]];break}a=l.isDegenerate()?["a"===t[0]?"l":"L",n[0],n[1]]:[t[0],l.rx,l.ry,l.ax,t[4],t[5],n[0],n[1]];break;case"m":a=["m",(n=h.calc(t[1],t[2],s=0<e))[0],n[1]];break;default:for(a=[o=t[0]],s=o.toLowerCase()===o,u=1;u<t.length;u+=2)n=h.calc(t[u],t[u+1],s),a.push(n[0],n[1])}c.segments[e]=a},!0)},B.prototype.__evaluateStack=function(){var t,e;if(this.__stack.length){if(1===this.__stack.length)return this.__matrix(this.__stack[0]),void(this.__stack=[]);for(t=P(),e=this.__stack.length;0<=--e;)t.matrix(this.__stack[e].toArray());this.__matrix(t),this.__stack=[]}},B.prototype.toString=function(){var t="",e="",r=!1;this.__evaluateStack();for(var i=0,n=this.segments.length;i<n;i++){for(var a=this.segments[i],s=a[0],r=s===e&&"m"!==s&&"M"!==s||("m"===s&&"z"===e&&(t+=" "),t+=s,!1),o=1;o<a.length;o++){var l=a[o];1===o?r&&0<=l&&(t+=" "):0<=l&&(t+=" "),t+=l}e=s}return t},B.prototype.translate=function(t,e){return this.__stack.push(P().translate(t,e||0)),this},B.prototype.scale=function(t,e){return this.__stack.push(P().scale(t,e||0===e?e:t)),this},B.prototype.rotate=function(t,e,r){return this.__stack.push(P().rotate(t,e||0,r||0)),this},B.prototype.skewX=function(t){return this.__stack.push(P().skewX(t)),this},B.prototype.skewY=function(t){return this.__stack.push(P().skewY(t)),this},B.prototype.matrix=function(t){return this.__stack.push(P().matrix(t)),this},B.prototype.transform=function(t){return t.trim()&&this.__stack.push((t=t,i=new P,t.split(Ne).forEach(function(t){if(t.length)if(void 0!==Be[t])e=t;else switch(r=t.split(Ee).map(function(t){return+t||0}),e){case"matrix":return void(6===r.length&&i.matrix(r));case"scale":return void(1===r.length?i.scale(r[0],r[0]):2===r.length&&i.scale(r[0],r[1]));case"rotate":return void(1===r.length?i.rotate(r[0],0,0):3===r.length&&i.rotate(r[0],r[1],r[2]));case"translate":return void(1===r.length?i.translate(r[0],0):2===r.length&&i.translate(r[0],r[1]));case"skewX":return void(1===r.length&&i.skewX(r[0]));case"skewY":return void(1===r.length&&i.skewY(r[0]))}}),i)),this;var e,r,i},B.prototype.round=function(i){var e,n=0,a=0,s=0,o=0;return i=i||0,this.__evaluateStack(),this.segments.forEach(function(r){var t=r[0].toLowerCase()===r[0];switch(r[0]){case"H":case"h":return t&&(r[1]+=s),s=r[1]-r[1].toFixed(i),void(r[1]=+r[1].toFixed(i));case"V":case"v":return t&&(r[1]+=o),o=r[1]-r[1].toFixed(i),void(r[1]=+r[1].toFixed(i));case"Z":case"z":return s=n,void(o=a);case"M":case"m":return t&&(r[1]+=s,r[2]+=o),s=r[1]-r[1].toFixed(i),o=r[2]-r[2].toFixed(i),n=s,a=o,r[1]=+r[1].toFixed(i),void(r[2]=+r[2].toFixed(i));case"A":case"a":return t&&(r[6]+=s,r[7]+=o),s=r[6]-r[6].toFixed(i),o=r[7]-r[7].toFixed(i),r[1]=+r[1].toFixed(i),r[2]=+r[2].toFixed(i),r[3]=+r[3].toFixed(i+2),r[6]=+r[6].toFixed(i),void(r[7]=+r[7].toFixed(i));default:return e=r.length,t&&(r[e-2]+=s,r[e-1]+=o),s=r[e-2]-r[e-2].toFixed(i),o=r[e-1]-r[e-1].toFixed(i),void r.forEach(function(t,e){e&&(r[e]=+r[e].toFixed(i))})}}),this},B.prototype.iterate=function(n,t){var e,r,i,a=this.segments,s={},o=!1,l=0,h=0,u=0,c=0;if(t||this.__evaluateStack(),a.forEach(function(t,e){var r=n(t,e,l,h),i=(Array.isArray(r)&&(s[e]=r,o=!0),t[0]===t[0].toLowerCase());switch(t[0]){case"m":case"M":return l=t[1]+(i?l:0),h=t[2]+(i?h:0),u=l,void(c=h);case"h":case"H":return void(l=t[1]+(i?l:0));case"v":case"V":return void(h=t[1]+(i?h:0));case"z":case"Z":return l=u,void(h=c);default:l=t[t.length-2]+(i?l:0),h=t[t.length-1]+(i?h:0)}}),!o)return this;for(i=[],e=0;e<a.length;e++)if(void 0!==s[e])for(r=0;r<s[e].length;r++)i.push(s[e][r]);else i.push(a[e]);return this.segments=i,this},B.prototype.abs=function(){return this.iterate(function(t,e,r,i){var n,a=t[0],s=a.toUpperCase();if(a!==s)switch(t[0]=s,a){case"v":return void(t[1]+=i);case"a":return t[6]+=r,void(t[7]+=i);default:for(n=1;n<t.length;n++)t[n]+=n%2?r:i}},!0),this},B.prototype.rel=function(){return this.iterate(function(t,e,r,i){var n,a=t[0],s=a.toLowerCase();if(a!==s&&(0!==e||"M"!==a))switch(t[0]=s,a){case"V":return void(t[1]-=i);case"A":return t[6]-=r,void(t[7]-=i);default:for(n=1;n<t.length;n++)t[n]-=n%2?r:i}},!0),this},B.prototype.unarc=function(){return this.iterate(function(t,e,r,i){var n,a=[],s=t[0];return"A"!==s&&"a"!==s?null:(s="a"===s?(n=r+t[6],i+t[7]):(n=t[6],t[7]),0===(r=Ie(r,i,n,s,t[4],t[5],t[1],t[2],t[3])).length?[["a"===t[0]?"l":"L",t[6],t[7]]]:(r.forEach(function(t){a.push(["C",t[2],t[3],t[4],t[5],t[6],t[7]])}),a))}),this},B.prototype.unshort=function(){var o,l,h,u,c,f=this.segments;return this.iterate(function(t,e,r,i){var n,a=t[0],s=a.toUpperCase();e&&("T"===s?(h=f[e-1],l="Q"===h[0]?(o=h[1]-r,h[2]-i):"q"===h[0]?(o=h[1]-h[3],h[2]-h[4]):o=0,u=-o,c=-l,(n="t"===a)||(u+=r,c+=i),f[e]=[n?"q":"Q",u,c,t[1],t[2]]):"S"===s&&(h=f[e-1],l="C"===h[0]?(o=h[3]-r,h[4]-i):"c"===h[0]?(o=h[3]-h[5],h[4]-h[6]):o=0,u=-o,c=-l,(n="s"===a)||(u+=r,c+=i),f[e]=[n?"c":"C",u,c,t[1],t[2],t[3],t[4]]))}),this};var Ve,Re=B,je=(e(We,Ve=o),We.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},We.prototype.isVisible=function(t,e){return n(this,t,e)},We.prototype.getPath=function(t){var i,n,t=new Re(x(this.element,t.styleSheets,"d")||"").unshort().unarc().abs(),a=new rt;return t.iterate(function(t){switch(t[0]){case"M":a.moveTo(t[1],t[2]);break;case"L":a.lineTo(t[1],t[2]);break;case"H":a.lineTo(t[1],n);break;case"V":a.lineTo(i,t[1]);break;case"C":a.curveTo(t[1],t[2],t[3],t[4],t[5],t[6]);break;case"Q":var e=K([i,n],[t[1],t[2]]),r=K([t[3],t[4]],[t[1],t[2]]);a.curveTo(e[0],e[1],r[0],r[1],t[3],t[4]);break;case"Z":a.close()}switch(t[0]){case"M":case"L":i=t[1],n=t[2];break;case"H":i=t[1];break;case"V":n=t[1];break;case"C":i=t[5],n=t[6];break;case"Q":i=t[3],n=t[4]}}),a},We);function We(t,e){return Ve.call(this,!0,t,e)||this}var Ge,Ue=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,((?:.|\s)*)$/i,ze=(e(N,Ge=Yt),N.prototype.renderCore=function(h){return l(this,void 0,void 0,function(){var e,r,i,n,a,s,o,l;return S(this,function(t){switch(t.label){case 0:return this.imageLoadingPromise?(h.pdf.setCurrentTransformationMatrix(h.transform),e=parseFloat(x(this.element,h.styleSheets,"width")||"0"),r=parseFloat(x(this.element,h.styleSheets,"height")||"0"),i=parseFloat(x(this.element,h.styleSheets,"x")||"0"),n=parseFloat(x(this.element,h.styleSheets,"y")||"0"),!isFinite(e)||e<=0||!isFinite(r)||r<=0?[2]:[4,this.imageLoadingPromise]):[2];case 1:return(s=t.sent(),a=s.data,0!==(s=s.format).indexOf("svg"))?[3,3]:(l=new DOMParser,l=l.parseFromString(a,"image/svg+xml").firstElementChild,(o=this.element.getAttribute("preserveAspectRatio"))&&!(o.indexOf("defer")<0)&&l.getAttribute("preserveAspectRatio")||l.setAttribute("preserveAspectRatio",o||""),l.setAttribute("x",String(i)),l.setAttribute("y",String(n)),l.setAttribute("width",String(e)),l.setAttribute("height",String(r)),[4,vr(l,o={}).render(new d(h.pdf,{refsHandler:new Q(o),styleSheets:h.styleSheets,viewport:new ne(e,r),svg2pdfParameters:h.svg2pdfParameters,textMeasure:h.textMeasure}))]);case 2:return t.sent(),[2];case 3:l="data:image/"+s+";base64,"+btoa(a);try{h.pdf.addImage(l,"",i,n,e,r)}catch(t){"object"==typeof console&&console.warn&&console.warn("Could not load image "+this.imageUrl+". \n"+t)}t.label=4;case 4:return[2]}})})},N.prototype.getBoundingBoxCore=function(t){return yt(this.element,t)},N.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},N.prototype.isVisible=function(t,e){return n(this,t,e)},N.fetchImageData=function(n){return l(this,void 0,void 0,function(){var e,r,i;return S(this,function(t){switch(t.label){case 0:if(!(r=n.match(Ue)))return[3,1];if(i=r[2],"image"!==(i=i.split("/"))[0])throw new Error("Unsupported image URL: "+n);return i=i[1],e=r[5],e="base64"===r[4]?(e=e.replace(/\s/g,""),atob(e)):decodeURIComponent(e),[3,3];case 1:return[4,N.fetchImage(n)];case 2:e=t.sent(),i=n.substring(n.lastIndexOf(".")+1),t.label=3;case 3:return[2,{data:e,format:i}]}})})},N.fetchImage=function(a){return new Promise(function(i,t){var n=new XMLHttpRequest;n.open("GET",a,!0),n.responseType="arraybuffer",n.onload=function(){if(200!==n.status)throw new Error("Error "+n.status+": Failed to load image '"+a+"'");for(var t=new Uint8Array(n.response),e="",r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);i(e)},n.onerror=t,n.onabort=t,n.send(null)})},N.getMimeType=function(t){switch(t=t.toLowerCase()){case"jpg":case"jpeg":return"image/jpeg";default:return"image/"+t}},N);function N(t,e){t=Ge.call(this,t,e)||this;return t.imageLoadingPromise=null,t.imageUrl=t.element.getAttribute("xlink:href")||t.element.getAttribute("href"),t.imageUrl&&(t.imageLoadingPromise=N.fetchImageData(t.imageUrl)),t}e(E,Ye=o),E.prototype.getPath=function(t){if(!this.element.hasAttribute("points")||""===this.element.getAttribute("points"))return null;var e=E.parsePointsString(this.element.getAttribute("points")),r=new rt;if(e.length<1)return r;r.moveTo(e[0][0],e[0][1]);for(var i=1;i<e.length;i++)r.lineTo(e[i][0],e[i][1]);return this.closed&&r.close(),r},E.prototype.isVisible=function(t,e){return n(this,t,e)},E.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},E.parsePointsString=function(t){for(var e=m(t),r=[],i=0;i<e.length-1;i+=2){var n=e[i],a=e[i+1];r.push([n,a])}return r};var Ye,Yt=E;function E(t,e,r){e=Ye.call(this,!0,e,r)||this;return e.closed=t,e}e($e,Xe=Yt);var Xe,Qe=$e;function $e(t,e){return Xe.call(this,!0,t,e)||this}e(Je,Ke=t),Je.prototype.render=function(t){return Promise.resolve()},Je.prototype.getBoundingBoxCore=function(t){return[0,0,0,0]},Je.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix},Je.prototype.isVisible=function(t,e){return n(this,t,e)};var Ke,Ze=Je;function Je(){return null!==Ke&&Ke.apply(this,arguments)||this}e(rr,tr=wt),rr.prototype.apply=function(h){return l(this,void 0,void 0,function(){var s,o,l;return S(this,function(t){switch(t.label){case 0:o=this.computeNodeTransform(h),s=this.getBoundingBox(h),h.pdf.beginFormObject(s[0],s[1],s[2],s[3],o),s=new d(h.pdf,{refsHandler:h.refsHandler,styleSheets:h.styleSheets,viewport:h.viewport,svg2pdfParameters:h.svg2pdfParameters,textMeasure:h.textMeasure});var e=(r=s).attributeState,r=r.pdf,i=1,n=1,a=(i=(i*=e.fillOpacity)*e.opacity,e.fill instanceof f&&void 0!==e.fill.color.a&&(i*=e.fill.color.a),n=(n*=e.strokeOpacity)*e.opacity,e.stroke instanceof f&&void 0!==e.stroke.color.a&&(n*=e.stroke.color.a),(a={}).opacity=i,a["stroke-opacity"]=n,r.setGState(new u.GState(a)),e.fill&&e.fill instanceof f&&e.fill.color.ok?r.setFillColor(e.fill.color.r,e.fill.color.g,e.fill.color.b):r.setFillColor(0,0,0),r.setLineWidth(e.strokeWidth),e.stroke instanceof f?r.setDrawColor(e.stroke.color.r,e.stroke.color.g,e.stroke.color.b):r.setDrawColor(0,0,0),r.setLineCap(e.strokeLinecap),r.setLineJoin(e.strokeLinejoin),e.strokeDasharray?r.setLineDashPattern(e.strokeDasharray,e.strokeDashoffset):r.setLineDashPattern([],0),r.setLineMiterLimit(e.strokeMiterlimit),i=p.hasOwnProperty(e.fontFamily)?p[e.fontFamily]:e.fontFamily,e.fill&&e.fill instanceof f&&e.fill.color.ok?(n=e.fill.color,r.setTextColor(n.r,n.g,n.b)):r.setTextColor(0,0,0),"");"bold"===e.fontWeight&&(a="bold"),"italic"===e.fontStyle&&(a+="italic"),""===a&&(a="normal"),void 0!==i||void 0!==a?(void 0===i&&(i=p.hasOwnProperty(e.fontFamily)?p[e.fontFamily]:e.fontFamily),r.setFont(i,a)):r.setFont("helvetica",a),r.setFontSize(e.fontSize*r.internal.scaleFactor),o=0,l=this.children,t.label=1;case 1:return o<l.length?[4,l[o].render(s)]:[3,4];case 2:t.sent(),t.label=3;case 3:return o++,[3,1];case 4:return h.pdf.endFormObject(this.element.getAttribute("id")),[2]}})})},rr.prototype.getBoundingBoxCore=function(t){var e,r=this.element.getAttribute("viewBox");return[(e=r?m(r):e)&&e[0]||0,e&&e[1]||0,e&&e[2]||parseFloat(this.element.getAttribute("markerWidth")||"3"),e&&e[3]||parseFloat(this.element.getAttribute("markerHeight")||"3")]},rr.prototype.computeNodeTransformCore=function(t){var e,r=parseFloat(this.element.getAttribute("refX")||"0"),i=parseFloat(this.element.getAttribute("refY")||"0"),n=this.element.getAttribute("viewBox");return e=n?(n=m(n),e=bt(this.element,n,0,0,parseFloat(this.element.getAttribute("markerWidth")||"3"),parseFloat(this.element.getAttribute("markerHeight")||"3"),t,!0),t.pdf.matrixMult(t.pdf.Matrix(1,0,0,1,-r,-i),e)):t.pdf.Matrix(1,0,0,1,-r,-i)},rr.prototype.isVisible=function(t,e){return a(this,t,e)};var tr,er=rr;function rr(){return null!==tr&&tr.apply(this,arguments)||this}e(ar,ir=ue),ar.prototype.getR=function(t){var e;return null!=(e=this.r)?e:this.r=parseFloat(x(this.element,t.styleSheets,"r")||"0")},ar.prototype.getRx=function(t){return this.getR(t)},ar.prototype.getRy=function(t){return this.getR(t)};var ir,nr=ar;function ar(t,e){return ir.call(this,t,e)||this}e(lr,sr=Yt);var sr,or=lr;function lr(t,e){return sr.call(this,!1,t,e)||this}e(ur,hr=Ct),ur.prototype.renderCore=function(i){return l(this,void 0,void 0,function(){var e,r;return S(this,function(t){switch(t.label){case 0:e=0,r=this.children,t.label=1;case 1:return e<r.length?[4,r[e].render(i)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},ur.prototype.getBoundingBoxCore=function(t){return mt(t,this)};var hr,o=ur;function ur(){return null!==hr&&hr.apply(this,arguments)||this}e(L,cr=o),L.prototype.isVisible=function(t,e){return a(this,t,e)},L.prototype.render=function(s){return l(this,void 0,void 0,function(){var e,r,i,n,a;return S(this,function(t){switch(t.label){case 0:return this.isVisible("hidden"!==s.attributeState.visibility,s)?(e=this.getX(s),r=this.getY(s),i=this.getWidth(s),n=this.getHeight(s),s.pdf.saveGraphicsState(),a=s.transform,this.element.hasAttribute("transform")&&(a=s.pdf.matrixMult(vt(this.element.getAttribute("transform"),s),a)),s.pdf.setCurrentTransformationMatrix(a),s.withinUse||"visible"===x(this.element,s.styleSheets,"overflow")||s.pdf.rect(e,r,i,n).clip().discardPath(),[4,cr.prototype.render.call(this,s.clone({transform:s.pdf.unitMatrix,viewport:s.withinUse?s.viewport:new ne(i,n)}))]):[2];case 1:return t.sent(),s.pdf.restoreGraphicsState(),[2]}})})},L.prototype.computeNodeTransform=function(t){return this.computeNodeTransformCore(t)},L.prototype.computeNodeTransformCore=function(t){if(t.withinUse)return t.pdf.unitMatrix;var e,r,i=this.getX(t),n=this.getY(t),a=this.getViewBox();return a?(e=this.getWidth(t),r=this.getHeight(t),bt(this.element,a,i,n,e,r,t)):t.pdf.Matrix(1,0,0,1,i,n)},L.prototype.getWidth=function(t){if(void 0!==this.width)return this.width;var e,r,i=t.svg2pdfParameters;return e=this.isOutermostSvg(t)?null!=i.width?i.width:(r=x(this.element,t.styleSheets,"width"))?parseFloat(r):(e=this.getViewBox())&&(null!=i.height||x(this.element,t.styleSheets,"height"))?(i=e[2]/e[3],this.getHeight(t)*i):Math.min(300,t.viewport.width,2*t.viewport.height):(r=x(this.element,t.styleSheets,"width"))?parseFloat(r):t.viewport.width,this.width=e},L.prototype.getHeight=function(t){if(void 0!==this.height)return this.height;var e,r=t.svg2pdfParameters;return r=this.isOutermostSvg(t)?null!=r.height?r.height:(e=x(this.element,t.styleSheets,"height"))?parseFloat(e):(r=this.getViewBox())?(r=r[2]/r[3],this.getWidth(t)/r):Math.min(150,t.viewport.width/2,t.viewport.height):(e=x(this.element,t.styleSheets,"height"))?parseFloat(e):t.viewport.height,this.height=r},L.prototype.getX=function(t){if(void 0!==this.x)return this.x;if(this.isOutermostSvg(t))return this.x=0;t=x(this.element,t.styleSheets,"x");return this.x=t?parseFloat(t):0},L.prototype.getY=function(t){if(void 0!==this.y)return this.y;if(this.isOutermostSvg(t))return this.y=0;t=x(this.element,t.styleSheets,"y");return this.y=t?parseFloat(t):0},L.prototype.getViewBox=function(){if(void 0!==this.viewBox)return this.viewBox;var t=this.element.getAttribute("viewBox");return this.viewBox=t?m(t):void 0},L.prototype.isOutermostSvg=function(t){return t.svg2pdfParameters.element===this.element};var cr,fr=L;function L(){return null!==cr&&cr.apply(this,arguments)||this}e(gr,pr=o),gr.prototype.isVisible=function(t,e){return a(this,t,e)},gr.prototype.computeNodeTransformCore=function(t){return t.pdf.unitMatrix};var pr,dr=gr;function gr(){return null!==pr&&pr.apply(this,arguments)||this}e(br,mr=wt),br.prototype.apply=function(n){return l(this,void 0,void 0,function(){var e,r,i;return S(this,function(t){switch(t.label){case 0:if(!this.isVisible(!0,n))return[2];e=n.pdf.matrixMult(this.computeNodeTransform(n),n.transform),n.pdf.setCurrentTransformationMatrix(e),r=0,i=this.children,t.label=1;case 1:return r<i.length?[4,i[r].render(new d(n.pdf,{refsHandler:n.refsHandler,styleSheets:n.styleSheets,viewport:n.viewport,withinClipPath:!0,svg2pdfParameters:n.svg2pdfParameters,textMeasure:n.textMeasure}))]:[3,4];case 2:t.sent(),t.label=3;case 3:return r++,[3,1];case 4:return n.pdf.clip().discardPath(),n.pdf.setCurrentTransformationMatrix(e.inversed()),[2]}})})},br.prototype.getBoundingBoxCore=function(t){return mt(t,this)},br.prototype.isVisible=function(t,e){return a(this,t,e)};var mr,yr=br;function br(){return null!==mr&&mr.apply(this,arguments)||this}function vr(t,r){for(var e,i,n=[],a=t,s=function(t,e){n.push(vr(e,r))},o=[],l=0;l<a.childNodes.length;l++){var h=a.childNodes[l];"#"!==h.nodeName.charAt(0)&&o.push(h)}for(l=0;l<o.length;l++)s(l,o[l]);switch(t.tagName.toLowerCase()){case"a":case"g":e=new dr(t,n);break;case"circle":e=new nr(t,n);break;case"clippath":e=new yr(t,n);break;case"ellipse":e=new pe(t,n);break;case"lineargradient":e=new Ft(t,n);break;case"image":e=new ze(t,n);break;case"line":e=new Zt(t,n);break;case"marker":e=new er(t,n);break;case"path":e=new je(t,n);break;case"pattern":e=new It(t,n);break;case"polygon":e=new Qe(t,n);break;case"polyline":e=new or(t,n);break;case"radialgradient":e=new Bt(t,n);break;case"rect":e=new oe(t,n);break;case"svg":e=new fr(t,n);break;case"symbol":e=new ee(t,n);break;case"text":e=new we(t,n);break;case"use":e=new ae(t,n);break;default:e=new Ze(t,n)}return null!=r&&e.element.hasAttribute("id")&&(i=X(e.element.id,{isIdentifier:!0}),r[i]=r[i]||e),e.children.forEach(function(t){return t.setParent(e)}),e}var xr=function(l){var t,h=l,u={a:0,b:0,c:0},c=[];function e(t){var e,r,i,n;if(t.test(h))for(r=0,i=(e=h.match(t)).length;r<i;r+=1)n=e[r],h=h.replace(n,Array(n.length+1).join("A"))}t=function(t,e){var r,i,n,a,s,o;if(t.test(h))for(i=0,n=(r=h.match(t)).length;i<n;i+=1)u[e]+=1,a=r[i],s=h.indexOf(a),o=a.length,c.push({selector:l.substr(s,o),type:e,index:s,length:o}),h=h.replace(a,Array(o+1).join(" "))},e(/\\[0-9A-Fa-f]{6}\s?/g),e(/\\[0-9A-Fa-f]{1,5}\s/g),e(/\\./g);var r,i,n,a,s=/{[^]*/gm;if(s.test(h))for(i=0,n=(r=h.match(s)).length;i<n;i+=1)a=r[i],h=h.replace(a,Array(a.length+1).join(" "));return t(/(\[[^\]]+\])/g,"b"),t(/(#[^\#\s\+>~\.\[:\)]+)/g,"a"),t(/(\.[^\s\+>~\.\[:\)]+)/g,"b"),t(/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,"c"),t(/(:(?!not|global|local)[\w-]+\([^\)]*\))/gi,"b"),t(/(:(?!not|global|local)[^\s\+>~\.\[:]+)/g,"b"),h=(h=(h=(h=(h=(h=h.replace(/[\*\s\+>~]/g," ")).replace(/[#\.]/g," ")).replace(/:not/g,"    ")).replace(/:local/g,"      ")).replace(/:global/g,"       ")).replace(/[\(\)]/g," "),t(/([^\s\+>~\.\[:]+)/g,"c"),c.sort(function(t,e){return t.index-e.index}),{selector:l,specificity:"0,"+u.a.toString()+","+u.b.toString()+","+u.c.toString(),specificityArray:[0,u.a,u.b,u.c],parts:c}},Sr=(O.prototype.load=function(){return l(this,void 0,void 0,function(){var e;return S(this,function(t){switch(t.label){case 0:return[4,this.collectStyleSheetTexts()];case 1:return e=t.sent(),this.parseCssSheets(e),[2]}})})},O.prototype.collectStyleSheetTexts=function(){return l(this,void 0,void 0,function(){var e,r,i,n,a;return S(this,function(t){switch(t.label){case 0:if(e=[],this.loadExternalSheets&&this.rootSvg.ownerDocument)for(n=0;n<this.rootSvg.ownerDocument.childNodes.length;n++)"xml-stylesheet"===(r=this.rootSvg.ownerDocument.childNodes[n]).nodeName&&"string"==typeof r.data&&e.push(O.loadSheet(r.data.match(/href=["'].*?["']/)[0].split("=")[1].slice(1,-1)));for(i=this.rootSvg.querySelectorAll("style,link"),n=0;n<i.length;n++)g(a=i[n],"style")?e.push(a.textContent):this.loadExternalSheets&&g(a,"link")&&"stylesheet"===a.getAttribute("rel")&&a.hasAttribute("href")&&e.push(O.loadSheet(a.getAttribute("href")));return[4,Promise.all(e)];case 1:return[2,t.sent().filter(function(t){return null!==t})]}})})},O.prototype.parseCssSheets=function(t){for(var e=document.implementation.createHTMLDocument(""),r=0,i=t;r<i.length;r++){var n=i[r],a=e.createElement("style"),s=(a.textContent=n,e.body.appendChild(a),a.sheet);if(s instanceof CSSStyleSheet){for(var o=s.cssRules.length-1;0<=o;o--){var l=s.cssRules[o];if(l instanceof CSSStyleRule){if(0<=l.selectorText.indexOf(",")){s.deleteRule(o);for(var h=l.cssText.substring(l.selectorText.length),u=O.splitSelectorAtCommas(l.selectorText),c=0;c<u.length;c++)s.insertRule(u[c]+h,o+c)}}else s.deleteRule(o)}this.styleSheets.push(s)}}},O.splitSelectorAtCommas=function(t){for(var e,r=/,|["']/g,i=/[^\\]["]/g,n=/[^\\][']/g,a=[],s="initial",o=-1,l=i,h=0;h<t.length;)switch(s){case"initial":r.lastIndex=h,h=(e=r.exec(t))?(","===e[0]?(a.push(t.substring(o+1,r.lastIndex-1).trim()),o=r.lastIndex-1):(s="withinQuotes",l='"'===e[0]?i:n),r.lastIndex):(a.push(t.substring(o+1).trim()),t.length);break;case"withinQuotes":l.lastIndex=h,(e=l.exec(t))&&(h=l.lastIndex,s="initial")}return a},O.loadSheet=function(i){return new Promise(function(t,e){var r=new XMLHttpRequest;r.open("GET",i,!0),r.responseType="text",r.onload=function(){200!==r.status&&e(new Error("Error "+r.status+": Failed to load '"+i+"'")),t(r.responseText)},r.onerror=e,r.onabort=e,r.send(null)}).catch(function(){return null})},O.prototype.getPropertyValue=function(t,o){for(var r,e=[],i=0,n=this.styleSheets;i<n.length;i++)for(var a=n[i],s=0;s<a.cssRules.length;s++){var l=a.cssRules[s];l.style.getPropertyValue(o)&&t.matches(l.selectorText)&&e.push(l)}if(0!==e.length)return r=function(t,e){var r,i,n,a=t.style.getPropertyPriority(o),s=e.style.getPropertyPriority(o);if(a!==s)return"important"===a?1:-1;s=t.selectorText,a=e.selectorText;if("string"==typeof s){if(-1!==s.indexOf(","))throw"Invalid CSS selector";r=xr(s).specificityArray}else{if(!Array.isArray(s))throw"Invalid CSS selector or specificity array";if(4!==s.filter(function(t){return"number"==typeof t}).length)throw"Invalid specificity array";r=s}if("string"==typeof a){if(-1!==a.indexOf(","))throw"Invalid CSS selector";i=xr(a).specificityArray}else{if(!Array.isArray(a))throw"Invalid CSS selector or specificity array";if(4!==a.filter(function(t){return"number"==typeof t}).length)throw"Invalid specificity array";i=a}for(n=0;n<4;n+=1){if(r[n]<i[n])return-1;if(r[n]>i[n])return 1}return 0},e.reduce(function(t,e){return 1===r(t,e)?t:e}).style.getPropertyValue(o)||void 0},O);function O(t,e){this.rootSvg=t,this.loadExternalSheets=e,this.styleSheets=[]}I.prototype.getTextOffset=function(t,e){var r=e.textAnchor;if("start"===r)return 0;var i=this.measureTextWidth(t,e),n=0;switch(r){case"end":n=i;break;case"middle":n=i/2}return n},I.prototype.measureTextWidth=function(t,e){if(0===t.length)return 0;var r=e.fontFamily;return this.getMeasureFunction(r).call(this,t,e.fontFamily,e.fontSize+"px",e.fontStyle,e.fontWeight)},I.prototype.getMeasurementTextNode=function(){var t;return this.textMeasuringTextElement||(this.textMeasuringTextElement=document.createElementNS(lt,"text"),(t=document.createElementNS(lt,"svg")).appendChild(this.textMeasuringTextElement),t.style.setProperty("position","absolute"),t.style.setProperty("visibility","hidden"),document.body.appendChild(t)),this.textMeasuringTextElement},I.prototype.canvasTextMeasure=function(t,e,r,i,n){var a=document.createElement("canvas").getContext("2d");return null!=a?(a.font=[i,n,r,e].join(" "),a.measureText(t).width):0},I.prototype.svgTextMeasure=function(t,e,r,i,n,a){a=void 0===a?this.getMeasurementTextNode():a;return a.setAttribute("font-family",e),a.setAttribute("font-size",r),a.setAttribute("font-style",i),a.setAttribute("font-weight",n),a.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),a.textContent=t,a.getBBox().width},I.prototype.getMeasureFunction=function(t){var e,r,i=this.measureMethods[t];return i||(e=this.canvasTextMeasure(I.testString,t,"16px","normal","normal"),r=this.svgTextMeasure(I.testString,t,"16px","normal","normal"),i=Math.abs(e-r)<I.epsilon?this.canvasTextMeasure:this.svgTextMeasure,this.measureMethods[t]=i),i},I.prototype.cleanupTextMeasuring=function(){var t;this.textMeasuringTextElement&&((t=this.textMeasuringTextElement.parentNode)&&document.body.removeChild(t),this.textMeasuringTextElement=void 0)},I.testString="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789!\"$%&/()=?'\\+*-_.:,;^}][{#~|<>",I.epsilon=.1;var wr=I;function I(){this.measureMethods={}}function kr(h,u,c){var f;return void 0===c&&(c={}),l(this,void 0,void 0,function(){var e,r,i,n,a,s,o,l;return S(this,function(t){switch(t.label){case 0:return e=null!=(f=c.x)?f:0,r=null!=(f=c.y)?f:0,a=null!=(f=c.loadExternalStyleSheets)&&f,n=new Q(i={}),[4,(a=new Sr(h,a)).load()];case 1:return t.sent(),o=new ne(u.internal.pageSize.getWidth(),u.internal.pageSize.getHeight()),l=D(D({},c),{element:h}),s=new wr,o=new d(u,{refsHandler:n,styleSheets:a,viewport:o,svg2pdfParameters:l,textMeasure:s}),u.advancedAPI(),u.saveGraphicsState(),u.setCurrentTransformationMatrix(u.Matrix(1,0,0,1,e,r)),u.setLineWidth(o.attributeState.strokeWidth),l=o.attributeState.fill.color,u.setFillColor(l.r,l.g,l.b),u.setFont(o.attributeState.fontFamily),u.setFontSize(o.attributeState.fontSize*u.internal.scaleFactor),[4,vr(h,i).render(o)];case 2:return t.sent(),u.restoreGraphicsState(),u.compatAPI(),o.textMeasure.cleanupTextMeasuring(),[2,u]}})})}u.jsPDF.API.svg=function(t,e){return kr(t,this,e=void 0===e?{}:e)},_.svg2pdf=kr,Object.defineProperty(_,"__esModule",{value:!0})});
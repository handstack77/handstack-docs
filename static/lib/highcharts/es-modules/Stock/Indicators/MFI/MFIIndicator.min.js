"use strict";import SeriesRegistry from"../../../Core/Series/SeriesRegistry.js";const SMAIndicator=SeriesRegistry.seriesTypes["sma"];import U from"../../../Core/Utilities.js";const{extend,merge,error,isArray}=U;function sumArray(e){return e.reduce(function(e,r){return e+r})}function toFixed(e,r){return parseFloat(e.toFixed(r))}function calculateTypicalPrice(e){return(e[1]+e[2]+e[3])/3}function calculateRawMoneyFlow(e,r){return e*r}class MFIIndicator extends SMAIndicator{getValues(e,r){const t=r.period,a=e.xData,i=e.yData,s=i?i.length:0,o=r.decimals,c=e.chart.get(r.volumeSeriesID),n=c&&c.yData,l=[],u=[],d=[],p=[],y=[];let m,f,I,h,S,F,g=!1,M=1;if(c){if(!(a.length<=t)&&isArray(i[0])&&4===i[0].length&&n){for(m=calculateTypicalPrice(i[M]);M<t+1;)f=m,m=calculateTypicalPrice(i[M]),g=m>=f,I=calculateRawMoneyFlow(m,n[M]),p.push(g?I:0),y.push(g?0:I),M++;for(F=M-1;F<s;F++)F>M-1&&(p.shift(),y.shift(),f=m,m=calculateTypicalPrice(i[F]),g=m>f,I=calculateRawMoneyFlow(m,n[F]),p.push(g?I:0),y.push(g?0:I)),h=sumArray(y),S=toFixed(100-100/(1+sumArray(p)/h),o),l.push([a[F],S]),u.push(a[F]),d.push(S);return{values:l,xData:u,yData:d}}}else error("Series "+r.volumeSeriesID+" not found! Check `volumeSeriesID`.",!0,e.chart)}}MFIIndicator.defaultOptions=merge(SMAIndicator.defaultOptions,{params:{index:void 0,volumeSeriesID:"volume",decimals:4}}),extend(MFIIndicator.prototype,{nameBase:"Money Flow Index"}),SeriesRegistry.registerSeriesType("mfi",MFIIndicator);export default MFIIndicator;
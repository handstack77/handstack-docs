"use strict";import D from"../../Core/Defaults.js";const setOptions=D["setOptions"];import NBU from"../../Extensions/Annotations/NavigationBindingsUtilities.js";const getAssignedAxis=NBU["getAssignedAxis"];import StockToolsBindings from"./StockToolsBindings.js";import StockToolsDefaults from"./StockToolsDefaults.js";import STU from"./StockToolsUtilities.js";const{isNotNavigatorYAxis,isPriceIndicatorEnabled}=STU;import U from"../../Core/Utilities.js";const{correctFloat,defined,isNumber,pick}=U;function compose(t){const i=t.prototype;i.utils?.manageIndicators||(i.getYAxisPositions=navigationGetYAxisPositions,i.getYAxisResizers=navigationGetYAxisResizers,i.recalculateYAxisPositions=navigationRecalculateYAxisPositions,i.resizeYAxes=navigationResizeYAxes,i.utils=i.utils||{},i.utils.indicatorsWithAxes=STU.indicatorsWithAxes,i.utils.indicatorsWithVolume=STU.indicatorsWithVolume,i.utils.getAssignedAxis=getAssignedAxis,i.utils.isPriceIndicatorEnabled=isPriceIndicatorEnabled,i.utils.manageIndicators=STU.manageIndicators,setOptions(StockToolsDefaults),setOptions({navigation:{bindings:StockToolsBindings}}))}function navigationGetYAxisPositions(e,n,a,t){let r=0,c,l,g;function h(t){return defined(t)&&!isNumber(t)&&t.match("%")}return t&&(g=correctFloat(parseFloat(t.top)/100),l=correctFloat(parseFloat(t.height)/100)),{positions:e.map((t,i)=>{let o=correctFloat(h(t.options.height)?parseFloat(t.options.height)/100:t.height/n),s=correctFloat(h(t.options.top)?parseFloat(t.options.top)/100:(t.top-t.chart.plotTop)/n);return r=l?(s>g&&(s-=l),Math.max(r,(s||0)+(o||0))):(isNumber(o)||(o=e[i-1].series.every(t=>t.is("sma"))?c:a/100),isNumber(s)||(s=r),c=o,correctFloat(Math.max(r,(s||0)+(o||0)))),{height:100*o,top:100*s}}),allAxesHeight:r}}function navigationGetYAxisResizers(s){const e=[];return s.forEach(function(t,i){var o=s[i+1];e[i]=o?{enabled:!0,controlledAxis:{next:[pick(o.options.id,o.index)]}}:{enabled:!1}}),e}function navigationRecalculateYAxisPositions(o,s,e,n){return o.forEach(function(t,i){i=o[i-1];t.top=i?correctFloat(i.height+i.top):0,e&&(t.height=correctFloat(t.height+n*s))}),o}function navigationResizeYAxes(t){const i=this.chart,o=i.yAxis.filter(isNotNavigatorYAxis),s=i.plotHeight,{positions:e,allAxesHeight:n}=this.getYAxisPositions(o,s,20,t),a=this.getYAxisResizers(o);!t&&n<=correctFloat(1)?e[e.length-1]={height:20,top:correctFloat(100*n-20)}:e.forEach(function(t){t.height=t.height/(100*n)*100,t.top=t.top/(100*n)*100}),e.forEach(function(t,i){o[i].update({height:t.height+"%",top:t.top+"%",resize:a[i],offset:0},!1)})}const StockTools={compose:compose};export default StockTools;
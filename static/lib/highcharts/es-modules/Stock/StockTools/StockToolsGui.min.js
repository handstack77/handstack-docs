"use strict";import D from"../../Core/Defaults.js";const setOptions=D["setOptions"];import StockToolsDefaults from"./StockToolsDefaults.js";import Toolbar from"./StockToolbar.js";import U from"../../Core/Utilities.js";const{addEvent,getStyle,merge,pick}=U;function chartSetStockTools(t){var o=this.options,s=o.lang,o=merge(o.stockTools&&o.stockTools.gui,t&&t.gui),t=s&&s.stockTools&&s.stockTools.gui;this.stockTools=new Toolbar(o,t,this),this.stockTools.guiEnabled&&(this.isDirtyBox=!0)}function compose(t,o){const s=t.prototype;s.setStockTools||(addEvent(t,"afterGetContainer",onChartAfterGetContainer),addEvent(t,"beforeRedraw",onChartBeforeRedraw),addEvent(t,"beforeRender",onChartBeforeRedraw),addEvent(t,"destroy",onChartDestroy),addEvent(t,"getMargins",onChartGetMargins,{order:0}),addEvent(t,"render",onChartRender),s.setStockTools=chartSetStockTools,addEvent(o,"deselectButton",onNavigationBindingsDeselectButton),addEvent(o,"selectButton",onNavigationBindingsSelectButton),setOptions(StockToolsDefaults))}function onChartAfterGetContainer(){this.setStockTools()}function onChartBeforeRedraw(){this.stockTools&&(this.stockTools.redraw(),setOffset(this))}function setOffset(o){if(o.stockTools?.guiEnabled){var s,e=o.options.chart,i=o.stockTools.listWrapper,i=i&&(i.startWidth+getStyle(i,"padding-left")+getStyle(i,"padding-right")||i.offsetWidth);let t=!1;(o.stockTools.width=i)<o.plotWidth?(s=(e=pick(e.spacingLeft,e.spacing&&e.spacing[3],0)+i)-o.spacingBox.x,o.spacingBox.x=e,o.spacingBox.width-=s,t=!0):0===i&&(t=!0),i!==o.stockTools.prevOffsetWidth&&(o.stockTools.prevOffsetWidth=i,t&&(o.isDirtyLegend=!0))}}function onChartDestroy(){this.stockTools&&this.stockTools.destroy()}function onChartGetMargins(){var t=this.stockTools?.visible&&this.stockTools.guiEnabled?this.stockTools.width:0;t&&t<this.plotWidth&&(this.plotLeft+=t,this.spacing[3]+=t)}function onChartRender(){const t=this.stockTools,o=t&&t.toolbar&&t.toolbar.querySelector(".highcharts-current-price-indicator");t&&this.navigationBindings&&this.options.series&&o&&(this.navigationBindings.utils?.isPriceIndicatorEnabled?.(this.series)?o.firstChild.style["background-image"]='url("'+t.getIconsURL()+'current-price-hide.svg")':o.firstChild.style["background-image"]='url("'+t.getIconsURL()+'current-price-show.svg")')}function onNavigationBindingsDeselectButton(o){var t=this.chart.stockTools;if(t&&t.guiEnabled){let t=o.button;(t=0<=t.parentNode.className.indexOf("highcharts-submenu-wrapper")?t.parentNode.parentNode:t).classList.remove("highcharts-active")}}function onNavigationBindingsSelectButton(o){const s=this.chart.stockTools;if(s&&s.guiEnabled){let t=o.button;s.unselectAllButtons(o.button),0<=t.parentNode.className.indexOf("highcharts-submenu-wrapper")&&(t=t.parentNode.parentNode),s.toggleButtonActiveClass(t)}}const StockToolsGui={compose:compose};export default StockToolsGui;
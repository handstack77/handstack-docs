"use strict";import DataConverter from"./DataConverter.js";import U from"../../Core/Utilities.js";const{merge,uniqueKey}=U;class GoogleSheetsConverter extends DataConverter{constructor(e){e=merge(GoogleSheetsConverter.defaultOptions,e);super(e),this.columns=[],this.header=[],this.options=e}parse(e,t){const o=this,r=merge(o.options,e);let n=(r.json?.values||[]).map(e=>e.slice());if(0===n.length)return!1;o.header=[],o.columns=[],o.emit({type:"parse",columns:o.columns,detail:t,headers:o.header});const{beforeParse:s,json:a}=r;s&&a&&(n=s(a.values));let l;for(let s=0,e=(o.columns=n).length;s<e;s++){l=n[s],o.header[s]=r.firstRowAsNames?""+l.shift():uniqueKey();for(let t=0,e=l.length;t<e;++t)if(l[t]&&"string"==typeof l[t]){let e=o.asGuessedType(l[t]);e instanceof Date&&(e=e.getTime()),o.columns[s][t]=e}}o.emit({type:"afterParse",columns:o.columns,detail:t,headers:o.header})}getTable(){return DataConverter.getTableFromColumns(this.columns,this.header)}}GoogleSheetsConverter.defaultOptions={...DataConverter.defaultOptions};export default GoogleSheetsConverter;
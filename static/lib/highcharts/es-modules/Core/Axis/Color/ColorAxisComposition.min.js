"use strict";import Color from"../../Color/Color.js";const color=Color["parse"];import U from"../../Utilities.js";const{addEvent,extend,merge,pick,splat}=U;var ColorAxisComposition;!function(o){let a;function d(){const o=this["userOptions"];this.colorAxis=[],o.colorAxis&&(o.colorAxis=splat(o.colorAxis),o.colorAxis.map(o=>new a(this,o)))}function p(t){const o=this.chart.colorAxis||[],e=o=>{o=t.allItems.indexOf(o);-1!==o&&(this.destroyItem(t.allItems[o]),t.allItems.splice(o,1))};let i=[],s,l;for(o.forEach(function(o){(s=o.options)&&s.showInLegend&&(s.dataClasses&&s.visible?i=i.concat(o.getDataClassLegendSymbols()):s.visible&&i.push(o),o.series.forEach(function(o){o.options.showInLegend&&!s.dataClasses||("point"===o.options.legendType?o.points.forEach(function(o){e(o)}):e(o))}))}),l=i.length;l--;)t.allItems.unshift(i[l])}function h(o){o.visible&&o.item.legendColor&&o.item.legendItem.symbol.attr({fill:o.item.legendColor})}function f(t){this.chart.colorAxis?.forEach(o=>{o.update({},t.redraw)})}function x(){(this.chart.colorAxis&&this.chart.colorAxis.length||this.colorAttribs)&&this.translateColors()}function u(){const o=this.axisTypes;o?-1===o.indexOf("colorAxis")&&o.push("colorAxis"):this.axisTypes=["colorAxis"]}function m(o){const t=this,e=o?"show":"hide";t.visible=t.options.visible=Boolean(o),["graphic","dataLabel"].forEach(function(o){t[o]&&t[o][e]()}),this.series.buildKDTree()}function A(){const e=this,o=this.getPointsCollection(),i=this.options.nullColor,s=this.colorAxis,l=this.colorKey;o.forEach(o=>{var t=o.getNestedProperty(l),t=o.options.color||(o.isNull||null===o.value?i:s&&void 0!==t?s.toColor(t,o):o.color||e.color);t&&o.color!==t&&(o.color=t,"point"===e.options.legendType&&o.legendItem&&o.legendItem.label&&e.chart.legend.colorizeItem(o,o.visible))})}function C(){this.elem.attr("fill",color(this.start).tweenTo(color(this.end),this.pos),void 0,!0)}function g(){this.elem.attr("stroke",color(this.start).tweenTo(color(this.end),this.pos),void 0,!0)}o.compose=function(o,t,e,i,s){const l=t.prototype,r=e.prototype,n=s.prototype;if(!l.collectionsWithUpdate.includes("colorAxis")){a=o,l.collectionsWithUpdate.push("colorAxis"),l.collectionsWithInit.colorAxis=[l.addColorAxis],addEvent(t,"afterGetAxes",d);{e=t;const c=e.prototype.createAxis;e.prototype.createAxis=function(o,t){var e=this;if("colorAxis"!==o)return c.apply(e,arguments);o=new a(e,merge(t.axis,{index:e[o].length,isX:!1}));return e.isDirtyLegend=!0,e.axes.forEach(o=>{o.series=[]}),e.series.forEach(o=>{o.bindAxes(),o.isDirtyData=!0}),pick(t.redraw,!0)&&e.redraw(t.animation),o}}r.fillSetter=C,r.strokeSetter=g,addEvent(i,"afterGetAllItems",p),addEvent(i,"afterColorizeItem",h),addEvent(i,"afterUpdate",f),extend(n,{optionalAxis:"colorAxis",translateColors:A}),extend(n.pointClass.prototype,{setVisible:m}),addEvent(s,"afterTranslate",x,{order:1}),addEvent(s,"bindAxes",u)}},o.pointSetVisible=m}(ColorAxisComposition=ColorAxisComposition||{});export default ColorAxisComposition;
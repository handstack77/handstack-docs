"use strict";import A from"../Animation/AnimationUtilities.js";const animObject=A["animObject"];import AxisDefaults from"./AxisDefaults.js";const{xAxis,yAxis}=AxisDefaults;import Color from"../Color/Color.js";import D from"../Defaults.js";const defaultOptions=D["defaultOptions"];import F from"../Foundation.js";const registerEventOptions=F["registerEventOptions"];import H from"../Globals.js";const deg2rad=H["deg2rad"];import Tick from"./Tick.js";import U from"../Utilities.js";const{arrayMax,arrayMin,clamp,correctFloat,defined,destroyObjectProperties,erase,error,extend,fireEvent,getClosestDistance,insertItem,isArray,isNumber,isString,merge,normalizeTickInterval,objectEach,pick,relativeLength,removeEvent,splat,syncTimeout}=U,getNormalizedTickInterval=(i,t)=>normalizeTickInterval(t,void 0,void 0,pick(i.options.allowDecimals,t<.5||void 0!==i.tickAmount),!!i.tickAmount);extend(defaultOptions,{xAxis:xAxis,yAxis:merge(xAxis,yAxis)});class Axis{constructor(i,t,e){this.init(i,t,e)}init(i,t,e=this.coll){var s="xAxis"===e,a=this,n=a.isZAxis||(i.inverted?!s:s),e=(a.chart=i,a.horiz=n,a.isXAxis=s,a.coll=e,fireEvent(this,"init",{userOptions:t}),a.opposite=pick(t.opposite,a.opposite),a.side=pick(t.side,a.side,n?a.opposite?0:2:a.opposite?1:3),a.setOptions(t),a.options),n=e.labels,t=(a.type??(a.type=e.type||"linear"),a.uniqueNames??(a.uniqueNames=e.uniqueNames??!0),fireEvent(a,"afterSetType"),a.userOptions=t,a.minPixelPadding=0,a.reversed=pick(e.reversed,a.reversed),a.visible=e.visible,a.zoomEnabled=e.zoomEnabled,a.hasNames="category"===this.type||!0===e.categories,a.categories=isArray(e.categories)&&e.categories||(a.hasNames?[]:void 0),a.names||(a.names=[],a.names.keys={}),a.plotLinesAndBandsGroups={},a.positiveValuesOnly=!!a.logarithmic,a.isLinked=defined(e.linkedTo),a.ticks={},a.labelEdge=[],a.minorTicks={},a.plotLinesAndBands=[],a.alternateBands={},a.len??(a.len=0),a.minRange=a.userMinRange=e.minRange||e.maxZoom,a.range=e.range,a.offset=e.offset||0,a.max=void 0,a.min=void 0,pick(e.crosshair,splat(i.options.tooltip.crosshairs)[s?0:1]));a.crosshair=!0===t?{}:t,-1===i.axes.indexOf(a)&&(s?i.axes.splice(i.xAxis.length,0,a):i.axes.push(a),insertItem(this,i[this.coll])),i.orderItems(a.coll),a.series=a.series||[],i.inverted&&!a.isZAxis&&s&&!defined(a.reversed)&&(a.reversed=!0),a.labelRotation=isNumber(n.rotation)?n.rotation:void 0,registerEventOptions(a,e),fireEvent(this,"afterInit")}setOptions(i){var t=this.horiz?{labels:{autoRotation:[-45],padding:4},margin:15}:{labels:{padding:1},title:{rotation:90*this.side}};this.options=merge(t,defaultOptions[this.coll],i),fireEvent(this,"afterSetOptions",{userOptions:i})}defaultLabelFormatter(){const i=this.axis,t=this.chart,e=t["numberFormatter"],s=isNumber(this.value)?this.value:NaN,a=i.chart.time,n=i.categories,r=this.dateTimeLabelFormat,o=defaultOptions.lang,h=o.numericSymbols,l=o.numericSymbolMagnitude||1e3,c=i.logarithmic?Math.abs(s):i.tickInterval;let d=h&&h.length,m,g;if(n)g=""+this.value;else if(r)g=a.dateFormat(r,s);else if(d&&h&&1e3<=c)for(;d--&&void 0===g;)(m=Math.pow(l,d+1))<=c&&10*s%m==0&&null!==h[d]&&0!==s&&(g=e(s/m,-1)+h[d]);return g=void 0===g?1e4<=Math.abs(s)?e(s,-1):e(s,-1,void 0,""):g}getSeriesExtremes(){const r=this;let o;fireEvent(this,"getSeriesExtremes",null,function(){r.hasVisibleSeries=!1,r.dataMin=r.dataMax=r.threshold=void 0,r.softThreshold=!r.isXAxis,r.series.forEach(a=>{if(a.reserveSpace()){var n=a.options;let i,t=n.threshold,e,s;r.hasVisibleSeries=!0,r.positiveValuesOnly&&(t||0)<=0&&(t=void 0),r.isXAxis?(i=a.xData)&&i.length&&(i=r.logarithmic?i.filter(i=>0<i):i,o=a.getXExtremes(i),e=o.min,s=o.max,isNumber(e)||e instanceof Date||(i=i.filter(isNumber),o=a.getXExtremes(i),e=o.min,s=o.max),i.length&&(r.dataMin=Math.min(pick(r.dataMin,e),e),r.dataMax=Math.max(pick(r.dataMax,s),s))):(a=a.applyExtremes(),isNumber(a.dataMin)&&(e=a.dataMin,r.dataMin=Math.min(pick(r.dataMin,e),e)),isNumber(a.dataMax)&&(s=a.dataMax,r.dataMax=Math.max(pick(r.dataMax,s),s)),defined(t)&&(r.threshold=t),n.softThreshold&&!r.positiveValuesOnly||(r.softThreshold=!1))}})}),fireEvent(this,"afterGetSeriesExtremes")}translate(i,t,e,s,a,n){const r=this.linkedParent||this,o=(s&&r.old?r.old:r).min;if(!isNumber(o))return NaN;var h=r.minPixelPadding,a=(r.isOrdinal||r.brokenAxis?.hasBreaks||r.logarithmic&&a)&&r.lin2val;let l=1,c=0,d=(s&&r.old?r.old:r).transA,m=0;return d=d||r.transA,e&&(l*=-1,c=r.len),r.reversed&&(l*=-1,c-=l*(r.sector||r.len)),t?(i=i*l+c,i-=h,m=i/d+o,a&&(m=r.lin2val(m))):(a&&(i=r.val2lin(i)),s=l*(i-o)*d,m=s+c+l*h+(isNumber(n)?d*n:0),r.isRadial||(m=correctFloat(m))),m}toPixels(i,t){return this.translate(i,!1,!this.horiz,void 0,!0)+(t?0:this.pos)}toValue(i,t){return this.translate(i-(t?0:this.pos),!0,!this.horiz,void 0,!0)}getPlotLinePath(i){const t=this,e=t.chart,s=t.left,a=t.top,n=i.old,r=i.value,o=i.lineWidth,h=n&&e.oldChartHeight||e.chartHeight,l=n&&e.oldChartWidth||e.chartWidth,c=t.transB;let d=i.translatedValue,m=i.force,g,x,f,p,u;function k(i,t,e){return"pass"!==m&&(i<t||e<i)&&(m?i=clamp(i,t,e):u=!0),i}i={value:r,lineWidth:o,old:n,force:m,acrossPanes:i.acrossPanes,translatedValue:d};return fireEvent(this,"getPlotLinePath",i,function(i){d=pick(d,t.translate(r,void 0,void 0,n)),d=clamp(d,-1e9,1e9),g=f=d+c,x=p=h-d-c,isNumber(d)?t.horiz?(x=a,p=h-t.bottom+(!t.options.isInternal&&e.scrollablePixelsY||0),g=f=k(g,s,s+t.width)):(g=s,f=l-t.right+(e.scrollablePixelsX||0),x=p=k(x,a,a+t.height)):(u=!0,m=!1),i.path=u&&!m?void 0:e.renderer.crispLine([["M",g,x],["L",f,p]],o||1)}),i.path}getLinearTickPositions(i,t,e){const s=correctFloat(Math.floor(t/i)*i),a=correctFloat(Math.ceil(e/i)*i),n=[];let r,o,h;if(correctFloat(s+i)===s&&(h=20),this.single)return[t];for(r=s;r<=a&&(n.push(r),(r=correctFloat(r+i,h))!==o);)o=r;return n}getMinorTickInterval(){var{minorTicks:i,minorTickInterval:t}=this.options;return!0===i?pick(t,"auto"):!1!==i?t:void 0}getMinorTickPositions(){const i=this,t=i.options,e=i.tickPositions,s=i.minorTickInterval,a=i.pointRangePadding||0,n=(i.min||0)-a,r=(i.max||0)+a,o=r-n;let h=[],l;if(o&&o/s<i.len/3){const c=i.logarithmic;if(c)this.paddedTicks.forEach(function(i,t,e){t&&h.push.apply(h,c.getLogTickPositions(s,e[t-1],e[t],!0))});else if(i.dateTime&&"auto"===this.getMinorTickInterval())h=h.concat(i.getTimeTicks(i.dateTime.normalizeTimeTickInterval(s),n,r,t.startOfWeek));else for(l=n+(e[0]-n)%s;l<=r&&l!==h[0];l+=s)h.push(l)}return 0!==h.length&&i.trimTicks(h),h}adjustForMinRange(){const i=this,t=i.options,e=i.logarithmic;let{max:s,min:a,minRange:n}=i,r,o,h,l,c;i.isXAxis&&void 0===n&&!e&&(n=defined(t.min)||defined(t.max)||defined(t.floor)||defined(t.ceiling)?null:(h=getClosestDistance(i.series.map(i=>(i.xIncrement?i.xData?.slice(0,2):i.xData)||[]))||0,Math.min(5*h,i.dataMax-i.dataMin))),isNumber(s)&&isNumber(a)&&isNumber(n)&&s-a<n&&(o=i.dataMax-i.dataMin>=n,r=(n-s+a)/2,l=[a-r,pick(t.min,a-r)],o&&(l[2]=e?e.log2lin(i.dataMin):i.dataMin),a=arrayMax(l),c=[a+n,pick(t.max,a+n)],o&&(c[2]=e?e.log2lin(i.dataMax):i.dataMax),(s=arrayMin(c))-a<n&&(l[0]=s-n,l[1]=pick(t.min,s-n),a=arrayMax(l))),i.minRange=n,i.min=a,i.max=s}getClosest(){let i,e;if(this.categories)e=1;else{const s=[];this.series.forEach(function(i){var t=i.closestPointRange;1===i.xData?.length?s.push(i.xData[0]):!i.noSharedTooltip&&defined(t)&&i.reserveSpace()&&(e=defined(e)?Math.min(e,t):t)}),s.length&&(s.sort((i,t)=>i-t),i=getClosestDistance([s]))}return i&&e?Math.min(i,e):i||e}nameToX(i){const t=isArray(this.options.categories),e=t?this.categories:this.names;let s=i.options.x,a;return i.series.requireSorting=!1,-1===(s=defined(s)?s:this.uniqueNames&&e?t?e.indexOf(i.name):pick(e.keys[i.name],-1):i.series.autoIncrement())?!t&&e&&(a=e.length):a=s,void 0!==a?(this.names[a]=i.name,this.names.keys[i.name]=a):i.x&&(a=i.x),a}updateNames(){const a=this,t=this.names,i=t.length;0<i&&(Object.keys(t.keys).forEach(function(i){delete t.keys[i]}),t.length=0,this.minRange=this.userMinRange,(this.series||[]).forEach(s=>{s.xIncrement=null,s.points&&!s.isDirtyData||(a.max=Math.max(a.max,s.xData.length-1),s.processData(),s.generatePoints()),s.data.forEach(function(i,t){var e;i?.options&&void 0!==i.name&&void 0!==(e=a.nameToX(i))&&e!==i.x&&(i.x=e,s.xData[t]=e)})}))}setAxisTranslation(){const s=this,i=s.max-s.min,t=s.linkedParent,a=!!s.categories,n=s.isXAxis;let r=s.axisPointRange||0,o,h=0,l=0,e,c=void s.transA;(n||a||r)&&(o=s.getClosest(),t?(h=t.minPointOffset,l=t.pointRangePadding):s.series.forEach(function(i){var t=a?1:n?pick(i.options.pointRange,o,0):s.axisPointRange||0,e=i.options.pointPlacement;r=Math.max(r,t),s.single&&!a||(i=i.is("xrange")?!n:n,h=Math.max(h,i&&isString(e)?0:t/2),l=Math.max(l,i&&"on"===e?0:t))}),e=s.ordinal&&s.ordinal.slope&&o?s.ordinal.slope/o:1,s.minPointOffset=h*=e,s.pointRangePadding=l*=e,s.pointRange=Math.min(r,s.single&&a?1:i),n&&o&&(s.closestPointRange=o)),s.translationSlope=s.transA=c=s.staticScale||s.len/(i+l||1),s.transB=s.horiz?s.left:s.bottom,s.minPixelPadding=c*h,fireEvent(this,"afterSetAxisTranslation")}minFromRange(){var{max:i,min:t}=this;return isNumber(i)&&isNumber(t)&&i-t||void 0}setTickInterval(i){const t=this,{categories:e,chart:s,dataMax:a,dataMin:n,dateTime:r,isXAxis:o,logarithmic:h,options:l,softThreshold:c}=t,d=isNumber(t.threshold)?t.threshold:void 0,m=t.minRange||0,{ceiling:g,floor:x,linkedTo:f,softMax:p,softMin:u}=l,k=isNumber(f)&&s[t.coll]?.[f],v=l.tickPixelInterval;let b=l.maxPadding,M=l.minPadding,T=0,A,P=isNumber(l.tickInterval)&&0<=l.tickInterval?l.tickInterval:void 0,y,E,L,N;if(r||e||k||this.getTickAmount(),L=pick(t.userMin,l.min),N=pick(t.userMax,l.max),k?(A=(t.linkedParent=k).getExtremes(),t.min=pick(A.min,A.dataMin),t.max=pick(A.max,A.dataMax),this.type!==k.type&&error(11,!0,s)):(c&&defined(d)&&isNumber(a)&&isNumber(n)&&(d<=n?(y=d,M=0):a<=d&&(E=d,b=0)),t.min=pick(L,y,n),t.max=pick(N,E,a)),isNumber(t.max)&&isNumber(t.min)&&(h&&(t.positiveValuesOnly&&!i&&Math.min(t.min,pick(n,t.min))<=0&&error(10,!0,s),t.min=correctFloat(h.log2lin(t.min),16),t.max=correctFloat(h.log2lin(t.max),16)),t.range&&isNumber(n)&&(t.userMin=t.min=L=Math.max(n,t.minFromRange()||0),t.userMax=N=t.max,t.range=void 0)),fireEvent(t,"foundExtremes"),t.adjustForMinRange(),isNumber(t.min)&&isNumber(t.max)&&(!isNumber(t.userMin)&&isNumber(u)&&u<t.min&&(t.min=L=u),!isNumber(t.userMax)&&isNumber(p)&&p>t.max&&(t.max=N=p),e||t.axisPointRange||t.stacking?.usePercentage||k||(T=t.max-t.min)&&(!defined(L)&&M&&(t.min-=T*M),!defined(N)&&b&&(t.max+=T*b)),!isNumber(t.userMin)&&isNumber(x)&&(t.min=Math.max(t.min,x)),!isNumber(t.userMax)&&isNumber(g)&&(t.max=Math.min(t.max,g)),c&&isNumber(n)&&isNumber(a)&&(O=d||0,!defined(L)&&t.min<O&&O<=n?t.min=l.minRange?Math.min(O,t.max-m):O:!defined(N)&&t.max>O&&a<=O&&(t.max=l.minRange?Math.max(O,t.min+m):O)),!s.polar&&t.min>t.max&&(defined(l.min)?t.max=t.min:defined(l.max)&&(t.min=t.max)),T=t.max-t.min),t.min!==t.max&&isNumber(t.min)&&isNumber(t.max)?k&&!P&&v===k.options.tickPixelInterval?t.tickInterval=P=k.tickInterval:t.tickInterval=pick(P,this.tickAmount?T/Math.max(this.tickAmount-1,1):void 0,e?1:T*v/Math.max(t.len,v)):t.tickInterval=1,o&&!i){const I=t.min!==t.old?.min||t.max!==t.old?.max;t.series.forEach(function(i){i.forceCrop=i.forceCropping?.(),i.processData(I)}),fireEvent(this,"postProcessData",{hasExtremesChanged:I})}t.setAxisTranslation(),fireEvent(this,"initialAxisTranslation"),t.pointRange&&!P&&(t.tickInterval=Math.max(t.pointRange,t.tickInterval));var O=pick(l.minTickInterval,r&&!t.series.some(i=>i.noSharedTooltip)?t.closestPointRange:0);!P&&t.tickInterval<O&&(t.tickInterval=O),r||h||P||(t.tickInterval=getNormalizedTickInterval(t,t.tickInterval)),this.tickAmount||(t.tickInterval=t.unsquish()),this.setTickPositions()}setTickPositions(){const i=this,t=this.options,e=t.tickPositions,s=t.tickPositioner,a=this.getMinorTickInterval(),n=!this.isPanning,r=n&&t.startOnTick,o=n&&t.endOnTick;let h=[],l;if(this.tickmarkOffset=this.categories&&"between"===t.tickmarkPlacement&&1===this.tickInterval?.5:0,this.single=this.min===this.max&&defined(this.min)&&!this.tickAmount&&(this.min%1==0||!1!==t.allowDecimals),e)h=e.slice();else if(isNumber(this.min)&&isNumber(this.max)){if(!i.ordinal?.positions&&(this.max-this.min)/this.tickInterval>Math.max(2*this.len,200))h=[this.min,this.max],error(19,!1,this.chart);else if(i.dateTime)h=i.getTimeTicks(i.dateTime.normalizeTimeTickInterval(this.tickInterval,t.units),this.min,this.max,t.startOfWeek,i.ordinal?.positions,this.closestPointRange,!0);else if(i.logarithmic)h=i.logarithmic.getLogTickPositions(this.tickInterval,this.min,this.max);else{var c=this.tickInterval;let i=c;for(;i<=2*c&&(h=this.getLinearTickPositions(this.tickInterval,this.min,this.max),this.tickAmount&&h.length>this.tickAmount);)this.tickInterval=getNormalizedTickInterval(this,i*=1.1)}h.length>this.len&&(h=[h[0],h[h.length-1]])[0]===h[1]&&(h.length=1),s&&(this.tickPositions=h,(l=s.apply(i,[this.min,this.max]))&&(h=l))}this.tickPositions=h,this.minorTickInterval="auto"===a&&this.tickInterval?this.tickInterval/t.minorTicksPerMajor:a,this.paddedTicks=h.slice(0),this.trimTicks(h,r,o),!this.isLinked&&isNumber(this.min)&&isNumber(this.max)&&(this.single&&h.length<2&&!this.categories&&!this.series.some(i=>i.is("heatmap")&&"between"===i.options.pointPlacement)&&(this.min-=.5,this.max+=.5),e||l||this.adjustTickAmount()),fireEvent(this,"afterSetTickPositions")}trimTicks(i,t,e){var s=i[0],a=i[i.length-1],n=!this.isOrdinal&&this.minPointOffset||0;if(fireEvent(this,"trimTicks"),!this.isLinked){if(t&&s!==-1/0)this.min=s;else for(;this.min-n>i[0];)i.shift();if(e)this.max=a;else for(;this.max+n<i[i.length-1];)i.pop();0===i.length&&defined(s)&&!this.options.tickPositions&&i.push((a+s)/2)}}alignToOthers(){const e=this,i=e.chart,s=[this],t=e.options,a=i.options.chart,n="yAxis"===this.coll&&a.alignThresholds,r=[];let o;if(e.thresholdAlignment=void 0,(!1!==a.alignTicks&&t.alignTicks||n)&&!1!==t.startOnTick&&!1!==t.endOnTick&&!e.logarithmic){const h=i=>{const{horiz:t,options:e}=i;return[t?e.left:e.top,e.width,e.height,e.pane].join(",")},l=h(this);i[this.coll].forEach(function(i){const t=i["series"];t.length&&t.some(i=>i.visible)&&i!==e&&h(i)===l&&(o=!0,s.push(i))})}if(o&&n){s.forEach(i=>{i=i.getThresholdAlignment(e);isNumber(i)&&r.push(i)});const c=1<r.length?r.reduce((i,t)=>i+=t,0)/r.length:void 0;s.forEach(i=>{i.thresholdAlignment=c})}return o}getThresholdAlignment(i){if((!isNumber(this.dataMin)||this!==i&&this.series.some(i=>i.isDirty||i.isDirtyData))&&this.getSeriesExtremes(),isNumber(this.threshold)){let i=clamp((this.threshold-(this.dataMin||0))/((this.dataMax||0)-(this.dataMin||0)),0,1);return i=this.options.reversed?1-i:i}}getTickAmount(){var i=this.options,t=i.tickPixelInterval;let e=i.tickAmount;(e=!(e=!defined(i.tickInterval)&&!e&&this.len<t&&!this.isRadial&&!this.logarithmic&&i.startOnTick&&i.endOnTick?2:e)&&this.alignToOthers()?Math.ceil(this.len/t)+1:e)<4&&(this.finalTickAmt=e,e=5),this.tickAmount=e}adjustTickAmount(){const i=this,{finalTickAmt:t,max:e,min:s,options:a,tickPositions:n,tickAmount:r,thresholdAlignment:o}=i,h=n?.length,l=pick(i.threshold,i.softThreshold?0:null);let c,d,m=i.tickInterval,g;var x=()=>n.push(correctFloat(n[n.length-1]+m)),f=()=>n.unshift(correctFloat(n[0]-m));if(isNumber(o)&&(g=o<.5?Math.ceil(o*(r-1)):Math.floor(o*(r-1)),a.reversed&&(g=r-1-g)),i.hasData()&&isNumber(s)&&isNumber(e)){var p=()=>{i.transA*=(h-1)/(r-1),i.min=a.startOnTick?n[0]:Math.min(s,n[0]),i.max=a.endOnTick?n[n.length-1]:Math.max(e,n[n.length-1])};if(isNumber(g)&&isNumber(i.threshold)){for(;n[g]!==l||n.length!==r||n[0]>s||n[n.length-1]<e;){for(n.length=0,n.push(i.threshold);n.length<r;)(void 0===n[g]||n[g]>i.threshold?f:x)();if(m>8*i.tickInterval)break;m*=2}p()}else if(h<r){for(;n.length<r;)(n.length%2||s===l?x:f)();p()}if(defined(t)){for(d=c=n.length;d--;)(3===t&&d%2==1||t<=2&&0<d&&d<c-1)&&n.splice(d,1);i.finalTickAmt=void 0}}}setScale(){const i=this,{coll:t,stacking:e}=i;let s=!1,a=!1;i.series.forEach(i=>{s=s||i.isDirtyData||i.isDirty,a=a||i.xAxis&&i.xAxis.isDirty||!1}),i.setAxisSize();var n=i.len!==(i.old&&i.old.len);n||s||a||i.isLinked||i.forceRedraw||i.userMin!==(i.old&&i.old.userMin)||i.userMax!==(i.old&&i.old.userMax)||i.alignToOthers()?(e&&"yAxis"===t&&e.buildStacks(),i.forceRedraw=!1,i.userMinRange||(i.minRange=void 0),i.getSeriesExtremes(),i.setTickInterval(),e&&"xAxis"===t&&e.buildStacks(),i.isDirty||(i.isDirty=n||i.min!==i.old?.min||i.max!==i.old?.max)):e&&e.cleanStacks(),s&&delete i.allExtremes,fireEvent(this,"afterSetScale")}setExtremes(i,t,e=!0,s,a){this.series.forEach(i=>{delete i.kdTree}),a=extend(a,{min:i,max:t}),fireEvent(this,"setExtremes",a,i=>{this.userMin=i.min,this.userMax=i.max,this.eventArgs=i,e&&this.chart.redraw(s)})}setAxisSize(){var i=this.chart,t=this.options,e=t.offsets||[0,0,0,0],s=this.horiz,a=this.width=Math.round(relativeLength(pick(t.width,i.plotWidth-e[3]+e[1]),i.plotWidth)),n=this.height=Math.round(relativeLength(pick(t.height,i.plotHeight-e[0]+e[2]),i.plotHeight)),r=this.top=Math.round(relativeLength(pick(t.top,i.plotTop+e[0]),i.plotHeight,i.plotTop)),t=this.left=Math.round(relativeLength(pick(t.left,i.plotLeft+e[3]),i.plotWidth,i.plotLeft));this.bottom=i.chartHeight-n-r,this.right=i.chartWidth-a-t,this.len=Math.max(s?a:n,0),this.pos=s?t:r}getExtremes(){const i=this,t=i.logarithmic;return{min:t?correctFloat(t.lin2log(i.min)):i.min,max:t?correctFloat(t.lin2log(i.max)):i.max,dataMin:i.dataMin,dataMax:i.dataMax,userMin:i.userMin,userMax:i.userMax}}getThreshold(i){const t=this,e=t.logarithmic,s=e?e.lin2log(t.min):t.min,a=e?e.lin2log(t.max):t.max;return null===i||i===-1/0?i=s:i===1/0?i=a:i<s?i=s:a<i&&(i=a),t.translate(i,0,1,0,1)}autoLabelAlign(i){const t=(pick(i,0)-90*this.side+720)%360,e={align:"center"};return fireEvent(this,"autoLabelAlign",e,function(i){15<t&&t<165?i.align="right":195<t&&t<345&&(i.align="left")}),e.align}tickSize(i){var t=this.options,e=pick(t["tick"===i?"tickWidth":"minorTickWidth"],"tick"===i&&this.isXAxis&&!this.categories?1:0);let s=t["tick"===i?"tickLength":"minorTickLength"],a;e&&s&&("inside"===t[i+"Position"]&&(s=-s),a=[s,e]);t={tickSize:a};return fireEvent(this,"afterTickSize",t),t.tickSize}labelMetrics(){var i=this.chart.renderer,t=this.ticks,t=t[Object.keys(t)[0]]||{};return this.chart.renderer.fontMetrics(t.label||t.movedLabel||i.box)}unsquish(){function i(i){let t=(i+2*e)/(n||1);return(t=1<t?Math.ceil(t):1)*a>h&&i!==1/0&&n!==1/0&&h&&(t=Math.ceil(h/a)),correctFloat(t*a)}const t=this.options.labels,e=t.padding||0,s=this.horiz,a=this.tickInterval,n=this.len/(((this.categories?1:0)+this.max-this.min)/a),r=t.rotation,o=correctFloat(.8*this.labelMetrics().h),h=Math.max(this.max-this.min,0);let l=a,c,d=Number.MAX_VALUE,m;var g,x;if(s){if(t.staggerLines||(isNumber(r)?m=[r]:n<t.autoRotationLimit&&(m=t.autoRotation)),m)for(const f of m)(f===r||f&&-90<=f&&f<=90)&&(x=(g=i(Math.abs(o/Math.sin(deg2rad*f))))+Math.abs(f/360))<d&&(d=x,c=f,l=g)}else l=i(.75*o);return this.autoRotation=m,this.labelRotation=pick(c,isNumber(r)?r:0),t.step?a:l}getSlotWidth(i){var t=this.chart,e=this.horiz,s=this.options.labels,a=Math.max(this.tickPositions.length-(this.categories?0:1),1),n=t.margin[3];if(i&&isNumber(i.slotWidth))return i.slotWidth;if(e&&s.step<2)return s.rotation?0:(this.staggerLines||1)*this.len/a;if(!e){i=s.style.width;if(void 0!==i)return parseInt(String(i),10);if(n)return n-t.spacing[3]}return.33*t.chartWidth}renderUnsquish(){const i=this.chart,t=i.renderer,e=this.tickPositions,n=this.ticks,s=this.options.labels,r=s.style,a=this.horiz,o=this.getSlotWidth(),h=Math.max(1,Math.round(o-(a?2*(s.padding||0):s.distance||0))),l={},c=this.labelMetrics(),d=r.textOverflow;let m,g,x=0,f,p,u;if(isString(s.rotation)||(l.rotation=s.rotation||0),e.forEach(function(i){const t=n[i];t.movedLabel&&t.replaceMovedLabel(),t&&t.label&&t.label.textPxLength>x&&(x=t.label.textPxLength)}),this.maxLabelLength=x,this.autoRotation)x>h&&x>c.h?l.rotation=this.labelRotation:this.labelRotation=0;else if(o&&(m=h,!d))for(g="clip",p=e.length;!a&&p--;)u=e[p],(f=n[u].label)&&("ellipsis"===f.styles.textOverflow?f.css({textOverflow:"clip"}):f.textPxLength>o&&f.css({width:o+"px"}),f.getBBox().height>this.len/e.length-(c.h-c.f)&&(f.specificTextOverflow="ellipsis"));l.rotation&&(m=x>.5*i.chartHeight?.33*i.chartHeight:x,d||(g="ellipsis")),this.labelAlign=s.align||this.autoLabelAlign(this.labelRotation),this.labelAlign&&(l.align=this.labelAlign),e.forEach(function(i){const t=n[i],e=t&&t.label,s=r.width,a={};e&&(e.attr(l),t.shortenLabel?t.shortenLabel():m&&!s&&"nowrap"!==r.whiteSpace&&(m<e.textPxLength||"SPAN"===e.element.tagName)?(a.width=m+"px",d||(a.textOverflow=e.specificTextOverflow||g),e.css(a)):!e.styles.width||a.width||s||e.css({width:null}),delete e.specificTextOverflow,t.rotation=l.rotation)},this),this.tickRotCorr=t.rotCorr(c.b,this.labelRotation||0,0!==this.side)}hasData(){return this.series.some(function(i){return i.hasData()})||this.options.showEmpty&&defined(this.min)&&defined(this.max)}addTitle(i){const t=this,e=t.chart.renderer,s=t.horiz,a=t.opposite,n=t.options,r=n.title,o=t.chart.styledMode;let h;t.axisTitle||(h=(h=r.textAlign)||(s?{low:"left",middle:"center",high:"right"}:{low:a?"right":"left",middle:"center",high:a?"left":"right"})[r.align],t.axisTitle=e.text(r.text||"",0,0,r.useHTML).attr({zIndex:7,rotation:r.rotation||0,align:h}).addClass("highcharts-axis-title"),o||t.axisTitle.css(merge(r.style)),t.axisTitle.add(t.axisGroup),t.axisTitle.isNew=!0),o||r.style.width||t.isRadial||t.axisTitle.css({width:t.len+"px"}),t.axisTitle[i?"show":"hide"](i)}generateTick(i){const t=this.ticks;t[i]?t[i].addLabel():t[i]=new Tick(this,i)}createGroups(){const{axisParent:s,chart:i,coll:a,options:n}=this,r=i.renderer;var t=(i,t,e)=>r.g(i).attr({zIndex:e}).addClass(`highcharts-${a.toLowerCase()}${t} `+(this.isRadial?`highcharts-radial-axis${t} `:"")+(n.className||"")).add(s);this.axisGroup||(this.gridGroup=t("grid","-grid",n.gridZIndex),this.axisGroup=t("axis","",n.zIndex),this.labelGroup=t("axis-labels","-labels",n.labels.zIndex))}getOffset(){const t=this,{chart:i,horiz:e,options:s,side:a,ticks:n,tickPositions:r,coll:o}=t,h=i.inverted&&!t.isZAxis?[1,0,3,2][a]:a,l=t.hasData(),c=s.title,d=s.labels,m=isNumber(s.crossing),g=i.axisOffset,x=i.clipOffset,f=[-1,1,1,-1][a];let p,u=0,k,v=0,b=0,M,T;var A;t.showAxis=p=l||s.showEmpty,t.staggerLines=t.horiz&&d.staggerLines||void 0,t.createGroups(),l||t.isLinked?(r.forEach(function(i){t.generateTick(i)}),t.renderUnsquish(),t.reserveSpaceDefault=0===a||2===a||{1:"left",3:"right"}[a]===t.labelAlign,pick(d.reserveSpace,!m&&null,"center"===t.labelAlign||null,t.reserveSpaceDefault)&&r.forEach(function(i){b=Math.max(n[i].getLabelSize(),b)}),t.staggerLines&&(b*=t.staggerLines),t.labelOffset=b*(t.opposite?-1:1)):objectEach(n,function(i,t){i.destroy(),delete n[t]}),c?.text&&!1!==c.enabled&&(t.addTitle(p),p&&!m&&!1!==c.reserveSpace&&(t.titleOffset=u=t.axisTitle.getBBox()[e?"height":"width"],k=c.offset,v=defined(k)?0:pick(c.margin,e?5:10))),t.renderLine(),t.offset=f*pick(s.offset,g[a]?g[a]+(s.margin||0):0),t.tickRotCorr=t.tickRotCorr||{x:0,y:0},T=0===a?-t.labelMetrics().h:2===a?t.tickRotCorr.y:0,M=Math.abs(b)+v,b&&(M=(M-=T)+f*(e?pick(d.y,t.tickRotCorr.y+f*d.distance):pick(d.x,f*d.distance))),t.axisTitleMargin=pick(k,M),t.getMaxLabelDimensions&&(t.maxLabelDimensions=t.getMaxLabelDimensions(n,r)),"colorAxis"!==o&&x&&(A=this.tickSize("tick"),g[a]=Math.max(g[a],(t.axisTitleMargin||0)+u+f*t.offset,M,r&&r.length&&A?A[0]+f*t.offset:0),A=!t.axisLine||s.offset?0:t.axisLine.strokeWidth()/2,x[h]=Math.max(x[h],A)),fireEvent(this,"afterGetOffset")}getLinePath(i){const t=this.chart,e=this.opposite,s=this.offset,a=this.horiz,n=this.left+(e?this.width:0)+s,r=t.chartHeight-this.bottom-(e?this.height:0)+s;return e&&(i*=-1),t.renderer.crispLine([["M",a?this.left:n,a?r:this.top],["L",a?t.chartWidth-this.right:n,a?r:t.chartHeight-this.bottom]],i)}renderLine(){this.axisLine||(this.axisLine=this.chart.renderer.path().addClass("highcharts-axis-line").add(this.axisGroup),this.chart.styledMode||this.axisLine.attr({stroke:this.options.lineColor,"stroke-width":this.options.lineWidth,zIndex:7}))}getTitlePosition(i){var t=this.horiz,e=this.left,s=this.top,a=this.len,n=this.options.title,r=t?e:s,o=this.opposite,h=this.offset,l=n.x,c=n.y,d=this.chart.renderer.fontMetrics(i),i=i?Math.max(i.getBBox(!1,0).height-d.h-1,0):0,r={low:r+(t?0:a),middle:r+a/2,high:r+(t?a:0)}[n.align],a=(t?s+this.height:e)+(t?1:-1)*(o?-1:1)*(this.axisTitleMargin||0)+[-i,i,d.f,-i][this.side],n={x:t?r+l:a+(o?this.width:0)+h+l,y:t?a+c-(o?this.height:0)+h:r+c};return fireEvent(this,"afterGetTitlePosition",{titlePosition:n}),n}renderMinorTick(i,t){const e=this.minorTicks;e[i]||(e[i]=new Tick(this,i,"minor")),t&&e[i].isNew&&e[i].render(null,!0),e[i].render(null,!1,1)}renderTick(i,t,e){const s=this,a=s.isLinked,n=s.ticks;(!a||i>=s.min&&i<=s.max||s.grid&&s.grid.isColumn)&&(n[i]||(n[i]=new Tick(s,i)),e&&n[i].isNew&&n[i].render(t,!0,-1),n[i].render(t))}render(){const e=this,s=e.chart,a=e.logarithmic,i=s.renderer,t=e.options,n=e.isLinked,r=e.tickPositions,o=e.axisTitle,h=e.ticks,l=e.minorTicks,c=e.alternateBands,d=t.stackLabels,m=t.alternateGridColor,g=t.crossing,x=e.tickmarkOffset,f=e.axisLine,p=e.showAxis,u=animObject(i.globalAnimation);let k,v;if(e.labelEdge.length=0,e.overlap=!1,[h,l,c].forEach(function(i){objectEach(i,function(i){i.isActive=!1})}),isNumber(g)){const b=(this.isXAxis?s.yAxis:s.xAxis)[0],M=[1,-1,-1,1][this.side];if(b){let i=b.toPixels(g,!0);e.horiz&&(i=b.len-i),e.offset=M*i}}if(e.hasData()||n){const T=e.chart.hasRendered&&e.old&&isNumber(e.old.min);e.minorTickInterval&&!e.categories&&e.getMinorTickPositions().forEach(function(i){e.renderMinorTick(i,T)}),r.length&&(r.forEach(function(i,t){e.renderTick(i,t,T)}),x&&(0===e.min||e.single)&&(h[-1]||(h[-1]=new Tick(e,-1,null,!0)),h[-1].render(-1))),m&&r.forEach(function(i,t){v=void 0!==r[t+1]?r[t+1]+x:e.max-x,t%2==0&&i<e.max&&v<=e.max+(s.polar?-x:x)&&(c[i]||(c[i]=new H.PlotLineOrBand(e,{})),k=i+x,c[i].options={from:a?a.lin2log(k):k,to:a?a.lin2log(v):v,color:m,className:"highcharts-alternate-grid"},c[i].render(),c[i].isActive=!0)}),e._addedPlotLB||(e._addedPlotLB=!0,(t.plotLines||[]).concat(t.plotBands||[]).forEach(function(i){e.addPlotBandOrLine(i)}))}[h,l,c].forEach(function(t){const e=[],i=u.duration;objectEach(t,function(i,t){i.isActive||(i.render(t,!1,0),i.isActive=!1,e.push(t))}),syncTimeout(function(){let i=e.length;for(;i--;)t[e[i]]&&!t[e[i]].isActive&&(t[e[i]].destroy(),delete t[e[i]])},t!==c&&s.hasRendered&&i?i:0)}),f&&(f[f.isPlaced?"animate":"attr"]({d:this.getLinePath(f.strokeWidth())}),f.isPlaced=!0,f[p?"show":"hide"](p)),o&&p&&(o[o.isNew?"attr":"animate"](e.getTitlePosition(o)),o.isNew=!1),d&&d.enabled&&e.stacking&&e.stacking.renderStackTotals(),e.old={len:e.len,max:e.max,min:e.min,transA:e.transA,userMax:e.userMax,userMin:e.userMin},e.isDirty=!1,fireEvent(this,"afterRender")}redraw(){this.visible&&(this.render(),this.plotLinesAndBands.forEach(function(i){i.render()})),this.series.forEach(function(i){i.isDirty=!0})}getKeepProps(){return this.keepProps||Axis.keepProps}destroy(i){const e=this,t=e.plotLinesAndBands,s=this.eventOptions;if(fireEvent(this,"destroy",{keepEvents:i}),i||removeEvent(e),[e.ticks,e.minorTicks,e.alternateBands].forEach(function(i){destroyObjectProperties(i)}),t){let i=t.length;for(;i--;)t[i].destroy()}["axisLine","axisTitle","axisGroup","gridGroup","labelGroup","cross","scrollbar"].forEach(function(i){e[i]&&(e[i]=e[i].destroy())});for(const a in e.plotLinesAndBandsGroups)e.plotLinesAndBandsGroups[a]=e.plotLinesAndBandsGroups[a].destroy();objectEach(e,function(i,t){-1===e.getKeepProps().indexOf(t)&&delete e[t]}),this.eventOptions=s}drawCrosshair(i,t){const e=this.crosshair,s=pick(e&&e.snap,!0),a=this.chart;let n,r,o,h=this.cross,l;if(fireEvent(this,"drawCrosshair",{e:i,point:t}),i=i||this.cross&&this.cross.e,e&&!1!==(defined(t)||!s)){if(s?defined(t)&&(r=pick("colorAxis"!==this.coll?t.crosshairPos:null,this.isXAxis?t.plotX:this.len-t.plotY)):r=i&&(this.horiz?i.chartX-this.pos:this.len-i.chartY+this.pos),defined(r)&&(l={value:t&&(this.isXAxis?t.x:pick(t.stackY,t.y)),translatedValue:r},a.polar&&extend(l,{isCrosshair:!0,chartX:i&&i.chartX,chartY:i&&i.chartY,point:t}),n=this.getPlotLinePath(l)||null),!defined(n))return void this.hideCrosshair();o=this.categories&&!this.isRadial,h||(this.cross=h=a.renderer.path().addClass("highcharts-crosshair highcharts-crosshair-"+(o?"category ":"thin ")+(e.className||"")).attr({zIndex:pick(e.zIndex,2)}).add(),a.styledMode||(h.attr({stroke:e.color||(o?Color.parse("#ccd3ff").setOpacity(.25).get():"#cccccc"),"stroke-width":pick(e.width,1)}).css({"pointer-events":"none"}),e.dashStyle&&h.attr({dashstyle:e.dashStyle}))),h.show().attr({d:n}),o&&!e.width&&h.attr({"stroke-width":this.transA}),this.cross.e=i}else this.hideCrosshair();fireEvent(this,"afterDrawCrosshair",{e:i,point:t})}hideCrosshair(){this.cross&&this.cross.hide(),fireEvent(this,"afterHideCrosshair")}update(i,t){const e=this.chart;i=merge(this.userOptions,i),this.destroy(!0),this.init(e,i),e.isDirtyBox=!0,pick(t,!0)&&e.redraw()}remove(i){const t=this.chart,e=this.coll,s=this.series;let a=s.length;for(;a--;)s[a]&&s[a].remove(!1);erase(t.axes,this),erase(t[e]||[],this),t.orderItems(e),this.destroy(),t.isDirtyBox=!0,pick(i,!0)&&t.redraw()}setTitle(i,t){this.update({title:i},t)}setCategories(i,t){this.update({categories:i},t)}}Axis.keepProps=["coll","extKey","hcEvents","len","names","series","userMax","userMin"];export default Axis;
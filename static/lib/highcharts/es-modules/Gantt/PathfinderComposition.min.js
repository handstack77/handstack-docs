"use strict";import ConnectorsDefaults from"./ConnectorsDefaults.js";import D from"../Core/Defaults.js";const setOptions=D["setOptions"];import U from"../Core/Utilities.js";const{defined,error,merge}=U;function getPointBB(t){var n=t.shapeArgs;if(n)return{xMin:n.x||0,xMax:(n.x||0)+(n.width||0),yMin:n.y||0,yMax:(n.y||0)+(n.height||0)};n=t.graphic&&t.graphic.getBBox();return n?{xMin:t.plotX-n.width/2,xMax:t.plotX+n.width/2,yMin:t.plotY-n.height/2,yMax:t.plotY+n.height/2}:null}function warnLegacy(t){(t.options.pathfinder||t.series.reduce(function(t,n){return n.options&&merge(!0,n.options.connectors=n.options.connectors||{},n.options.pathfinder),t||n.options&&n.options.pathfinder},!1))&&(merge(!0,t.options.connectors=t.options.connectors||{},t.options.pathfinder),error('WARNING: Pathfinder options have been renamed. Use "chart.connectors" or "series.connectors" instead.'))}var ConnectionComposition;!function(){function i(t){var n=getPointBB(this);let o,e;switch(t.align){case"right":o="xMax";break;case"left":o="xMin"}switch(t.verticalAlign){case"top":e="yMin";break;case"bottom":e="yMax"}return{x:o?n[o]:(n.xMin+n.xMax)/2,y:e?n[e]:(n.yMin+n.yMax)/2}}function r(t,n){var o;return defined(n)||(o=getPointBB(this))&&(n={x:(o.xMin+o.xMax)/2,y:(o.yMin+o.yMax)/2}),Math.atan2(n.y-t.y,t.x-n.x)}function a(t,n,o){const e=2*Math.PI,i=getPointBB(this),r=i.xMax-i.xMin,a=i.yMax-i.yMin,s=Math.atan2(a,r),c=r/2,h=a/2,p=i.xMin+c,x=i.yMin+h,M={x:p,y:x};let f=t,y,u=!1,d=1,g=1;for(;f<-Math.PI;)f+=e;for(;f>Math.PI;)f-=e;return y=Math.tan(f),f>-s&&f<=s?(g=-1,u=!0):f>s&&f<=Math.PI-s?g=-1:f>Math.PI-s||f<=-(Math.PI-s)?(d=-1,u=!0):d=-1,u?(M.x+=d*c,M.y+=g*c*y):(M.x+=d*(a/(2*y)),M.y+=g*h),o.x!==p&&(M.x=o.x),o.y!==x&&(M.y=o.y),{x:M.x+n*Math.cos(f),y:M.y-n*Math.sin(f)}}(ConnectionComposition||(ConnectionComposition={})).compose=function(t,n,o){const e=o.prototype;e.getPathfinderAnchorPoint||(t.prototype.callbacks.push(function(t){!1!==t.options.connectors.enabled&&(warnLegacy(t),this.pathfinder=new n(this),this.pathfinder.update(!0))}),e.getMarkerVector=a,e.getPathfinderAnchorPoint=i,e.getRadiansToVector=r,setOptions(ConnectorsDefaults))}}();export default ConnectionComposition;
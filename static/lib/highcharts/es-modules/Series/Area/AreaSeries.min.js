"use strict";import AreaSeriesDefaults from"./AreaSeriesDefaults.js";import SeriesRegistry from"../../Core/Series/SeriesRegistry.js";const{line:LineSeries}=SeriesRegistry["seriesTypes"];import U from"../../Core/Utilities.js";const{extend,merge,objectEach,pick}=U;class AreaSeries extends LineSeries{drawGraph(){this.areaPath=[],super.drawGraph.apply(this);const{areaPath:a,options:o}=this;[this,...this.zones].forEach((t,e)=>{const s={},i=t.fillColor||o.fillColor;let r=t.area;var l=r?"animate":"attr";r?(r.endX=this.preventGraphAnimation?null:a.xMap,r.animate({d:a})):(s.zIndex=0,(r=t.area=this.chart.renderer.path(a).addClass("highcharts-area"+(e?` highcharts-zone-area-${e-1} `:" ")+(e&&t.className||"")).add(this.group)).isArea=!0),this.chart.styledMode||(s.fill=i||t.color||this.color,s["fill-opacity"]=i?1:o.fillOpacity??.75,r.css({pointerEvents:this.stickyTracking?"none":"auto"})),r[l](s),r.startX=a.xMap,r.shiftUnit=o.step?2:1})}getGraphPath(h){function s(t,e,s){var t=h[t],i=n&&d[t.x].points[u],r=t[s+"Null"]||0,t=t[s+"Cliff"]||0;let l,a,o=!0;t||r?(l=(r?i[0]:i[1])+t,a=i[0]+t,o=!!r):!n&&h[e]&&h[e].isNull&&(l=a=g),void 0!==l&&(f.push({plotX:k,plotY:null===l?S:p.getThreshold(l),isNull:o,isCliff:!0}),c.push({plotX:k,plotY:null===a?S:p.getThreshold(a),doCurve:!1}))}const t=LineSeries.prototype.getGraphPath,e=this.options,n=e.stacking,p=this.yAxis,c=[],f=[],u=this.index,d=p.stacking.stacks[this.stackKey],g=e.threshold,S=Math.round(p.getThreshold(e.threshold)),i=pick(e.connectNulls,"percent"===n);let k,r,l;h=h||this.points;for(let t=0,e=(h=n?this.getStackPoints(h):h).length;t<e;++t)n||(h[t].leftCliff=h[t].rightCliff=h[t].leftNull=h[t].rightNull=void 0),r=h[t].isNull,k=pick(h[t].rectPlotX,h[t].plotX),l=n?pick(h[t].yBottom,S):S,r&&!i||(i||s(t,t-1,"left"),r&&!n&&i||(f.push(h[t]),c.push({x:t,plotX:k,plotY:l})),i||s(t,t+1,"right"));const a=t.call(this,f,!0,!0),o=(c.reversed=!0,t.call(this,c,!0,!0));var x=o[0];x&&"M"===x[0]&&(o[0]=["L",x[1],x[2]]);const y=a.concat(o),m=(y.length&&y.push(["Z"]),t.call(this,f,!1,i));return 1<this.chart.series.length&&n&&f.some(t=>t.isCliff)&&(y.hasStackedCliffs=m.hasStackedCliffs=!0),y.xMap=a.xMap,this.areaPath=y,m}getStackPoints(e){const p=this,i=[],c=[],r=this.xAxis,l=this.yAxis,f=l.stacking.stacks[this.stackKey],u={},d=l.series,g=d.length,S=l.options.reversedStacks?1:-1,k=d.indexOf(p);if(e=e||this.points,this.options.stacking){for(let t=0;t<e.length;t++)e[t].leftNull=e[t].rightNull=void 0,u[e[t].x]=e[t];objectEach(f,function(t,e){null!==t.total&&c.push(e)}),c.sort(function(t,e){return t-e});const x=d.map(t=>t.visible);c.forEach(function(a,o){let e=0,h,n;if(u[a]&&!u[a].isNull)i.push(u[a]),[-1,1].forEach(function(t){var e=1===t?"rightNull":"leftNull",s=1===t?"rightCliff":"leftCliff",i=f[c[o+t]];let r=0;if(i){let t=k;for(;0<=t&&t<g;){var l=d[t].index;(h=i.points[l])||(l===p.index?u[a][e]=!0:x[t]&&(n=f[a].points[l])&&(r-=n[1]-n[0])),t+=S}}u[a][s]=r});else{let t=k;for(;0<=t&&t<g;){var s=d[t].index;if(h=f[a].points[s]){e=h[1];break}t+=S}e=pick(e,0),e=l.translate(e,0,1,0,1),i.push({isNull:!0,plotX:r.translate(a,0,0,0,1),x:a,plotY:e,yBottom:e})}})}return i}}AreaSeries.defaultOptions=merge(LineSeries.defaultOptions,AreaSeriesDefaults),extend(AreaSeries.prototype,{singleStacks:!1}),SeriesRegistry.registerSeriesType("area",AreaSeries);export default AreaSeries;
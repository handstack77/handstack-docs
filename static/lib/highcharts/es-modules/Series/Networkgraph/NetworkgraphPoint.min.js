"use strict";import NodesComposition from"../NodesComposition.js";import SeriesRegistry from"../../Core/Series/SeriesRegistry.js";const{prototype:seriesProto,prototype:{pointClass:Point}}=SeriesRegistry["series"];import U from"../../Core/Utilities.js";const{addEvent,css,defined,extend,pick}=U;class NetworkgraphPoint extends Point{destroy(){return this.isNode&&this.linksFrom.concat(this.linksTo).forEach(function(t){t.destroyElements&&t.destroyElements()}),this.series.layout.removeElementFromCollection(this,this.series.layout[this.isNode?"nodes":"links"]),Point.prototype.destroy.apply(this,arguments)}getDegree(){var t=this.isNode?this.linksFrom.length+this.linksTo.length:0;return 0===t?1:t}getLinkAttributes(){var t=this.series.options.link,s=this.options;return{"stroke-width":pick(s.width,t.width),stroke:s.color||t.color,dashstyle:s.dashStyle||t.dashStyle,opacity:pick(s.opacity,t.opacity,1)}}getLinkPath(){let t=this.fromNode,s=this.toNode;return t.plotX>s.plotX&&(t=this.toNode,s=this.fromNode),[["M",t.plotX||0,t.plotY||0],["L",s.plotX||0,s.plotY||0]]}getMass(){var t=this.fromNode.mass,s=this.toNode.mass,e=t+s;return{fromNode:1-t/e,toNode:1-s/e}}constructor(t,s,e){super(t,s,e),this.series.options.draggable&&!this.series.chart.styledMode&&(addEvent(this,"mouseOver",function(){css(this.series.chart.container,{cursor:"move"})}),addEvent(this,"mouseOut",function(){css(this.series.chart.container,{cursor:"default"})}))}isValid(){return!this.isNode||defined(this.id)}redrawLink(){var t,s=this.getLinkPath();let e;this.graphic&&(this.shapeArgs={d:s},this.series.chart.styledMode||(e=this.series.pointAttribs(this),this.graphic.attr(e),(this.dataLabels||[]).forEach(function(t){t&&t.attr({opacity:e.opacity})})),this.graphic.animate(this.shapeArgs),t=s[0],s=s[1],"M"===t[0]&&"L"===s[0]&&(this.plotX=(t[1]+s[1])/2,this.plotY=(t[2]+s[2])/2))}remove(t,s){const e=this,i=e.series,o=i.options.nodes||[];let r,n=o.length;if(e.isNode){for(i.points=[],[].concat(e.linksFrom).concat(e.linksTo).forEach(function(t){-1<(r=t.fromNode.linksFrom.indexOf(t))&&t.fromNode.linksFrom.splice(r,1),-1<(r=t.toNode.linksTo.indexOf(t))&&t.toNode.linksTo.splice(r,1),seriesProto.removePoint.call(i,i.data.indexOf(t),!1,!1)}),i.points=i.data.slice(),i.nodes.splice(i.nodes.indexOf(e),1);n--;)if(o[n].id===e.options.id){i.options.nodes.splice(n,1);break}e&&e.destroy(),i.isDirty=!0,i.isDirtyData=!0,t&&i.chart.redraw(t)}else i.removePoint(i.data.indexOf(e),t,s)}renderLink(){let s;this.graphic||(this.graphic=this.series.chart.renderer.path(this.getLinkPath()).addClass(this.getClassName(),!0).add(this.series.group),this.series.chart.styledMode||(s=this.series.pointAttribs(this),this.graphic.attr(s),(this.dataLabels||[]).forEach(function(t){t&&t.attr({opacity:s.opacity})})))}}extend(NetworkgraphPoint.prototype,{setState:NodesComposition.setNodeState});export default NetworkgraphPoint;
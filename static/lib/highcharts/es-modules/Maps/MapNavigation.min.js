"use strict";import D from"../Core/Defaults.js";const setOptions=D["setOptions"];import H from"../Core/Globals.js";const composed=H["composed"];import MapNavigationDefaults from"./MapNavigationDefaults.js";import MapPointer from"./MapPointer.js";import MapSymbols from"./MapSymbols.js";import U from"../Core/Utilities.js";const{addEvent,extend,merge,objectEach,pick,pushUnique}=U;function stopEvent(t){t&&(t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)}class MapNavigation{static compose(t,e,o){MapPointer.compose(e),MapSymbols.compose(o),pushUnique(composed,"Map.Navigation")&&(addEvent(t,"beforeRender",function(){this.mapNavigation=new MapNavigation(this),this.mapNavigation.update()}),setOptions(MapNavigationDefaults))}constructor(t){this.chart=t,this.navButtons=[]}update(t){function h(t){this.handler.call(c,t),stopEvent(t)}const u=this,c=u.chart,m=u.navButtons;let b=c.options.mapNavigation;for(t&&(b=c.options.mapNavigation=merge(c.options.mapNavigation,t));m.length;)m.pop().destroy();if(!c.renderer.forExport&&pick(b.enableButtons,b.enabled)){u.navButtonsGroup||(u.navButtonsGroup=c.renderer.g().attr({zIndex:7}).add()),objectEach(b.buttons,(t,e)=>{const o={padding:(t=merge(b.buttonOptions,t)).padding};!c.styledMode&&t.theme&&(extend(o,t.theme),o.style=merge(t.theme.style,t.style));var{text:n,width:i=0,height:a=0,padding:s=0}=t;const r=c.renderer.button("+"!==n&&"-"!==n&&n||"",0,0,h,o,void 0,void 0,void 0,"zoomIn"===e?"topbutton":"bottombutton").addClass("highcharts-map-navigation highcharts-"+{zoomIn:"zoom-in",zoomOut:"zoom-out"}[e]).attr({width:i,height:a,title:c.options.lang[e],zIndex:5}).add(u.navButtonsGroup);if("+"===n||"-"===n){const d=i+1,p=[["M",s+3,s+a/2],["L",s+d-3,s+a/2]];"+"===n&&p.push(["M",s+d/2,s+3],["L",s+d/2,s+a-3]),c.renderer.path(p).addClass("highcharts-button-symbol").attr(c.styledMode?{}:{stroke:t.style?.color,"stroke-width":3,"stroke-linecap":"round"}).add(r)}if(r.handler=t.onclick,addEvent(r.element,"dblclick",stopEvent),m.push(r),extend(t,{width:r.width,height:2*(r.height||0)}),c.hasLoaded)r.align(t,!1,t.alignTo);else{const l=addEvent(c,"load",()=>{r.element&&r.align(t,!1,t.alignTo),l()})}});const n=(t,e)=>!(e.x>=t.x+t.width||e.x+e.width<=t.x||e.y>=t.y+t.height||e.y+e.height<=t.y);c.hasLoaded||addEvent(c,"render",function(){var t,e,o=c.exportingGroup&&c.exportingGroup.getBBox();o&&(e=u.navButtonsGroup.getBBox(),n(o,e)&&(t=-e.y-e.height+o.y-5,o=o.y+o.height-e.y+5,e=b.buttonOptions&&b.buttonOptions.verticalAlign,u.navButtonsGroup.attr({translateY:"bottom"===e?t:o})))})}this.updateEvents(b)}updateEvents(t){const e=this.chart;pick(t.enableDoubleClickZoom,t.enabled)||t.enableDoubleClickZoomTo?this.unbindDblClick=this.unbindDblClick||addEvent(e.container,"dblclick",function(t){e.pointer.onContainerDblClick(t)}):this.unbindDblClick&&(this.unbindDblClick=this.unbindDblClick()),pick(t.enableMouseWheelZoom,t.enabled)?this.unbindMouseWheel=this.unbindMouseWheel||addEvent(e.container,"wheel",function(t){return e.pointer.inClass(t.target,"highcharts-no-mousewheel")||(e.pointer.onContainerMouseWheel(t),stopEvent(t)),!1}):this.unbindMouseWheel&&(this.unbindMouseWheel=this.unbindMouseWheel())}}export default MapNavigation;
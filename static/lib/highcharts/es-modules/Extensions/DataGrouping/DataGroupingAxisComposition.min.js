"use strict";import DataGroupingDefaults from"./DataGroupingDefaults.js";import U from"../../Core/Utilities.js";const{addEvent,extend,merge,pick}=U;let AxisConstructor;function applyGrouping(o){const i=this,t=i.series;t.forEach(function(t){t.groupPixelWidth=void 0}),t.forEach(function(t){t.groupPixelWidth=i.getGroupPixelWidth&&i.getGroupPixelWidth(),t.groupPixelWidth&&(t.hasProcessed=!0),t.applyGrouping(!!o.hasExtremesChanged)})}function compose(t){var o=(AxisConstructor=t).prototype;o.applyGrouping||(addEvent(t,"afterSetScale",onAfterSetScale),addEvent(t,"postProcessData",applyGrouping),extend(o,{applyGrouping:applyGrouping,getGroupPixelWidth:getGroupPixelWidth,setDataGrouping:setDataGrouping}))}function getGroupPixelWidth(){var t=this.series;let o=t.length,i=0,e=!1,r,s;for(;o--;)(s=t[o].options.dataGrouping)&&(i=Math.max(i,pick(s.groupPixelWidth,DataGroupingDefaults.common.groupPixelWidth)),r=(t[o].processedXData||t[o].data).length,(t[o].groupPixelWidth||r>this.chart.plotSizeX/i||r&&s.forced)&&(e=!0));return e?i:0}function onAfterSetScale(){this.series.forEach(function(t){t.hasProcessed=!1})}function setDataGrouping(o,t){let i;if(t=pick(t,!0),o=o||{forced:!1,units:null},this instanceof AxisConstructor)for(i=this.series.length;i--;)this.series[i].update({dataGrouping:o},!1);else this.chart.options.series.forEach(function(t){t.dataGrouping="boolean"==typeof o?o:merge(o,t.dataGrouping)});this.ordinal&&(this.ordinal.slope=void 0),t&&this.chart.redraw()}const DataGroupingAxisComposition={compose:compose};export default DataGroupingAxisComposition;
!function(t){"object"==typeof module&&module.exports?module.exports=t.default=t:"function"==typeof define&&define.amd?define("highcharts/indicators/ichimoku-kinko-hyo",["highcharts","highcharts/modules/stock"],function(o){return t(o),t.Highcharts=o,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(i){"use strict";var o=i?i._modules:{};function t(o,t,e,n){o.hasOwnProperty(t)||(o[t]=n.apply(null,e),"function"==typeof CustomEvent&&i.win.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:t,module:o[t]}})))}t(o,"Stock/Indicators/IKH/IKHIndicator.js",[o["Extensions/DataGrouping/ApproximationRegistry.js"],o["Core/Color/Color.js"],o["Core/Series/SeriesRegistry.js"],o["Core/Utilities.js"]],function(i,o,L,t){const e=o["parse"];o=L.seriesTypes.sma;const{defined:w,extend:n,isArray:x,isNumber:s,getClosestDistance:Y,merge:M,objectEach:O}=t;function P(o){return{high:o.reduce(function(o,t){return Math.max(o,t[1])},-1/0),low:o.reduce(function(o,t){return Math.min(o,t[2])},1/0)}}function D(o){const t=o.indicator;t.points=o.points,t.nextPoints=o.nextPoints,t.color=o.color,t.options=M(o.options.senkouSpan.styles,o.gap),t.graph=o.graph,t.fillGraph=!0,L.seriesTypes.sma.prototype.drawGraph.call(t)}class p extends o{constructor(){super(...arguments),this.data=[],this.options={},this.points=[],this.graphCollection=[]}init(){super.init.apply(this,arguments),this.options=M({tenkanLine:{styles:{lineColor:this.color}},kijunLine:{styles:{lineColor:this.color}},chikouLine:{styles:{lineColor:this.color}},senkouSpanA:{styles:{lineColor:this.color,fill:e(this.color).setOpacity(.5).get()}},senkouSpanB:{styles:{lineColor:this.color,fill:e(this.color).setOpacity(.5).get()}},senkouSpan:{styles:{fill:e(this.color).setOpacity(.2).get()}}},this.options)}toYData(o){return[o.tenkanSen,o.kijunSen,o.chikouSpan,o.senkouSpanA,o.senkouSpanB]}translate(){L.seriesTypes.sma.prototype.translate.apply(this);for(const t of this.points)for(const e of this.pointArrayMap){var o=t[e];s(o)&&(t["plot"+e]=this.yAxis.toPixels(o,!0),t.plotY=t["plot"+e],t.tooltipPos=[t.plotX,t["plot"+e]],t.isNull=!1)}}drawGraph(){const e=this,o=e.points,n=e.options,t=e.graph,i=e.color,s={options:{gapSize:n.gapSize}},p=e.pointArrayMap.length,a=[[],[],[],[],[],[]],l={tenkanLine:a[0],kijunLine:a[1],chikouLine:a[2],senkouSpanA:a[3],senkouSpanB:a[4],senkouSpan:a[5]},r=[],h=e.options.senkouSpan,u=h.color||h.styles.fill,c=h.negativeColor,g=[[],[]],k=[[],[]];let d=o.length,f=0,S,y,m,v,C,A,x,Y,P,B,j,N,b;for(e.ikhMap=l;d--;){for(y=o[d],m=0;m<p;m++)S=e.pointArrayMap[m],w(y[S])&&a[m].push({plotX:y.plotX,plotY:y["plot"+S],isNull:!1});var G,X;c&&d!==o.length-1&&(G=l.senkouSpanB.length-1,(X=function(o,t,e,n){if(o&&t&&e&&n){var i=t.plotX-o.plotX,t=t.plotY-o.plotY,s=n.plotX-e.plotX,n=n.plotY-e.plotY,p=o.plotX-e.plotX,e=o.plotY-e.plotY,a=(-t*p+i*e)/(-s*t+i*n),e=(s*e-n*p)/(-s*t+i*n);if(0<=a&&a<=1&&0<=e&&e<=1)return{plotX:o.plotX+e*i,plotY:o.plotY+e*t}}}(l.senkouSpanA[G-1],l.senkouSpanA[G],l.senkouSpanB[G-1],l.senkouSpanB[G]))&&(X={plotX:X.plotX,plotY:X.plotY,isNull:!1,intersectPoint:!0},l.senkouSpanA.splice(G,0,X),l.senkouSpanB.splice(G,0,X),r.push(G)))}if(O(l,(o,t)=>{n[t]&&"senkouSpan"!==t&&(e.points=a[f],e.options=M(n[t].styles,s),e.graph=e["graph"+t],e.fillGraph=!1,e.color=i,L.seriesTypes.sma.prototype.drawGraph.call(e),e["graph"+t]=e.graph),f++}),e.graphCollection)for(const T of e.graphCollection)e[T].destroy(),delete e[T];if(e.graphCollection=[],c&&l.senkouSpanA[0]&&l.senkouSpanB[0]){for(r.unshift(0),r.push(l.senkouSpanA.length-1),N=0;N<r.length-1;N++)if(v=r[N],C=r[N+1],A=l.senkouSpanB.slice(v,C+1),x=l.senkouSpanA.slice(v,C+1),1<=Math.floor(A.length/2)){var E=Math.floor(A.length/2);if(A[E].plotY===x[E].plotY){for(Y=0,P=0,b=0;b<A.length;b++)Y+=A[b].plotY,P+=x[b].plotY;j=Y>P?0:1,g[j]=g[j].concat(A),k[j]=k[j].concat(x)}else j=A[E].plotY>x[E].plotY?0:1,g[j]=g[j].concat(A),k[j]=k[j].concat(x)}else j=A[0].plotY>x[0].plotY?0:1,g[j]=g[j].concat(A),k[j]=k[j].concat(x);["graphsenkouSpanColor","graphsenkouSpanNegativeColor"].forEach(function(o,t){g[t].length&&k[t].length&&(B=0===t?u:c,D({indicator:e,points:g[t],nextPoints:k[t],color:B,options:n,gap:s,graph:e[o]}),e[o]=e.graph,e.graphCollection.push(o))})}else D({indicator:e,points:l.senkouSpanB,nextPoints:l.senkouSpanA,color:u,options:n,gap:s,graph:e.graphsenkouSpan}),e.graphsenkouSpan=e.graph;delete e.nextPoints,delete e.fillGraph,e.points=o,e.options=n,e.graph=t,e.color=i}getGraphPath(o){var t=this;let e=[],n,i;if(o=o||this.points,t.fillGraph&&t.nextPoints){if((n=L.seriesTypes.sma.prototype.getGraphPath.call(t,t.nextPoints))&&n.length){n[0][0]="L",e=L.seriesTypes.sma.prototype.getGraphPath.call(t,o);for(let o=(i=n.slice(0,e.length)).length-1;0<=o;o--)e.push(i[o])}}else e=L.seriesTypes.sma.prototype.getGraphPath.apply(t,arguments);return e}getValues(o,t){const e=t.period,n=t.periodTenkan,i=t.periodSenkouSpanB,s=o.xData,p=o.yData,a=o.xAxis,l=p&&p.length||0,r=Y(a.series.map(o=>o.xData||[])),h=[],u=[];let c,g,k,d,f,S,y,m,v,C;if(!(s.length<=e)&&x(p[0])&&4===p[0].length){var A=s[0]-e*r;for(f=0;f<e;f++)u.push(A+f*r);for(f=0;f<l;f++)f>=n&&(g=P(p.slice(f-n,f)),S=(g.high+g.low)/2),f>=e&&(k=P(p.slice(f-e,f)),y=(k.high+k.low)/2,v=(S+y)/2),f>=i&&(d=P(p.slice(f-i,f)),C=(d.high+d.low)/2),m=p[f][3],c=s[f],void 0===h[f]&&(h[f]=[]),void 0===h[f+e-1]&&(h[f+e-1]=[]),h[f+e-1][0]=S,h[f+e-1][1]=y,(h[f+e-1][2]=void 0)===h[f+1]&&(h[f+1]=[]),h[f+1][2]=m,f<=e&&(h[f+e-1][3]=void 0,h[f+e-1][4]=void 0),void 0===h[f+2*e-2]&&(h[f+2*e-2]=[]),h[f+2*e-2][3]=v,h[f+2*e-2][4]=C,u.push(c);for(f=1;f<=e;f++)u.push(c+f*r);return{values:h,xData:u,yData:h}}}}return p.defaultOptions=M(o.defaultOptions,{params:{index:void 0,period:26,periodTenkan:9,periodSenkouSpanB:52},marker:{enabled:!1},tooltip:{pointFormat:'<span style="color:{point.color}">‚óè</span> <b> {series.name}</b><br/>TENKAN SEN: {point.tenkanSen:.3f}<br/>KIJUN SEN: {point.kijunSen:.3f}<br/>CHIKOU SPAN: {point.chikouSpan:.3f}<br/>SENKOU SPAN A: {point.senkouSpanA:.3f}<br/>SENKOU SPAN B: {point.senkouSpanB:.3f}<br/>'},tenkanLine:{styles:{lineWidth:1,lineColor:void 0}},kijunLine:{styles:{lineWidth:1,lineColor:void 0}},chikouLine:{styles:{lineWidth:1,lineColor:void 0}},senkouSpanA:{styles:{lineWidth:1,lineColor:void 0}},senkouSpanB:{styles:{lineWidth:1,lineColor:void 0}},senkouSpan:{styles:{fill:"rgba(255, 0, 0, 0.5)"}},dataGrouping:{approximation:"ichimoku-averages"}}),n(p.prototype,{pointArrayMap:["tenkanSen","kijunSen","chikouSpan","senkouSpanA","senkouSpanB"],pointValKey:"tenkanSen",nameComponents:["periodSenkouSpanB","period","periodTenkan"]}),i["ichimoku-averages"]=function(){const e=[];let n;return[].forEach.call(arguments,function(o,t){e.push(i.average(o)),n=!n&&void 0===e[t]}),n?void 0:e},L.registerSeriesType("ikh",p),p}),t(o,"masters/indicators/ichimoku-kinko-hyo.src.js",[o["Core/Globals.js"]],function(o){return o})});
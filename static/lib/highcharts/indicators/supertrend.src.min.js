!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/indicators/supertrend",["highcharts","highcharts/modules/stock"],function(o){return e(o),e.Highcharts=o,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(n){"use strict";var o=n?n._modules:{};function e(o,e,t,r){o.hasOwnProperty(e)||(o[e]=r.apply(null,t),"function"==typeof CustomEvent&&n.win.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:o[e]}})))}e(o,"Stock/Indicators/Supertrend/SupertrendIndicator.js",[o["Core/Series/SeriesRegistry.js"],o["Core/Utilities.js"]],function(o,e){const{atr:D,sma:S}=o.seriesTypes,{addEvent:n,correctFloat:b,isArray:v,extend:t,merge:j,objectEach:L}=e;function k(o,e,t){return{index:e,close:o.yData[e][t],x:o.xData[e]}}class r extends S{init(){const t=this,r=(super.init.apply(t,arguments),n(this.chart.constructor,"afterLinkSeries",()=>{if(t.options){const o=t.options,e=t.linkedParent.options;o.cropThreshold=e.cropThreshold-(o.params.period-1)}r()},{order:1}))}drawGraph(){const t=this,o=t.options,e=t.linkedParent,r=e?e.points:[],n=t.points,i=t.graph,l=r.length-n.length,s=0<l?l:0,a={options:{gapSize:o.gapSize}},p={top:[],bottom:[],intersect:[]},d={top:{styles:{lineWidth:o.lineWidth,lineColor:o.fallingTrendColor||o.color,dashStyle:o.dashStyle}},bottom:{styles:{lineWidth:o.lineWidth,lineColor:o.risingTrendColor||o.color,dashStyle:o.dashStyle}},intersect:o.changeTrendLine};let c,h,u,g,y,x,f,m,C,T=n.length;for(;T--;)c=n[T],h=n[T-1],u=r[T-1+s],g=r[T-2+s],y=r[T+s],x=r[T+s+1],f=c.options.color,m={x:c.x,plotX:c.plotX,plotY:c.plotY,isNull:!1},!g&&u&&e.yData[u.index-1]&&(g=k(e,u.index-1,3)),!x&&y&&e.yData[y.index+1]&&(x=k(e,y.index+1,3)),!u&&g&&e.yData[g.index+1]?u=k(e,g.index+1,3):!u&&y&&e.yData[y.index-1]&&(u=k(e,y.index-1,3)),c&&u&&y&&g&&c.x!==u.x&&(c.x===y.x?(g=u,u=y):c.x===g.x?(u=g,g={close:e.yData[u.index-1][3],x:e.xData[u.index-1]}):x&&c.x===x.x&&(u=x,g=y)),h&&g&&u?(C={x:h.x,plotX:h.plotX,plotY:h.plotY,isNull:!1},c.y>=u.close&&h.y>=g.close?(c.color=f||o.fallingTrendColor||o.color,p.top.push(m)):c.y<u.close&&h.y<g.close?(c.color=f||o.risingTrendColor||o.color,p.bottom.push(m)):(p.intersect.push(m),p.intersect.push(C),p.intersect.push(j(C,{isNull:!0})),c.y>=u.close&&h.y<g.close?(c.color=f||o.fallingTrendColor||o.color,h.color=f||o.risingTrendColor||o.color,p.top.push(m),p.top.push(j(C,{isNull:!0}))):c.y<u.close&&h.y>=g.close&&(c.color=f||o.risingTrendColor||o.color,h.color=f||o.fallingTrendColor||o.color,p.bottom.push(m),p.bottom.push(j(C,{isNull:!0}))))):u&&(c.y>=u.close?(c.color=f||o.fallingTrendColor||o.color,p.top.push(m)):(c.color=f||o.risingTrendColor||o.color,p.bottom.push(m)));L(p,function(o,e){t.points=o,t.options=j(d[e].styles,a),t.graph=t["graph"+e+"Line"],S.prototype.drawGraph.call(t),t["graph"+e+"Line"]=t.graph}),t.points=n,t.options=o,t.graph=i}getValues(o,e){const t=e.period,r=e.multiplier,n=o.xData,i=o.yData,l=[],s=[],a=[],p=0===t?0:t-1,d=[],c=[];let h,u,g,y,x,f,m,C,T,S;if(!(n.length<=t||!v(i[0])||4!==i[0].length||t<0)){for(h=D.prototype.getValues.call(this,o,{period:t}).yData,S=0;S<h.length;S++)T=i[p+S],C=i[p+S-1]||[],x=d[S-1],f=c[S-1],m=a[S-1],0===S&&(x=f=m=0),u=b((T[1]+T[2])/2+r*h[S]),g=b((T[1]+T[2])/2-r*h[S]),u<x||C[3]>x?d[S]=u:d[S]=x,g>f||C[3]<f?c[S]=g:c[S]=f,m===x&&T[3]<d[S]||m===f&&T[3]<c[S]?y=d[S]:(m===x&&T[3]>d[S]||m===f&&T[3]>c[S])&&(y=c[S]),l.push([n[p+S],y]),s.push(n[p+S]),a.push(y);return{values:l,xData:s,yData:a}}}}return r.defaultOptions=j(S.defaultOptions,{params:{index:void 0,multiplier:3,period:10},risingTrendColor:"#06b535",fallingTrendColor:"#f21313",changeTrendLine:{styles:{lineWidth:1,lineColor:"#333333",dashStyle:"LongDash"}}}),t(r.prototype,{nameBase:"Supertrend",nameComponents:["multiplier","period"]}),o.registerSeriesType("supertrend",r),r}),e(o,"masters/indicators/supertrend.src.js",[o["Core/Globals.js"]],function(o){return o})});
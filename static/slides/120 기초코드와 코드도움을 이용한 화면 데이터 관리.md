---
marp: true
theme: gaia
_class: lead
footer: QCN
paginate: true
backgroundColor: #fff
---

<style>
:root {
  font-family: Pretendard;
  --border-color: #303030;
  --text-color: #0a0a0a;
  --bg-color-alt: #dadada;
  --mark-background: #ffef92;
}

h1 {
  border-bottom: none;
  font-size: 1.6em;
}

h2 {
  border-bottom: none;
  font-size: 1.3em;
}

h3 {
  font-size: 1.1em;
}

h4 {
  font-size: 1.05em;
}

h5 {
  font-size: 1em;
}

h6 {
  font-size: 0.9em;
}

h1,
h2,
h3,
h4,
h5,
h6 {
  color: var(--text-color);
}

code:not([class*="language-"]) {
  font-family: D2Coding;
  color: #000;
  vertical-align: text-bottom;
  background-color: rgba(100, 100, 100, 0.2);
}

section {
  padding: 1rem;
  border-bottom: 1px solid #000;
  background-image: linear-gradient(to bottom right, #f7f7f7 0%, #d3d3d3 100%);
}

section > h2 {
  border-bottom: 4px solid #17344f;
}

section table {
    margin: auto;
    margin-top: 1rem;
    font-size: 28px;
}

section::after {
  font-size: 0.75em;
  content: attr(data-marpit-pagination) " / " attr(data-marpit-pagination-total);
}

img[alt~="center"] {
  display: block;
  margin: 0 auto;
}

blockquote {
  font-size: 26px;
  border-left: 8px solid var(--border-color);
  background: var(--bg-color-alt);
  margin: 0.5em;
  padding: 0.5em;
}

blockquote::before,
blockquote::after {
    content: '';
}

mark {
  background-color: var(--mark-background);
  padding: 0 2px 2px;
  border-radius: 4px;
  margin: 0 2px;
}

section.tinytext>p,
section.tinytext>ul,
section.tinytext>blockquote {
  font-size: 0.65em;
}
</style>

# 기초코드와 코드도움을 이용한 화면 데이터 관리

### 화면 개발에 필요한 코드 데이터를 간단하게 처리하기

---

## 왜 코드 데이터 관리가 필요한가?

- 화면에는 콤보박스, 라디오 버튼, 자동완성 등 공통적으로 사용되는 데이터가 많습니다.
- 예시: 부서 목록, 직급 목록, 상태 코드(사용/중지), 카테고리 등
- 이런 데이터를 각 화면마다 <mark>하드코딩</mark>하면 변경이 있을 때마다 모든 화면을 수정해야 하는 <mark>유지보수의 악몽</mark>이 시작됩니다.

> HandStack은 이런 반복적이고 비효율적인 작업을 해결하기 위해
> 간단하고 체계적인 데이터 관리 방법을 제공합니다.

---

## HandStack의 데이터 소스 철학

데이터의 성격과 갱신 주기에 따라 관리 방식을 다르게 접근합니다.

- **시스템 데이터 (거의 변하지 않음)**
  - 예: `Y/N`, `사용/미사용`
  - 소스코드에 하드코딩하거나, 환경 설정 파일(`syn.config.json`)에 정의하여 관리합니다.

- **업무 데이터 (수시로 변함)**
  - 예: 고객 목록, 상품 카테고리, 공지사항 유형
  - 변경이 잦으므로 데이터베이스나 원격 파일(JSON)을 통해 관리하여, <mark>데이터 변경을 위해 배포가 필요 없도록</mark> 합니다.

---

## 1. HTML에서 선언적으로 데이터 연결하기

JavaScript 코드 없이 HTML 태그의 속성만으로 데이터 소스를 지정할 수 있습니다.

- `data-source-type="config"`
  - `syn.config.json` 파일에 정의된 데이터를 사용합니다.

- `data-source-type="remote"`
  - 서버의 특정 경로(`/assets/`)에 위치한 JSON 파일을 데이터로 사용합니다.

- `data-source-type="transaction"`
  - 데이터베이스 조회를 통해 동적으로 데이터를 가져옵니다. 가장 일반적인 방식입니다.

---

### 데이터 소스 유형별 예제

- **config**: 환경 설정 값으로 콤보박스 만들기
```html
<select data-control="select" data-source-type="config" data-source-value="PageSizes"></select>
```

- **remote**: 원격 JSON 파일로 콤보박스 만들기
```html
<select data-control="select" data-source-type="remote" data-source-value="sample/groupCode.json"></select>
```

- **transaction**: DB 조회(Transaction ID)로 콤보박스 만들기
```html
<select data-control="select" data-source-type="transaction" data-source-value="common.selectBaseCode" data-params='{"GROUP_CODE": "SYS01"}'></select>
```
---

## 2. JavaScript로 동적으로 데이터 제어하기

화면의 특정 상황에 따라 데이터 소스를 동적으로 변경해야 할 때 사용합니다.

- 예시:
  - 첫 번째 콤보박스에서 '사용자 그룹'을 선택하면,
  - 두 번째 콤보박스에 해당 그룹에 속한 '사용자 목록'이 나타나는 경우

```javascript
// 그룹 콤보박스 변경 이벤트
$p.sender.add("change", function () {
    // 선택된 그룹 코드 가져오기
    var selectedGroup = $p.sender.val();

    // 사용자 콤보박스에 파라미터를 동적으로 설정하여 다시 조회
    $p.ctrl.userList.setTransaction("common.selectUsers", { "GROUP_CODE": selectedGroup });
});
```
---

## 3. 데이터 관리 인프라: BaseCode와 CodeHelp

HandStack은 공통 코드 관리를 위해 두 가지 표준 모델을 제공합니다.

- `BaseCode`: 콤보박스, 라디오, 체크박스 등 Key-Value 형태의 단순한 코드 데이터 관리에 사용됩니다.
- `CodeHelp`: 검색 기능이 포함된 팝업 형태의 '코드 도움창'에 사용되며, 여러 컬럼을 가진 복잡한 데이터 조회에 적합합니다.

---

### 데이터베이스 스키마 살펴보기

- **BaseCode 테이블 (`SY_BaseCode`)**
  - `GROUP_CODE`: 코드 그룹 (예: 'SYS01' - 직급)
  - `CODE`: 실제 값 (예: 'PO', 'SA')
  - `CODE_NAME`: 화면에 표시될 이름 (예: '대표', '사원')
  - `SORT_ORDER`: 정렬 순서

- **CodeHelp 테이블 (`SY_CodeHelp`)**
  - `HELP_ID`: 코드 도움 고유 ID (예: 'H_CUSTOMER')
  - `HELP_TITLE`: 팝업 창 제목 (예: '고객 검색')
  - `QUERY`: 데이터를 조회할 SQL 문
  - `COLUMN_INFO`: 팝업 그리드에 표시될 컬럼 정보 (JSON 형식)

---

### 데이터 관리 화면

- 개발자는 데이터를 관리하기 위한 화면을 별도로 만들 필요가 없습니다.
- HandStack 프로젝트 생성 시 `BaseCode`와 `CodeHelp`를 관리할 수 있는 화면이 기본으로 제공됩니다.
- 이 화면에서 코드를 추가, 수정, 삭제하면 애플리케이션 전체에 즉시 반영됩니다.

![이미지: BaseCode, CodeHelp 관리 화면 스크린샷](https://user-images.githubusercontent.com/1132895/201490234-a8e0f119-e931-4c1d-8519-54b0e9c80dce.png)

---

## 핸즈온: 화면에 코드 데이터 적용하기

1. **DB 스키마 확인**: `SY_BaseCode` 테이블 구조를 다시 한번 확인합니다.

2. **관리 화면에서 데이터 추가**: `BaseCode` 관리 화면에서 새로운 그룹 코드('SYS02')와 하위 코드들(예: 'A등급', 'B등급')을 등록합니다.

3. **화면 코드 작성**: HTML 파일에 `select` 컨트롤을 추가하고 `data-source` 관련 속성을 설정하여 방금 추가한 데이터를 연결합니다.

```html
<!-- views/myPage.html -->
<h3>고객 등급</h3>
<select data-control="select"
        data-source-type="transaction"
        data-source-value="common.selectBaseCode"
        data-params='{"GROUP_CODE": "SYS02"}'
        data-value-member="CODE"
        data-display-member="CODE_NAME">
</select>
```

4. **결과 확인**: 화면을 실행하여 'A등급', 'B등급'이 표시되는 콤보박스를 확인합니다.

---

## 데모: 코드도움 팝업 사용하기

고객을 검색하는 코드도움 팝업을 적용해봅시다.

- `CodeHelp` 관리 화면에서 고객 조회용 `HELP_ID`(`H_CUSTOMER`)를 등록합니다.
- 화면의 입력 박스에 `codepicker` 컨트롤을 적용하고 `HELP_ID`를 연결합니다.

```html
<!-- views/myOrder.html -->
<label>고객</label>
<input type="text" id="customerName" readonly>
<input type="hidden" id="customerID">

<!-- data-output-* 속성을 이용해 팝업에서 선택한 값을 현재 화면의 다른 컨트롤에 매핑 -->
<input type="text" data-control="codepicker"
       data-source-value="H_CUSTOMER"
       data-output-id="customerID"
       data-output-name="customerName">
```
---

## 정리

- HandStack을 사용하면 <mark>화면 공통 코드</mark>를 매우 쉽게 관리할 수 있습니다.
- HTML에 <mark>선언적 방식</mark>으로 데이터 소스를 지정하여 코드 가독성과 생산성을 높입니다.
- 데이터베이스와 관리 화면이 표준으로 제공되어, <mark>데이터 관리 업무가 단순화</mark>됩니다.
- 초급 개발자도 복잡한 설정 없이 데이터 기반의 화면을 빠르게 개발할 수 있습니다.

